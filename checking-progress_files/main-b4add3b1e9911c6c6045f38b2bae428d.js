function AcceptTerms(){"use strict";this.init=function(){function a(){var a=document.createDocumentFragment();$(a).append(JST["app/templates/accept_terms/accept.us"]());var b=a.querySelector("#accept"),d=a.querySelector(".neutral"),e=a.querySelector(".signup-arrow");return $(window).unload(function(){User.logout(function(){account.return_url?window.location=account.return_url:window.location="/"})}),e.onclick=function(){account.terms_accepted=!0;var a={user:{terms_accepted:"on"}};User.updateAccountTerms(a,function(){c.close()})},d.onclick=function(){User.logout(function(){account.return_url?window.location=account.return_url:window.location="/"})},b}function b(){c.open(a())}var c=new LightBox({id:"edit-asset",hasShadow:!0,closeButton:!1,closeable:!1,closeCallback:function(){c.close()},customClass:"popup primary-color"});b()}}function AccountCreator(a){"use strict";function b(){var b={},d=document.createDocumentFragment();$(d).append(JST["app/templates/account_creator/signup-account-info.us"]());var e=d.querySelector(".signup-frame-container"),f=d.querySelector("form"),g=d.querySelector(".signup-arrow"),h=d.querySelector("#already-created");h.onclick=function(){c.close()},g.onclick=function(){function d(){User.checkSecondFrameInstructor(b,function(d){d.success?(b.id=d.user.id,b.type="User",c.close(a(b))):"Email has already been taken"==d.errors[0]?(c.close(),b.doesEmailExist=!0,a(b)):(GT.Notification.showErrorList(d.errors,4e3),g.disabled=!1)})}this.disabled=!0;for(var e=$(f).serializeArray(),h=0;h<e.length;h++)b[e[h].name]=e[h].value;organizationParam?(b.organization_uuid=organizationParam,d()):GT.courseParam?(b.course_uuid=GT.courseParam,User.checkFirstFrameStudent(b,function(d){d.success?(b.id=d.id,b.type="User",c.close(a(b))):"Email has already been taken"==d.errors[0]?(c.close(),b.doesEmailExist=!0,a(b)):(GT.Notification.showErrorList(d.errors,4e3),g.disabled=!1)})):d()};for(var i=d.querySelectorAll("input"),j=0;j<i.length;j++)i[j].onclick=function(){g.disabled=!1};return e}var c=new LightBox({id:"signup-popup",hasShadow:!0,customClass:"popup primary-color",closeButton:!0});c.open(b())}function AccountView(){"use strict";function a(){var a,d=!1;for(a=0;a<f.length;a++)f[a].value?"checkbox"===f[a].type?l.user[f[a].name]=f[a].checked:l.user[f[a].name]=f[a].value:l.user[f[a].name]="";for(l.user.organization_id=account.organization_id,User.updateAccountInfo(l,c),a=0;a<g.length;a++)g[a].value&&(d=!0,l.user[g[a].name]=g[a].value);d&&(User.updatePassword(l,function(a){a.success?(k.close(),GT.Notification.show("Password Changed")):GT.Notification.showErrorList(a.errors,4e3)}),b(g),d=!1)}function b(a){for(var b=0;b<a.length;b++)a[b].value=""}function c(a){return a.success?void GT.User.accountInfo(function(a){return window.account=a,Honeybadger.setContext(account),GT.Notification.show("Profile Saved"),!0}):(GT.Notification.showErrorList(a.errors,4e3),!1)}GT.GTView.call(this);var d=account;this.frag=document.createDocumentFragment();var e,f,g,h,i,j=document.createDocumentFragment(),k=new GT.LightBox({closeable:!0,closeButton:!0}),l={user:{}};this.createMarkup=function(){sideBar.fillMainSideBar(),$(j).append(JST["app/templates/sidebar/account.us"](d)),e=j.querySelector("div"),f=j.querySelectorAll("#personal-info input, textarea"),g=j.querySelectorAll("#password-change input"),h=j.querySelector("#update-settings");for(var b=0;b<f.length;b++)i=f[b].name,d[i]&&("checkbox"===f[b].type?f[b].checked=d[i]:f[b].value=d[i]);h.onclick=function(){a()},this.div.appendChild(e)}}function AddinstructorsView(a){"use strict";GTView.call(this);var b,c,d=this;this.div.id="addinstructors-view",this.bodyClass="addinstructors-view",this.beforeTemplateLoad=function(c){GT.Course.get(a,void 0,function(a){b=a,GTView.setRoles(b.user_role),sideBar.setCourse(b),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(b.user_role,void 0,function(){})}),c(b)})},this.beforeViewLoad=function(){c=new InstructorAssigner(b),d.elements.mainContainer.appendChild(c.div)}}function AddlearnersView(a){"use strict";GTView.call(this);var b,c,d=this;this.div.id="addlearners-view",this.bodyClass="addlearners-view",this.beforeTemplateLoad=function(c){GT.Course.get(a,void 0,function(a){b=a,GTView.setRoles(b.user_role),sideBar.setCourse(b),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(b.user_role,void 0,function(){})}),c(b)})},this.beforeViewLoad=function(){c=new StudentAssigner(b),d.elements.mainContainer.appendChild(c.div)}}function AssignmentEditor(a){"use strict";function b(a){$(p.contentContainer).empty(),$(p.contentContainer).append(a)}function c(a){return a%1===0}function d(){function b(a){a.preventDefault();var b=a.target.parentElement.id.split("-").pop();GT.Tile.deleteAssignmentContent({content_id:b},function(b){b.success&&a.target.closest(".media-container").remove()})}function d(a,b){GT.Tile.filepickerSecurityPolicy(a.url.split("/").pop(),function(c){var d,e;e=a.url.split("/").pop(),d=a.url.split("/"+e)[0],a.url=d+"/security=policy:"+c.policy+",signature:"+c.signature+"/"+e,b&&b()})}function p(a,b){GT.Tile.update(a,function(a){a.success?(GT.Notification.show("Tile Data Saved."),b()):GT.Notification.showErrors(a.errors)})}function q(a,b){GT.Tile.submitResponse(a.id,JSON.stringify(a),function(a){b(a)})}var r,s={id:a.id};if(a.assignment_contents&&a.assignment_contents.forEach(function(a){"Video"===a.file_type&&(a.media=!0,a.video=!0),"Sound"===a.file_type&&(a.media=!0,a.sound=!0),"Image"===a.file_type&&(a.media=!0,a.image=!0)}),r=document.createDocumentFragment(),$(r).append(JST["app/templates/tile_view/edit_assignment.us"](a)),e=r.querySelectorAll("input[name=grading]"),f=r.querySelectorAll("input[name=content-type]"),g=r.querySelector(".assignment-min-score"),h=r.querySelector("#assignment-details"),i=r.querySelector("#video-description"),j=r.querySelector("#upload-description"),k=r.querySelector("#upload-message-container"),l=r.querySelector("#response-contents-container"),m=r.querySelectorAll(".download-file"),null===a.pass_fail?(e[0].checked=!0,g.disabled=!0,s.min_score=null,s.pass_fail=!0,p(s,function(){a.min_score=null,a.pass_fail=!0})):a.pass_fail?(e[0].checked=!0,g.disabled=!0):(e[1].checked=!0,g.value=a.min_score),a.assignment_response)for(n=0;n<f.length;n++)a.assignment_response.includes(f[n].value)&&(f[n].checked=!0);for(n=0;n<e.length;n++)e[n].onchange=function(b){var c={id:a.id};"pass-fail"==b.target.value?(c.min_score=null,c.pass_fail=!0,g.value=null,g.disabled=!0,p(c,function(){a.min_score=null,a.pass_fail=!0})):(g.disabled=!1,g.value=70,c.min_score=Number(g.value),c.pass_fail=!1,p(c,function(){a.min_score=c.min_score,a.pass_fail=!1}),$(g).focus())};for(g.onchange=function(b){if(isNaN(Number(g.value))||""==g.value||Number(g.value)<=0||Number(g.value>100)||!c(Number(g.value)))GT.Notification.showError("Passing score must be a whole number between 0 and 100.");else{var d={id:a.id};d.min_score=Number(g.value),d.pass_fail=!1,p(d,function(){a.min_score=d.min_score,a.pass_fail=!1})}},o=0;o<f.length;o++)a.assignment_response==f[o].value&&(f[o].checked=!0),f[o].onclick=function(b){var c={id:a.id};"no-content"===b.target.value?c.assignment_response=null:c.assignment_response=b.target.value,p(c,function(){a.assignment_response=c.assignment_response})};return $(h).on("change",function(b){var c=$(this).val(),d={id:a.id,message:c};p(d,function(){a.message=c})}),i.onclick=function(c){l=c.target.closest("div").querySelector("#response-contents-container"),GT.FPWrapper.recordVideo(function(c){var e,f={id:a.id};e=c[0].filename.replace(/\.[^\/.]+$/,""),f.uploads||(f.uploads=[]),f.uploads.push({url:c[0].url,file_name:e,file_type:"Video",hash:c[0].url.split("/").pop()}),f.description=!0,q(f,function(a){d(c[0],function(){$(l).append(Handlebars.partials.assignment_video({url:c[0].url,id:a.id,description:!0})),l.querySelector("#delete-preview").onclick=b})})})},j.onclick=function(c){GT.FPWrapper.openUploadPrompt(function(e){var f,g,h,i,j={id:a.id};for(l=c.target.closest("div").querySelector("#response-contents-container"),i=0;i<e.length;i++)g=e[i].filename.replace(/\.[^\/.]+$/,""),h=FPWrapper.determineType(e[i]),f={url:e[i].url,file_name:g,file_type:h,hash:e[i].url.split("/").pop()},j.uploads||(j.uploads=[]),j.uploads.push(f);j.description=!0,q(j,function(a){f.id=a.id,d(f,function(){f.description=!0,"Video"===h?$(l).append(Handlebars.partials.assignment_video(f)):"Sound"===h?$(l).append(Handlebars.partials.assignment_audio(f)):"Image"===h?$(l).append(Handlebars.partials.assignment_image(f)):$(l).append(Handlebars.partials.assignment_file(f)),l.querySelector("#delete-contents-"+a.id).onclick=b})})},!0)},l.querySelectorAll(".delete-contents").forEach(function(a){a.onclick=b}),m.forEach(function(a){a.onclick=function(a){window.location=a.target.value}}),r.querySelector("div")}var e,f,g,h,i,j,k,l,m,n,o,p=this;this.contentContainer=document.createElement("div"),this.contentContainer.className="assignment-edit-container",b(d())}function AssignStudentCourse(a,b){"use strict";GT.Course.joinCourse(a,function(a){var c,d,e;a.success?b&&b():(c=document.createElement("div"),c.id="course-registration-deadline-past-container",d=document.createElement("p"),d.appendChild(document.createTextNode(a.errors)),d.id="course-registration-deadline-past",c.appendChild(d),e=new LightBox({id:"assign-student-course",hasShadow:!0}),e.open(c))})}function AutoassignEditor(a,b,c){"use strict";function d(){GT.AssignmentRule.getPendingCount(a,function(a){0===x.numberOfFilters()?m.textContent=a.all_users+" people available.":0===a.all_users?m.textContent="No one currently meets":1===a.all_users?m.textContent=a.all_users+" person meets":m.textContent=a.all_users+" people meet",0===x.numberOfFilters()?(n.classList.add("hidden"),o.classList.add("hidden"),p.classList.add("hidden")):1===x.numberOfFilters()?(n.classList.remove("hidden"),o.classList.add("hidden"),p.classList.add("hidden")):2===x.numberOfFilters()?(n.classList.add("hidden"),o.classList.remove("hidden"),p.classList.add("hidden")):(n.classList.add("hidden"),o.classList.add("hidden"),p.classList.remove("hidden"),q.textContent=x.numberOfFilters()),m.classList.remove("hidden"),l.textContent=a.new_users,a.new_users>0?(s.classList.remove("hidden"),t.classList.add("hidden")):(s.classList.add("hidden"),t.classList.remove("hidden")),x.allFiltersSet()&&!g&&r.classList.remove("hidden"),u.classList.remove("acknowledged"),u.disabled=!1,i.disabled=!0})}var e=document.createDocumentFragment();$(e).append(JST["app/templates/autoassign_view/autoassign_editor.us"]());var f=this,g=!0,h=e.querySelector("#js-cancel-button"),i=e.querySelector("#js-save-button"),j=e.querySelector("#js-autoassign-filters"),k=e.querySelector("#js-autoassign-container"),l=e.querySelector("#js-autoassign-sanitycheck"),m=e.querySelector("#js-all-users"),n=e.querySelector("#js-one-filter"),o=e.querySelector("#js-two-filters"),p=e.querySelector("#js-more-filters"),q=e.querySelector("#js-criteria-number"),r=e.querySelector("#js-sanity-box"),s=e.querySelector("#js-more-people-message"),t=e.querySelector("#js-no-people-message"),u=e.querySelector("#js-sanity-confirm"),v=e.querySelector("#js-edit-button"),w=e.querySelector("#js-delete-button"),x=new Filterer(j,function(){d()},b);v.onclick=function(){GT.AssignmentRule.beginEdit(a,function(b){a=b.id,x.changeContext(b),f.enable(),v.classList.add("hidden")})},h.onclick=function(){f.disable(),GT.AssignmentRule.cancelEdit(a,function(b){b?(a=b.id,x.changeContext(b)):$(k).remove(),c&&c(!1)})},w.onclick=function(){f.disable(),GT.AssignmentRule.deleteRule(a,function(){$(k).remove(),c&&c(!0)})},i.onclick=function(){f.disable(),GT.AssignmentRule.saveEdit(a,function(){c&&c(!0)})},u.onclick=function(){u.classList.add("acknowledged"),u.disabled=!0,i.disabled=!1},x.contextId=a,x.context="AssignmentRule",x.addFilterCallback=function(){r.classList.add("hidden")},x.fetchFilters(function(a){a&&d()}),this.getFrag=function(){return e},this.disable=function(){k.classList.add("static"),x.disable(),i.disabled=!0,i.classList.add("hidden"),h.disabled=!0,h.classList.add("hidden"),v.classList.remove("hidden"),r.classList.add("hidden"),g=!0},this.enable=function(){k.classList.remove("static"),x.enable(),i.classList.remove("hidden"),h.disabled=!1,h.classList.remove("hidden"),v.classList.add("hidden"),g=!1}}function AutoassignView(a){"use strict";function b(){function b(b){GT.Course.createAutoAssign(a,b,function(a){var b=new AutoassignEditor(a.id,c(account.organization,g));b.enable(),i.elements.ruleList.appendChild(b.getFrag())})}var e,f,h,j,k,l=d(account.organization,g);l.length>1?(e=new LightBox({closeable:!0,closeButton:!0}),f=document.createDocumentFragment(),$(f).append(JST["app/templates/autoassign_view/pick_scope_modal.us"]()),h=f.querySelector("#js-confirm"),j=f.querySelector("#js-staff-radio"),k=f.querySelector("#js-categories-radio"),h.onclick=function(){var a;e.close(),j.checked&&(a="staff"),k.checked&&(a="categories"),b(a)},e.open(f)):1===l.length?b(l[0]):b()}function c(a,b){return d(a,b).length>0}function d(a,b){var c,d=[];if(b){for(c=0;c<b.custom_categories.length;c++)if(b.custom_categories[c].custom_category_type.hides_learners){d.push("category");break}}else GT.getDefaultRestrictedCategories().length>0&&d.push("category");return(d.length>0||"staff"===a.permission_scheme)&&d.push("staff"),d}GTView.call(this);var e,f,g,h,i=this;this.div.id="autoassign-view",this.bodyClass="autoassign-view",this.beforeTemplateLoad=function(b){function c(){GTView.setRoles(h),sideBar.setCourse(f),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(f.user_role,void 0,function(){})}),GT.Course.autoAssigns(a,function(a){e=a,b({course:f,autoAssigns:a})})}"InstructionalAdmin"===account.user_type?GT.Course.get(a,void 0,function(a){f=a,c()}):GT.UserCourse.getInstructorUserCourse(a,function(b){b&&b.course?(f=b.course,g=b,h=g.role,c()):GT.Course.get(a,void 0,function(a){f=a,h="Creator",c()})})},this.beforeViewLoad=function(){this.elements.addButton.onclick=b,this.elements.firstAddButton.onclick=function(){i.elements.addButton.classList.remove("hidden"),i.elements.intro.classList.add("hidden"),b()},e.length>0?(this.elements.addButton.classList.remove("hidden"),this.elements.intro.classList.add("hidden")):this.elements.intro.classList.remove("hidden"),e.forEach(function(a){var b=new AutoassignEditor(a.id,c(account.organization,g));i.elements.ruleList.appendChild(b.getFrag()),a.editor_id?b.enable():b.disable()})}}function Completion(a){"use strict";function b(a){var b,c,d,e,f,g,h=0,i=0,j=0,k=document.createDocumentFragment();for(c=a.completion,b=0;b<c.length;b++)c[b].status_datum[0]&&c[b].status_datum[0].score&&c[b].status_datum[0].completed&&(h+=1,i+=c[b].status_datum[0].score),e=document.createDocumentFragment(),c[b].status_datum[0]&&c[b].status_datum[0].completed?(c[b].statusUnicode="",j++):c[b].statusUnicode="",c[b].status_datum&&!c[b].status_datum[0]&&c[b].status_datum.push({length:0}),c[b].statusClass=GT.tileStatusClass(c[b].tile,c[b].status_datum[0]),$(e).append(JST["app/templates/completion_view/completed-tile.us"](c[b])),k.appendChild(e);return g=document.createDocumentFragment(),$(g).append(JST["app/templates/completion_view/students-view.us"]({studentName:a.full_name,completedTotal:Math.round(j/c.length*100),courseTitle:a.course.title})),d=g.querySelector("#js-completion-average"),f=g.querySelector("#completion-list"),f.appendChild(k),h>0?d.textContent=Math.round(Number(i).toFixed(1)/h):d.textContent="N/A ",g.querySelector("#js-checklist")}var c=new LightBox({id:"learner-progress-checklist",hasShadow:!0,closeButton:!0,closeCallback:function(){c.close()},customClass:"popup primary-color"});GT.UserCourse.studentsCompletion(a,function(a){c.open(b(a))})}function CourseCreator(a){"use strict";function b(){function b(b,e){if(b.title.length<3)GT.Notification.showError("Please enter a course name longer than 3 letters.");else if(e)GT.Course.allInstructorsCourses(function(a){d.lightBox.change(c(b,a))});else{d.lightBox.close();var f={course:{title:b.title}};GT.Course.newCourse(f,function(b){b.success?a(b):GT.Notification.showErrorList(b.errors,3e3)})}}var e=document.createDocumentFragment();$(e).append(JST["app/templates/course_creator/start-course-box.us"]());var f=e.querySelector("form"),g=e.querySelector("button"),h=e.querySelector("#create-course-options"),i=h.querySelectorAll("input"),j=i[0],k=i[1];return g.onclick=function(){var a,c=$(f).serializeArray(),d={};for(a=0;a<c.length;a++)d[c[a].name]=c[a].value;return j.checked?(b(d,!1),!1):!!k.checked&&(b(d,!0),!1)},f}function c(b){var c,d,e=document.createDocumentFragment();$(e).append(JST["app/templates/course_creator/duplicate-course-box.us"]());var f=e.querySelector("#finish-sharing"),g=e.querySelector("#course-id"),h=e.querySelector("form");c={url:"https://localhost:3000/courses/all_instructors_courses",types:["duplicable_courses"],forceSingle:!0,tags:!1,sort:!0,placeHolder:"Choose an exi hah haha"};new Picker(g,c,function(a){d=a.courses.shift()});return g.onchange=function(){$(f).css("background-color","#FF4849"),$(f).prop("disabled",!1)},f.onclick=function(){return d?GT.Course.duplicate(d,b.title,function(b){b.success?a(b.course):GT.Notification.showErrorList(b.errors,3e3)}):GT.Notification.showError("Please Select a Course",3e3),!1},h}var d=this;GTCreator.call(d),d.lightBox.id="course-creator",d.lightBox.open(b())}function CourseEditor(a,b,c,d){"use strict";function e(){function a(){var a=$(J).val().length;$(L).text(a)}function c(a){var b;"js-auto-pass"===a.target.id&&(b=F),"js-elective"===a.target.id&&(b=G),b&&(a.target.checked?(b.classList.add("on"),b.classList.remove("off")):(b.classList.add("off"),b.classList.remove("on")))}function d(a){A.classList.remove("hidden"),B.disabled=!1,e(a)}function e(a){C.hold&&p(),C.hold=new Picker(B,a,function(a,c){GT.AutoAssign.get(b.id,function(b){var c=b[0],d={};d=q(),"join-list"==z.value?(d.list_id=parseInt(a.teams[0]),d.dependent_course_id=null):(d.dependent_course_id=parseInt(a.courses[0]),d.list_id=null),c?GT.AutoAssign.update(c.course_id,c.dependent_course_id,c.list_id,d):GT.AutoAssign.create(d,d.course_id)})})}function o(){A.classList.add("hidden"),x.classList.add("hidden"),D.classList.add("off"),D.classList.remove("on"),GT.AutoAssign.get(b.id,function(a){var b=a[0];if(b){var c,d=document.getElementById("prereq-type");null!=b.list_id?(e(V),d.value="join-list",c=document.createElement("option"),c.value="teams-"+b.list_id,c.innerHTML=b.list.title,B.appendChild(c),B.value="teams-"+b.list_id):null!=b.dependent_course_id&&(e(W),d.value="comp-other",c=document.createElement("option"),c.value="courses-"+b.dependent_course_id,c.innerHTML=b.dependent_course.title,B.appendChild(c),B.value="courses-"+b.dependent_course_id),b.active&&(u.checked=b.active,A.classList.remove("hidden"),x.classList.remove("hidden"),D.classList.add("on"),D.classList.remove("off"))}else e(V),D.classList.add("off"),D.classList.remove("on")})}function p(){C.hold.remove(),X=document.createElement("select"),X.setAttribute("id","prereq-list-select"),$(B).replaceWith(X),B=X}function q(){var a={};if("join-list"==z.value)I=B.value,a.list_id=I.substring(I.length-1,I.length),a.list_id=parseInt(a.list_id),a.dependent_course_id=null;else{var c=B.value;a.dependent_course_id=c.substring(c.length-1,c.length),a.dependent_course_id=parseInt(a.dependent_course_id),a.list_id=null}return a.active=u.checked,a.course_id=b.id,a}var r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S={},T=200;account.electives_enabled&&(b.electives_enabled=account.electives_enabled,b.elective&&(b.enabled_elective=b.elective));var U=document.createDocumentFragment();$(U).append(JST["app/templates/course_editor/edit-course-info-container.us"](b)),r=U.querySelector("#edit-media-container"),j=U.querySelector("#edit-tags"),k=U.querySelector("#edit-tags-label"),E=U.querySelector("#js-creator-select"),J=U.querySelector("#edit-description-label textarea"),L=U.querySelector("#spnCharLeft"),i=U.querySelector("#js-edit-course-done-button"),t=U.querySelector("#js-delete-course-button"),u=U.querySelector("#js-auto-assign"),v=U.querySelector("#js-auto-deadline"),w=U.querySelector("#days-input"),y=U.querySelector("#edit-image-title-label input"),s=U.querySelector("#js-auto-pass"),H=U.querySelector("#js-elective"),z=U.querySelector("#prereq-type"),A=U.querySelector("#prereq-list"),B=U.querySelector("#prereq-list-select"),x=U.querySelector("#automatic-assign-prereq-input"),C={},D=U.querySelector("#auto-assign-section"),F=U.querySelector("#auto-pass-section"),G=U.querySelector("#elective-section"),K=U.querySelector("#js-thumbnail-button"),N=U.querySelector("#js-thumbnail-preview"),O=U.querySelector("#js-archive-button"),P=U.querySelector("#js-unarchive-button"),Q=U.querySelector("#js-archive-section"),R=U.querySelector("#js-unarchive-section");var V={url:"https://localhost:3000/lists",placeHolder:"Teams",types:["teams"],forceSingle:!0},W={url:"https://localhost:3000/courses",placeHolder:"Courses",types:["courses"],forceSingle:!0};$(J).keyup(a),$(J).keydown(a),a(),F.addEventListener("change",c),G&&G.addEventListener("change",c),o();var X;return u.addEventListener("change",function(){var a;u.checked?(A.classList.remove("hidden"),x.classList.remove("hidden"),a=!0,D.classList.add("on"),D.classList.remove("off")):(A.classList.add("hidden"),x.classList.add("hidden"),a=!1,D.classList.add("off"),D.classList.remove("on")),GT.AutoAssign.get(b.id,function(b){var c=b[0];c&&(c.active=a,GT.AutoAssign.update(c.course_id,c.dependent_course_id,c.list_id,c))})}),z.addEventListener("change",function(){"join-list"==z.value?d(V):"comp-other"==z.value&&d(W)}),n={placeholder:"Select New Owner",tokenSeparators:[";","; ","\t","\n"],types:["users"],forceSingle:!0,selected:{users:[b.creator]}},m=new Picker(E,n,function(a){var c=function(a,c,d){GT.Course.updateCreator(a,c,b.id,function(){b.creator_id=a,d()})};LightBox.prompt("Would you like to add the previous course owner as an instructor in this course?",[{text:"Yes",callback:function(){c(a.users[0],!0,function(){GT.currentView.changeHash(3,"instructors")})}},{text:"No",callback:function(){c(a.users[0],!1,function(){window.location.hash="#instruct"})}}])}),l={attachTo:k,append:!0,tags:!0,tokenSeparators:[","," ","\t"],attribute:"multiple"},PeoplePicker.tagsOnly(l,function(a,b){j=a,f(a,b)}),i.onclick=function(){window.location.hash="#topic-"+b.first_topic_id},t.onclick=function(){g()},GT.Tile.updateImagePolicy(function(a){M=a}),K.onclick=function(){var a={};a.courseId=b.id,a.security=M,GT.FPWrapper.uploadCourseImage(a,function(a){b.thumbnail=a.thumbnail,N.src=b.thumbnail})},S.titleInput=y,S.autoPassCheckbox=s,S.descriptionBox=J,S.electiveSwitch=H,S.daysTilDeadline=w,S.archived=b.archived,s.onchange=function(){h(S)},w.onchange=function(){w.value>0&&h(S)},v.onchange=function(){v.checked?w.disabled=!1:(w.value=void 0,w.disabled=!0),h(S)},O.onclick=function(){S.archived=!0,Q.classList.add("hidden"),R.classList.remove("hidden"),S.callback=function(){GT.Notification.show("Course Archived"),window.location.reload()},h(S)},P.onclick=function(){S.archived=!1,Q.classList.remove("hidden"),R.classList.add("hidden"),S.callback=function(){GT.Notification.show("Course Restored from Archive"),window.location.reload()},h(S)},j.onchange=function(){h(S)},y.onchange=function(){h(S)},H&&(H.onchange=function(){h(S)}),J.onchange=function(){parseInt(L.innerHTML,10)<=T&&h(S)},r}function f(a,c){var d;GT.Organization.tags(function(b){var e,f;for(f=0;f<b.tags.length;f++)e=document.createElement("option"),e.textContent=b.tags[f].title,d(b.tags[f].id)&&(e.selected=!0),e.value=b.tags[f].id,a.appendChild(e);c()}),d=function(a){var c;for(c=0;c<b.tags.length;c++)if(b.tags[c].id===a)return!0;return!1}}function g(){LightBox.prompt("Are you sure you want to delete this Course?",[{text:"Delete",id:"confirm-delete-button",callback:function(){GT.Course.destroy(b.id,function(a){if(a.success)window.location.hash="#instruct";else{var b="This Course cannot be deleted unless it is archived first.";GT.Notification.showError(b,8e3,"Course Is Active!")}})}},{text:"Cancel",id:"cancel-delete-button",callback:function(){}}],!1)}function h(d){var e,f;e=$(j).val()?$(j).val():[""],d.electiveSwitch&&(f=d.electiveSwitch.checked);var g={course:{title:d.titleInput.value,auto_pass:d.autoPassCheckbox.checked,description:$(d.descriptionBox).val(),default_days_til_deadline:d.daysTilDeadline.value,elective:f,tags:e,archived:d.archived,id:b.id}};GT.Course.update(g,function(e){var f;if(e.success){if(b.title=d.titleInput.value,b.auto_pass=d.autoPassCheckbox.checked,b.description=$(d.descriptionBox).val(),e.tags&&(b.tags=e.tags),c){for(f in e)e.hasOwnProperty(f)&&(b[f]=e[f]);c(b)}b.title&&a.setCourseTitle(b.title),d.callback&&d.callback(!0)}else GT.Notification.showErrorList(e.errors,4e3),$(i).removeAttr("disabled"),d.callback&&d.callback(!1)})}var i,j,k,l,m,n,o=new LightBox({id:"edit-asset",hasShadow:!1,closeButton:!0,closeable:!0,closeCallback:function(){o.close()},customClass:"popup primary-color"});this.div=e()}function CourseinfoView(a,b){"use strict";GTView.call(this);var c,d,e=this;this.div.id="courseinfo-view",this.bodyClass="courseinfo-view",this.beforeTemplateLoad=function(e){GT.Course.get(a,b,function(f){d=f,GTView.setRoles(d.user_role),sideBar.setCourse(d),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(d.user_role,b,function(){})}),GT.Course.autoAssigns(a,function(a){c=a,e(a)})})},this.beforeViewLoad=function(){var c;c=document.createDocumentFragment(),GT.UserCourse.learnersCourseInfo(b,a,function(a){var f,g,h,i,j,k=new DateCalculator;document.createElement("div");for(a.created_at=k.courseDateData(a,a.created_at).assigned_date,f=0;f<a.course.topics.length;f++)for(0===a.course.topics[f].tiles.length&&a.course.topics.splice(f,1),g=0;g<a.course.topics[f].tiles.length;g++)h=a.course.topics[f].tiles[g],i=a.status_data.find(function(a){return a.tile_id===h.id}),h.statusData=i,h.statusClass=GT.tileStatusClass(h,i);a.courseDescription=d.description,a.userCourseId=b,a.done=100===a.completion_percentage||a.marked_complete===!0||0===a.tiles_todo;var k=new DateCalculator;a.course_date_data=k.courseDateData(a,a.viewed_at),$(c).append(JST["app/templates/tile_view/course-info.us"](a)),j=c.querySelector("#js-drop-elective"),j&&(j.onclick=function(){var a=new LightBox,c=document.createDocumentFragment();$(c).append(JST["app/templates/tile_view/elective-drop-prompt.us"]);var d=c.querySelector("#cancel-drop-elective-button");d.onclick=function(){a.close()};var e=c.querySelector("#confirm-drop-elective-button");e.onclick=function(){GT.UserCourse.dropUser(b,function(b){if(b.success)window.location.hash="#learn";else{var c="Failed to Drop Course";GT.Notification.showError(c,8e3,"Error")}a.close()})},a.open(c.querySelector("#drop-elective"))}),e.elements.mainContainer.appendChild(c)})}}function CourseinstructorsView(a){"use strict";GTView.call(this);var b,c=this;this.div.id="courseinstructors-view",this.bodyClass="courseinstructors-view",this.beforeTemplateLoad=function(c){GT.Course.get(a,void 0,function(a){b=a,GTView.setRoles(b.user_role),sideBar.setCourse(b),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(b.user_role,void 0,function(){})}),c(b)})},this.beforeViewLoad=function(){new InstructorsRoster(b.id,function(a){c.elements.mainContainer.appendChild(a)})}}function CourseoptionsView(a){"use strict";GTView.call(this);var b,c,d=this;this.div.id="courseoptions-view",this.bodyClass="courseoptions-view",this.beforeTemplateLoad=function(c){GT.Course.get(a,void 0,function(a){b=a,GTView.setRoles(b.user_role),sideBar.setCourse(b),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(b.user_role,void 0,function(){})}),c(b)})},this.beforeViewLoad=function(){c=new CourseEditor(d,b),d.elements.mainContainer.appendChild(c.div)},this.setCourseTitle=function(a){}}function CoursePermissionEditor(a,b,c){var d,e,f,g,h,j,k,l,m=document.createDocumentFragment();for(a&&a.user.custom_categories.length>0&&a.user.custom_categories.forEach(function(a){b.forEach(function(b){b.id===a.custom_category_type_id&&(b.defaultCategory=a)})}),$(m).append(JST["app/templates/course_permission_editor.us"]({custom_categories:b})),d=m.querySelector("#js-custom-categories"),e=m.querySelector("#js-custom-staff-config"),f=m.querySelector("#js-override-checkbox"),g=m.querySelector("#js-staff-only-checkbox"),h=m.querySelector("#js-edit-permission"),j=m.querySelector("#js-observe-permission"),k=m.querySelector("#js-anyone-checkbox"),l=m.querySelectorAll(".js-custom-category-select"),i=0;i<b.length;i++)b[i].radioButtons=m.querySelectorAll(".js-"+b[i].id+"-radio"),b[i].selectElement=l[i];if(this.staffOnly=function(){return g.checked},this.editPermission=function(){return h.checked},this.categoryPermissions=function(){var a=[];return f.checked&&b.forEach(function(b){var c=b.selectElement.value;c?a.push({category_type_id:b.id,scope:"one",category_id:c.split("-")[2]}):b.radioButtons[1].checked&&a.push({category_type_id:b.id,scope:"theirs"})}),a},b.length>0&&(d.classList.remove("hidden"),b.forEach(function(b){var c=!0;b.radioButtons[0].onclick=function(){b.selectElement.disabled=!0,$(b.selectElement).val(null).trigger("change"),b.theirsIsSelected=!1},b.radioButtons[1].onclick=function(){b.selectElement.disabled=!0,$(b.selectElement).val(null).trigger("change"),b.theirsIsSelected=!0},b.radioButtons[2].onclick=function(){b.selectElement.disabled=!1,b.theirsIsSelected=!1},b.hides_learners&&(b.radioButtons[0].checked=!1,b.radioButtons[1].checked=!0),b.selectElement.disabled=!0;var d={placeholder:"Pick "+b.title,types:["custom_category"],forceSingle:!0,customCategoryTypeIds:[b.id]};if(a){for(i=0;i<a.custom_categories.length;i++)if(a.custom_categories[i].custom_category_type_id===b.id){b.radioButtons[2].checked=!0,d.selected={custom_category:[a.custom_categories[i]]},c=!1;break}c&&(b.radioButtons[0].checked=!0)}new Picker(b.selectElement,d)})),a)a.staff_only?g.checked=!0:a.custom_categories.length>0?(f.checked=!0,e.classList.remove("hidden")):k.checked=!0,"Instructor"===a.role?h.checked=!0:j.checked=!0;else switch(account.organization.permission_scheme){case"flat":k.checked=!0;break;case"staff":g.checked=!0;break;case"custom":f.checked=!0,e.classList.remove("hidden")}f.onclick=function(){e.classList.remove("hidden")},g.onclick=function(){e.classList.add("hidden")},k.onclick=function(){e.classList.add("hidden")},c.appendChild(m)}function CoursesCommon(a,b,c,d){"use strict";function e(){new CourseCreator(function(a){location.hash="#topic-"+a.first_topic_id})}function f(a){var b,c,d,e,f,g=document.createDocumentFragment(),i=new DateCalculator;return a.updated_at&&(a.updated_at=i.formatDateTime(a.updated_at)),"learn"==h.viewType&&(a.course_date_data=i.courseDateData(a,a.viewed_at)),a.color=h.colorSet(a.id),$(g).append(JST["app/templates/course_view/"+h.viewType+"_course.us"](a)),b=g.querySelector("#js-course-thumb"),c=g.querySelector("#js-course-status"),f=g.querySelector("#js-course-title"),e=g.querySelector("#js-course-description"),d=g.querySelector("#js-star-button"),a.user_course_id&&$(c).append(Handlebars.partials.course_status(a)),$(b).attr("tabindex",h.tabIndexCount),h.tabIndexCount++,d.onclick=function(b){var c;c=b.target.parentElement,"star"==h.mode&&$(c).remove(),"☆"===d.textContent?(d.textContent="★",a.user_course_id?GT.UserCourse.star(a.user_course_id):GT.Course.star(a.id),$(this).addClass("starred")):(d.textContent="☆",a.user_course_id?GT.UserCourse.unstar(a.user_course_id):GT.Course.unstar(a.id),$(this).removeClass("starred"))},a.starred&&(d.textContent="★",$(d).addClass("starred")),b.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id)},c.parentElement.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id)},f.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id);
},e.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id)},g}function g(a){var b,c,d,e=document.createDocumentFragment();return a.color=h.colorSet(a.id),$(e).append(JST["app/templates/course_view/"+h.viewType+"_course.us"](a)),b=e.querySelector("#js-course-thumb"),d=e.querySelector("#js-course-title"),c=e.querySelector("#js-course-description"),$(b).attr("tabindex",h.tabIndexCount),h.tabIndexCount++,b.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id)},d.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id)},c.onclick=function(b){GT.Event.fireEvent("Launch",a.user_course_id)},e}var h=this;h.heldView,h.mode=b,h.sort=c,h.viewType=a,h.style,d&&(h.style=d),h.tabIndexCount=1,h.currentOffset=0,h.firstPageLoad=!0,this.colorSet=function(a){switch(a%7){case 1:return"red";case 2:return"orange";case 3:return"yellow";case 4:return"green";case 5:return"blue";case 6:return"indigo";case 0:return"violet";default:return"violet"}},this.drawCourseList=function(a,b,c,d){var f,g,i,j,k,l,m,n,o,p=account,q=document.createDocumentFragment();if(h.style&&("cards"==h.style?p.style="card-style":p.style="list-style"),$(q).append(JST["app/templates/course_view/"+h.viewType+"_view.us"](p)),m=q.querySelector("#course-list"),"instruct"==h.viewType){switch(l=q.querySelector("#js-which-style"),h.style){case"cards":l.selectedIndex=0;break;case"list":l.selectedIndex=1;break;default:l.selectedIndex=0}l.onchange=function(a){switch(a.target.value){case"Cards":$(m).removeClass("list-style"),$(m).addClass("card-style"),account.course_which_display="cards",h.style=account.course_which_display;break;case"List":$(m).removeClass("card-style"),$(m).addClass("list-style"),account.course_which_display="list",h.style=account.course_which_display;break;default:$(m).removeClass("list-style"),$(m).addClass("card-style"),account.course_which_display="cards",h.style=account.course_which_display}},f=q.querySelectorAll(".js-add-course"),account.can_create_course&&($(f).removeClass("hidden"),$(f).click(function(){e()}))}if("instruct"==h.viewType){var r;r=q.querySelector(".simple-dropdown-menu");var s=q.querySelector(".fa-ellipsis-v");s.onclick=function(){$(r).toggleClass("hidden")},account.can_create_course?r.children[1].onclick=function(){e()}:$(r.children[1]).addClass("hidden")}return g=q.querySelector("#course-search"),i=q.querySelector("#course-search-btn"),i.onclick=function(){c(this.previousElementSibling.value)},g.onkeydown=function(a){13===a.which&&c(a.target.value)},d&&(g.value=d),(q.querySelector("#js-which-courses")||q.querySelector("#js-which-sort"))&&(j=q.querySelector("#js-which-courses"),k=q.querySelector("#js-which-sort"),n=a(h.mode,j),o=b(h.sort,k),$(m).addClass(h.mode),j.selectedIndex=n,k.selectedIndex=o),q},this.appendLearnCourseList=function(a,b,c,d){var e;if(e=c,h.firstPageLoad){if(0==a.length){var g=document.createDocumentFragment();$(g).append(JST["app/templates/course_view/no-courses-note.us"]),e.appendChild(g)}a.length<d&&h.heldView.setOutOfCourses(!0),h.firstPageLoad=!1}else a.length<d&&h.heldView.setOutOfCourses(!0);for(var i=0;i<a.length;i++){a[i].sort=h.sort,a[i].mode=h.mode,a[i].user_course_id=a[i].id,a[i].course_id=a[i].course.id,a[i].starred=b.includes(a[i].course.id),a[i].completed=100==a[i].completion_percentage,a[i].passed=a[i].marked_complete===!0,a[i].done=a[i].passed||0==a[i].tiles_todo,a[i].display_tiles_todo=a[i].tiles_todo>0;var j;a[i]&&(j=f(a[i]),e.appendChild(j))}},this.appendElectivesCourseList=function(a,b,c){var d;if(d=b,h.firstPageLoad){if(0==a.length){var e=document.createDocumentFragment();$(e).append(JST["app/templates/course_view/no-courses-note.us"]),d.appendChild(e)}a.length<c&&h.heldView.setOutOfCourses(!0),h.firstPageLoad=!1}else a.length<c&&h.heldView.setOutOfCourses(!0);for(var f=0;f<a.length;f++){var i;a[f]&&(i=g(a[f]),d.appendChild(i))}},this.appendInstructCourseList=function(a,b,c,d){var e;if(e=c,h.firstPageLoad){if(0==a.length){var g=document.createDocumentFragment();$(g).append(JST["app/templates/course_view/no-courses-note.us"]),e.appendChild(g)}else a.length<d&&h.heldView.setOutOfCourses(!0);h.firstPageLoad=!1}else a.length<d&&h.heldView.setOutOfCourses(!0);for(var i=0;i<a.length;i++){a[i].sort=h.sort,a[i].mode=h.mode,a[i].course_id=a[i].id,a[i].starred=b.includes(a[i].id),a[i].ungradings_count>0?a[i].has_ungradings=!0:a[i].has_ungradings=!1;var j;a[i]&&(j=f(a[i]),e.appendChild(j))}},this.getDocHeight=function(){var a=document;return Math.max(a.body.scrollHeight,a.documentElement.scrollHeight,a.body.offsetHeight,a.documentElement.offsetHeight,a.body.clientHeight,a.documentElement.clientHeight)}}function DateCalculator(){"use strict";this.calculateDaysLeft=function(a){if(a.start_date&&a.end_date){var b=a.start_date.split("-");b[2]&&b[2].split("T").length>1&&(b[2]=b[2].split("T")[0]);var c=a.end_date.split("-");c[2]&&c[2].split("T").length>1&&(c[2]=c[2].split("T")[0]);var d=new Date(b[0],b[1]-1,b[2]),e=new Date(c[0],c[1]-1,c[2]),f=new Date,g=Math.round(Math.abs(d-f)/1e3/60/60/24);f.setHours(0,0,0,0),d.setHours(0,0,0,0),e.setHours(0,0,0,0);var h="",i="";return g>1&&(i="s"),Math.round(Math.abs(d)/1e3/60/60/24)>Math.round(Math.abs(f)/1e3/60/60/24)&&g>0?(g>=90&&(g="90+"),h="Begins in "+g+" day"+i):0===g?h="Begins today!":(g=Math.round(Math.abs(e-f)/1e3/60/60/24),i=g>1?"s":"",Math.round(Math.abs(e)/1e3/60/60/24)>Math.round(Math.abs(f)/1e3/60/60/24)&&g>0?h="Ends in "+g+" day"+i:0===g?h="Ends Today!":(g>=90&&(g="90+"),h="Ended "+g+" day"+i+" ago")),h}return"Unknown"},this.daysUntilDeadline=function(a,b){var c=a.end_date.split("-");c[2]&&c[2].split("T").length>1&&(c[2]=c[2].split("T")[0]);var d,e=new Date(c[0],c[1]-1,c[2]),f=new Date;f.setHours(0,0,0,0),e.setHours(0,0,0,0),d=Math.round((e-f)/1e3/60/60/24),b({ends_in:d})},this.userCourseDateParser=function(a){var b,c,d;return b={month:"Jan",day:1},a?(c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],d=a.split("-"),d.length>=3&&(b.month=c[parseInt(d[1],10)-1],b.day=parseInt(d[2],10),b.year=d[0])):b={month:"NEVER",day:""},b},this.formatDateTime=function(a){var b,c,d;return b=new Date(a),c=new Date(Date.now()),d=b.getDate()===c.getDate()&&b.getFullYear()===c.getFullYear()?b.toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric"}).toLowerCase():b.getFullYear()===c.getFullYear()?b.toLocaleDateString("en-US",{day:"numeric",month:"short"}).toUpperCase():b.toLocaleDateString("en-US",{day:"numeric",month:"short",year:"numeric"}).toUpperCase()},this.courseDateData=function(a,b){var c,d,e,f,g,h={},i=new Date;return 100!==a.completion_percentage&&a.marked_complete!==!0||a.completed_at&&(c=a.completed_at.split("T")[0].split("-"),h.completed_at_date=c[1]+"/"+c[2]+"/"+c[0]),d=new Date(a.end_date),d>i?(h.num_days_to_go=Math.ceil((d-i)/1e3/60/60/24),h.num_days_to_go>7?h.one_week_plus=!0:h.num_days_to_go>1?h.one_week=!0:1===h.num_days_to_go?h.one_day=!0:0===h.num_days_to_go&&(h.zero_days=!0)):a.end_date?(e=a.end_date.split("T")[0].split("-"),h.end_date=e[1]+"/"+e[2]+"/"+e[0]):b?(f=new Date(a.created_at),(i-f)/1e3<15&&(h.num_days_ago=Math.round((i-f)/1e3/60/60/24)),g=a.created_at.split("T")[0].split("-"),h.assigned_date=g[1]+"/"+g[2]+"/"+g[0]):h.new_content=!0,a.start_date&&(h.start_date=a.start_date),h}}function Discussion(){"use strict";function a(){m=document.createDocumentFragment(),x.frag=m,$(m).append(JST["app/templates/reader_view/discussion.us"]()),p=m.querySelector("form"),n=m.querySelector("ol"),u=m.querySelector("#tile-description"),s=m.querySelector("#discussion-video-container"),v=m.querySelector("#discussion-video-record"),q=m.querySelector("textarea"),o=m.querySelector("#post-comment-button"),o.onclick=function(){c(),j(q)},v.onclick=function(){var a=new LightBox({id:"confirm-delete",hasShadow:!0});a.prompt("Upload or Record?",[{text:"Record",className:"standard",callback:function(){GT.FPWrapper.recordVideo(function(a,b){$(s).empty();var c={url:a[0].url,videoUrl:a[0].url+"?policy="+b.policy+"&signature="+b.signature};$(s).append(JST["app/templates/reader_view/video-discussion.us"](c)),r=s.querySelector("#video-url-input")})}},{text:"Upload",className:"standard",callback:function(){GT.FPWrapper.uploadVideo(function(a,b){$(s).empty();var c={url:a.url,videoUrl:a.url+"?policy="+b.policy+"&signature="+b.signature};$(s).append(JST["app/templates/reader_view/video-discussion.us"](c)),r=s.querySelector("#video-url-input")})}}])}}function b(a){m=document.createDocumentFragment(),a.can_edit||(a.text=GT.urlify(a.text)),$(m).append(JST["app/templates/reader_view/comment.us"](a));var b=m.querySelector("li"),c=m.querySelector("button"),d=m.querySelector("q");return a.instructor_author&&$(b).addClass("instructor-comment"),a.can_delete?c.onclick=function(b){k(b,a)}:(c.disabled=!0,$(c).addClass("hidden")),a.can_edit&&e(d,a),m}function c(){o.disabled=!0,v.disabled=!0}function d(){o.disabled=!1,v.disabled=!1}function e(a,b){a.contentEditable=!0,$(a).on("keydown",function(a){if(a||(a=window.event),13===a.which)return $("#phantom-input").removeAttr("disabled").focus().blur().attr("disabled","disabled"),window.scrollTo(0,1),!1}),$(a).blur(function(){var c=$(a).text().length;return c>1e3?GT.Notification.showError("<strong>Comments Can Be 1000 Characters Or Less</strong><br />",2500):0===c?GT.Notification.showError("<strong>Comments Cannot Be Empty</strong><br />",2500):h(a,b),!1})}function f(){$(u).addClass("editable"),u.contentEditable=!0,$(u).focus(function(){$(this).addClass("tile-data-focus")}).blur(function(){x.onBlurSave()}).keypress(function(){return x.onKeyPress(1e3,this)})}function g(){$(u).addClass("editable"),u.contentEditable=!1,$(u).unbind("focus"),$(u).unbind("blur"),$(u).unbind("keypress")}function h(a,b){var c={id:b.id,tile_id:t.id,text:$(a).text()};Comment.update(c,function(){})}function i(){var a=p.querySelector("textarea");if(d(),$(a).attr("readonly",!1),$(a).attr("placeholder","Comments..."),t){var c={tile_id:t.id};Comment.index(c,function(a){var c=document.createDocumentFragment();if(a)for(var d=0;d<a.length;d++)$(c).prepend(b(a[d]));$(n).empty(),n.appendChild(c)})}}function j(a){var c={tile_id:t.id,text:a.value};r&&r.value&&(c.url=r.value),Comment.create(c,function(c){c.success?($(s).empty(),a.value="",r&&(r.value=""),$(n).prepend(b(c)),d()):GT.Notification.showErrorList(c.errors.text,1)})}function k(a,b){if(!x.lockDeleteLightBox){x.lockDeleteLightBox=!0,a.stopPropagation();var c=new LightBox({id:"confirm-delete"});c.prompt("Are you sure you want to delete this comment?",[{text:"Delete",id:"confirm-delete-button",callback:function(){Comment.destroy(b.id,{tile_id:t.id},function(){i(),x.lockDeleteLightBox=!1})}},{text:"Cancel",id:"cancel-delete-button",callback:function(){x.lockDeleteLightBox=!1}}])}}function l(){var a={textblock:t.textblock,position:t.position,title:t.title,id:t.id};GT.Tile.update(a,function(a){a.success||GT.Notification.showError("<strong>Save Failed!</strong><br />"+a.errors[0],2500)})}var m,n,o,p,q,r,s,t,u,v,w,x=this;a(),this.onKeyPress=function(a,b){$(u).on("keydown",function(c){if(13===c.which)return $("#phantom-input2").removeAttr("disabled").focus().blur().attr("disabled","disabled"),window.scrollTo(0,1),c.preventDefault(),c.stopPropagation(),b.textContent.length<a})},this.onBlurSave=function(){t.textblock=$(u).text(),l(),$(u).removeClass("tile-data-focus")},this.setTile=function(a){var b=function(){$(u).empty(),u.removeEventListener("click",b)};$(u).empty(),a&&(a.textblock&&""!==a.textblock.trim()?$(u).html(a.textblock):"Instructor"===w.user_role&&(u.appendChild(document.createTextNode("Enter instructions or discussion starter here.")),u.addEventListener("click",b))),t=a,i()},this.setCourse=function(a){w=a,w.can_edit?f():g(),i()}}function EditinstructorView(a){"use strict";GTView.call(this);var b,c=this;this.bodyClass="editinstructor-view",this.beforeTemplateLoad=function(c){GT.UserCourse.get(a,function(a){b=a,GTView.setRoles(b.user_role),sideBar.setCourse(b.course),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(b.user_role,void 0,function(){})}),c(b)})},this.beforeViewLoad=function(){var a=document.createElement("div");GT.Filters.customCategories(function(d){var e=new CoursePermissionEditor(b,d,a);c.elements.permissionEditor.appendChild(a),c.elements.cancelButton.onclick=function(){window.location.hash="#courseinstructors-"+b.course_id},c.elements.saveButton.onclick=function(){var a={only_staff:e.staffOnly(),categories:[]};a.only_staff||(a.categories=e.categoryPermissions()),a.editor=e.editPermission(),GT.UserCourse.updatePermissions(b.id,a,function(){window.location.hash="#courseinstructors-"+b.course_id})}})}}function EditpersonView(a){"use strict";function b(b,k){function l(){new Picker(g,n),new Picker(h,p),new Picker(u,o,function(a){v=a.teams})}var m,n,o,p,q,r,s,t,u,v,w,x,y,z,A;m=document.createDocumentFragment(),b&&b.hired_at&&(b.hired_at=b.hired_at.split("T")[0]),$(m).append(JST["app/templates/editperson_view/editperson_view.us"]({user:b,hasCustomCategories:account.organization.custom_category_types.length>0,custom_category_types:account.organization.custom_category_types})),g=m.querySelector("#js-boss-id"),h=m.querySelector("#js-title"),q=m.querySelector("#js-done-button"),f=m.querySelector("#js-person-form"),A=m.querySelector("#js-hired-at"),r=m.querySelector("#js-can-create"),s=m.querySelector("#js-is-admin"),t=m.querySelector("#js-is-basic"),u=m.querySelector("#js-list-select"),w=m.querySelector("#js-add-to-list"),x=m.querySelector("#js-lists"),y=m.querySelector("#js-delete-user"),z=m.querySelector("#js-reset-password"),$(A).datepicker({dateFormat:"yy-mm-dd"}),x&&d(x,k),"create"===e&&(t.checked=!0),"edit"===e?(account.organization.custom_category_types.forEach(function(c){var d=m.querySelector("#js-category-type-"+c.id),e=b.custom_categories.filter(function(a){return a.custom_category_type_id===c.id})[0],f={placeholder:"Pick "+c.title,types:["custom_category"],forceSingle:!0,customCategoryTypeIds:[c.id],selected:{custom_category:[e]}};b.external_id&&c.flat_file_column_name&&(d.disabled=!0),new Picker(d,f,function(b){var d={custom_category_type_id:c.id,custom_category_id:b.custom_category[0]};GT.User.updateCategegory(d,a)})}),q.href="#person-"+a+"-learn","InstructionalAdmin"===b.user_type?s.checked=!0:b.can_create_course?r.checked=!0:t.checked=!0):(q.textContent="Create User",q.onclick=function(){c(),GT.User.create(j,function(a){a.success?window.location.href="#import":a.errors&&a.errors instanceof Array&&GT.Notification.showErrorList(a.errors)})}),x&&(w.onclick=function(){GT.User.addToList(a,v,function(a){k=a,d(x,a)})}),o={selectListener:!0,placeholder:"Add to another list",tokenSeparators:[","],cssRule:{width:"455px !important"},types:["teams"]},p={selectListener:!0,placeholder:"Select Title",forceSingle:!0,cssRule:{width:"455px !important"},types:["job_titles"],allowCreate:!0},n={selectListener:!0,placeholder:"Select User",forceSingle:!0,cssRule:{width:"100%"},types:["users"]},b&&b.boss_id?GT.User.get(b.boss_id,function(a){a?n.selected={users:[a]}:GT.Notification.showError("This user's leader no longer exists"),l()}):l(),y&&(y.onclick=function(){GT.User.setDeleted(a,function(a){window.location.hash="#people"})},z.onclick=function(){var b,c,d,e,f,g,h;b=new LightBox,c=document.createDocumentFragment(),$(c).append(JST["app/templates/editperson_view/password_reset.us"]()),d=c.querySelector("#js-change-password"),g=c.querySelector("#js-show-password"),h=c.querySelector("#js-password-input"),e=c.querySelector("#js-email"),f=c.querySelector("#js-user"),g.onclick=function(a){a.preventDefault(),"password"===h.type?h.type="text":h.type="password"},e.onclick=function(){g.disabled=!0,h.disabled=!0},f.onclick=function(){g.disabled=!1,h.disabled=!1},d.onclick=function(c){c.preventDefault(),e.checked===!0?GT.User.resetPassword(a,void 0,function(a){}):GT.User.resetPassword(a,h.value,function(a){}),GT.Notification.show("Password reset email sent."),b.close()},b.open(c)}),"edit"===e&&(f.onchange=function(){c(),GT.User.update(j,function(a){a.success||GT.Notification.showErrorList(a.errors)})}),i.div.appendChild(m)}function c(){var b,c;b=$(f).serializeArray();for(c in b)if(b.hasOwnProperty(c))if(""!==b[c].value)j[b[c].name]=b[c].value;else if("first_name"===b[c].name||"last_name"===b[c].name||"email"===b[c].name)return void GT.Notification.showError("Please fill a frist name, last name, and email.");g&&(j.boss_id=g.value.split("-")[1]),h&&(j.title=h.children[h.selectedIndex].textContent,j.job_title_id=h.value.split("-")[1]),"can_create"===j.permission?(j.can_create_course=!0,j.user_type="User"):"admin"===j.permission?(j.can_create_course=!0,j.user_type="InstructionalAdmin"):(j.can_create_course=!1,j.user_type="User"),j.id=a}function d(b,c){var d,e,f;e=function(){var b,c=this;b=this.getAttribute("data-list-id"),GT.User.removeFromList(a,b,function(){$(c.parentElement).remove()})},d=document.createDocumentFragment(),$(d).append(JST["app/templates/editperson_view/team-item.us"]({lists:c})),f=d.querySelectorAll(".js-delete-button"),$(f).click(e),$(b).empty(),b.appendChild(d)}GTView.call(this),this.bodyClass="person-view";var e,f,g,h,i=this,j={};e=a?"edit":"create",this.createMarkup=function(){"edit"===e?GT.User.get(a,function(c){sideBar.fillPersonSideBar(c,c.id,"edit"),GT.User.lists(a,function(a){b(c,a)})}):(sideBar.fillMainSideBar(),b())}}function ElectivesView(a,b){"use strict";function c(){var c=new LightBox,d=document.createDocumentFragment();GT.Course.electiveTitle(a,function(e){$(d).append(JST["app/templates/course_view/elective-add-prompt.us"](e));var f=d.querySelector("#cancel-add-elective-button");f.onclick=function(){c.close(),b?history.replaceState({page:"/#electives--"+b},"","/#electives--"+b):history.replaceState({page:"/#electives"},"","/#electives")};var g=d.querySelector("#confirm-add-elective-button");g.onclick=function(){GT.Course.addElective(a,function(b){var d;if(b.success)d=i.querySelector('[value="'+a+'"]'),d.parentNode.removeChild(d),c.close(),GT.Notification.show("Elective Added"),history.replaceState({page:"/#electives"},"","/#electives");else{var e="Failed to Add Course";GT.Notification.showError(e,8e3,"Error")}})},c.open(d.querySelector("#add-elective"))})}function d(a){h.changeHash(1,"-"+a)}function e(){var a=Math.round($(window).scrollTop()+$(window).height());a>=n.getDocHeight()&&k&&!l&&(k=!1,setTimeout(function(){k=!0},400),g(b,n.currentOffset,j,0))}function f(){var a=n.drawCourseList(null,null,d,b);i=a.querySelector(".js-course-list"),g(b,n.currentOffset,j,m),h.div.appendChild(a)}function g(a,b,c,d){GT.Course.lazyElectives(a,b,c,d,function(a){var b=a.courses;n.appendElectivesCourseList(b,i,j);var c=document.querySelector('[href="#electives"]');c&&(c.classList.contains("current")||(document.querySelectorAll("#side-bar a.current")[0].classList.remove("current"),c.classList.add("current"))),n.currentOffset+=b.length,k=!0},i)}GTView.call(this);var h=this;b&&(b=decodeURIComponent(b)),this.div.className="electives-view",this.bodyClass="electives-course-view";var i,j=40,k=!0,l=!1,m=3e3;this.setOutOfCourses=function(a){l=a},this.parameterOnLoad=function(a){var b=location.hash.split("-");b.length>1?a(location.hash,!1):a(this.hash,!0)};var n=new CoursesCommon("electives",null,null);n.heldView=this,this.hash="#electives";this.createMarkup=function(){sideBar.fillMainSideBar(),GTView.unsetRoles(),f(),a&&c()},this.changeHash=function(a,b){var c;c=window.location.hash.split("-"),c[a]=b,c.length=a+1,window.location.hash=c.join("-")},this.handleArgChange=function(d,e){return d?(a=d,c(),!0):e?($(i).empty(),b=e,$("#course-search")[0].value=b,n.currentOffset=0,n.firstPageLoad=!0,l=!1,g(b,n.currentOffset,j,m),!0):void 0},window.addEventListener("scroll",e),this.destroy=function(){window.removeEventListener("scroll",e)}}function Filterer(a,b,c){"use strict";function d(a){var c=new Filter(a,l,function(a){if(a){var d=i.indexOf(c);i.splice(d,1)}b()});c.contextId=k.contextId,c.context=k.context,i.push(c),g.appendChild(c.getFrag()),a&&(j||a.locked)&&c.disable()}var e,f,g,h,i=[],j=!1,k=this,l=[];this.context=void 0,this.contextId=void 0,a&&(e=document.createDocumentFragment(),$(e).append(JST["app/templates/filterer/filterer.us"]()),f=e.querySelector("#filter-area"),g=e.querySelector("#filter-group"),h=e.querySelector("#add-filter"),a.appendChild(e),h.onclick=function(){d(),k.addFilterCallback&&k.addFilterCallback()}),this.allFiltersSet=function(){var a=0;for(a=0;a<i.length;a++)if(!i[a].getValue())return!1;return!0},this.numberOfFilters=function(){return i.length},this.hide=function(){f&&f.classList.add("hidden")},this.show=function(){f&&f.classList.remove("hidden")},this.disable=function(){i.forEach(function(a){a.disable()}),j=!0,h.disabled=!0,h.classList.add("hidden")},this.enable=function(){i.forEach(function(a){a.enable()}),j=!1,h.disabled=!1,h.classList.remove("hidden")},k.changeContext=function(a){k.contextId=a.id,i=[],g&&$(g).empty(),a.filters.forEach(function(a){c||(a.locked=!1),d(a)}),b&&b()},this.fetchFilters=function(a){GT.Filters.filterableCustomCategories(function(b){l=b,g&&GT.Filters.loadFilters(k.contextId,k.context,function(b){g&&$(g).empty(),0===b.length&&d(),b.forEach(function(a){c||(a.locked=!1),d(a)}),a&&a(b.length>0)})},k.contextId)}}function Filter(a,b,c){function d(){$(j).empty()}function e(){var b,c,d=document.createDocumentFragment();if("status"===a.filter_type)$(d).append(JST["app/templates/roster_view/status-select.us"]()),b=d.querySelector("select"),a.value&&($(b).val(a.value).selected=!0),$(b).on("change",function(b){a.value=b.target.value,f()});else if("has_reports"===a.filter_type||"has_no_reports"===a.filter_type)f();else if("teams"===a.filter_type||"bosses"===a.filter_type||"job_titles"===a.filter_type||"all_bosses"===a.filter_type){$(d).append(JST["app/templates/select-2-builder/select2-assigner.us"]({})),b=d.querySelector("select");var e={placeholder:"Search",hideTitles:!0,types:[a.filter_type],forceSingle:!0};if(c=function(){new Picker(b,e,function(b){a.value=b[e.types[0]],f()})},a.value){var g={};g[a.filter_type]=JSON.parse(a.value),GT.User.loadSelectTwoFilter(g,function(a){e.selected=a,c()})}else c()}else if("custom_category"===a.filter_type){$(d).append(JST["app/templates/select-2-builder/select2-assigner.us"]({})),b=d.querySelector("select");var e={placeholder:"Search",hideTitles:!0,types:[a.filter_type],customCategoryTypeIds:[a.custom_category_type_id],forceSingle:!0};if(c=function(){new Picker(b,e,function(b){a.value=b[e.types[0]][0],f()})},a.value){var g={};g.custom_category_type_ids=[],g.custom_category_type_ids.push(a.custom_category_type_id),g["custom_category-"+a.custom_category_type_id]=JSON.parse(a.value),GT.User.loadSelectTwoFilter(g,function(a){e.selected=a,c()})}else c()}else if("learner_status"===a.filter_type)$(d).append(JST["app/templates/people_view/learner-status-select.us"]()),b=d.querySelector("select"),a.value&&($(b).val(a.value).selected=!0),$(b).on("change",function(b){a.value=b.target.value,f()});else{$(d).append(JST["app/templates/roster_view/date-filter.us"]());var h=d.querySelector("input");$(h).datepicker({dateFormat:"yy-mm-dd"}),a.value&&$(h).val(a.value),h.onchange=function(b){a.value=b.target.value,f()}}j.appendChild(d)}function f(){a&&a.id?GT.Filters.update(a.id,a.filter_type,a.value,a.custom_category_type_id,function(a){c(!1)}):GT.Filters.create(k.contextId,k.context,a.filter_type,a.value,a.custom_category_type_id,function(b){a=b,c(!1)})}var g,h,i,j,k=this;this.context=void 0,this.contextId=void 0,a||(a={},a.filter_type="job_titles"),k.disable=function(){i.disabled=!0,g&&(g.disabled=!0,g.classList.add("hidden")),j.querySelectorAll("select").forEach(function(a){a.disabled=!0}),j.querySelectorAll("input").forEach(function(a){a.disabled=!0})},k.enable=function(){a.locked||(i.disabled=!1,g&&(g.disabled=!1,g.classList.remove("hidden")),j.querySelectorAll("select").forEach(function(a){a.disabled=!1}),j.querySelectorAll("input").forEach(function(a){a.disabled=!1}))},k.setFilterId=function(b){a.id=b},k.getValue=function(){return a.value},k.getFrag=function(){var f=document.createDocumentFragment(),l=!0,m={teams:!1,bosses:!0,all_bosses:!0,job_titles:!0,status:!1,completed_on:!1,start_before:!1,start_after:!1,start_date_of:!1,end_before:!1,end_after:!1,end_date_of:!1,learner_status:!1,has_reports:!0,has_no_reports:!0,hired_before:!0,hired_after:!0};switch(k.context){case"User":case"people":m.teams=l,m.learner_status=!0;break;case"AssignmentRule":break;case"roster":case"Course":default:m.status=!0,m.completed_on=!0,m.start_before=!0,m.start_after=!0,m.start_date_of=!0,m.end_before=!0,m.end_after=!0,m.end_date_of=!0,m.teams=l}return $(f).append(Handlebars.partials.filter({filter:a,options:m})),h=f.querySelector(".filter-item"),g=f.querySelector(".remove-filter"),j=f.querySelector(".sub-filter"),i=f.querySelector(".filter-type"),b&&b.forEach(function(a){var b;b=document.createElement("option"),b.value="custom_category-"+a.id,b.textContent=a.title+" is",i.appendChild(b)}),a&&a.filter_type&&("custom_category"===a.filter_type?i.value=a.filter_type+"-"+a.custom_category_type_id:i.value=a.filter_type),g&&(g.onclick=function(){a.id?GT.Filters.destroy(a.id,function(){$(h).remove()}):$(h).remove(),c(!0)}),i.onchange=function(b){a.filter_type=b.target.value.split("-")[0],"custom_category"===a.filter_type&&(a.custom_category_type_id=b.target.value.split("-")[1]),a.value=null,d(),e()},e(),f}}function GTCreator(a){"use strict";var b=this;b.lightBox=new LightBox({closeButton:!0,closeCallback:b.closeCallback,hasShadow:!0,closeable:!0,customClass:"popup primary-color"}),this.closeCallback=function(a){b.doneCallback&&b.doneCallback(a),b.lightBox.close()},this.parseSearchQuery=function(a){return"http"===a.substring(0,4)||"www."===a.substring(0,4)?"WebClip":a.length<2&&(GT.Notification.showError("Please enter a search term containing two or more letters."),!0)}}function GTView(){"use strict";this.div=document.createElement("div");var a=this;this.elements={},this.present=function(){function b(){$("html, body").animate({scrollTop:0},{duration:500,easing:"swing"}),a.stage=document.getElementById("stage"),a.drawSideBar(),a.createMarkup(),a.hash&&location.hash!==a.hash&&(a.parameterOnLoad?a.parameterOnLoad(function(a,b){pageload.ignorehashchange=b,location.hash=a}):(pageload.ignorehashchange=!0,location.hash=a.hash)),a.stage.appendChild(a.div),a.postMarkupAppend&&a.postMarkupAppend(),$(document.body).addClass(a.bodyClass),$(a.div).fadeIn(function(){a.viewDidLoad()}),GT.currentView=a}if(account.terms_accepted===!1&&"undefined"!=typeof account.terms_accepted){var c=new AcceptTerms(account);c.init()}GT.courseParam&&account.id?new AssignStudentCourse(GT.courseParam,function(){b()}):b()},this.empty=function(){$(this.div).empty()},this.dismiss=function(b){$(this.div).fadeOut(function(){var c;for(c=0;c<GT.openLightboxes.length;c++)GT.openLightboxes[c].close();a.destroy&&a.destroy(),$(this).remove(),$(document.body).removeClass(a.bodyClass),b&&b(),a.empty()})},this.createMarkup=function(){var b,c,d=document.createDocumentFragment(),e=window.location.hash.split("-")[0].substr(1);a.beforeTemplateLoad(function(f){$(d).append(JST["app/templates/"+e+"_view/"+e+"_view.us"](f)),b=d.querySelectorAll('*[id^="js-"]'),b.forEach(function(b){var c,d=b.id.split("-"),e=d[1];for(c=2;c<d.length;c++)e+=d[c].charAt(0).toUpperCase()+d[c].substring(1);a.elements[e]=b}),c=d.querySelectorAll('*[class^="js-"]'),c.forEach(function(b){var c,d=b.classList[0].split("-"),e=d[1];for(c=2;c<d.length;c++)e+=d[c].charAt(0).toUpperCase()+d[c].substring(1);a.elements[e]?a.elements[e].push(b):a.elements[e]=[b]}),a.beforeViewLoad(),a.div.appendChild(d)})},this.beforeTemplateLoad=function(a){a({})},this.beforeViewLoad=function(){},this.viewDidLoad=function(){},this.onScrollBottom=function(){},this.drawSideBar=function(){},this.handleArgChange=function(){return!1},this.changeHash=function(a,b){var c;c=window.location.hash.split("-"),c[a]=b,window.location.hash=c.join("-")},this.checkLogin=function(a,b,c,d){User.checkLogin(a,b,c,function(a){a.success?(account=a.account,GT.redirectToSubDomain(),Honeybadger.setContext(account),GTView.setModes(),GTView.setBrand(),account.instructs_courses?window.location.hash="#instruct":window.location.hash="#learn",sideBar.initialize()):(GT.Notification.showError(a.error),d())})}}function HelpFeedback(){"use strict";var a,b,c,d,e,f;this.init=function(){function g(){var g=document.createDocumentFragment();return $(g).append(JST["app/templates/sidebar/help-feedback.us"](account)),e=g.querySelector("#container"),a=g.querySelector("#send-feedback-button"),b=g.querySelector("#feedback-name"),c=g.querySelector("#feedback-email"),d=g.querySelector("#feedback-message"),f=g.querySelector("#support-email"),1===account.organization.support_emails.length&&(f.lastElementChild.selected=!0,f.classList.add("hidden")),a.onclick=function(){var a;return a={name:b.value,email:c.value,message:d.value},f&&(a.supportEmail=f.value),"null"===a.supportEmail?void GT.Notification.showError("Please Select a Recipient"):void Support.createTicket(a,function(a){a.success===!0?(GT.Notification.show(a.message),i.close()):GT.Notification.showError(a.errors)})},e}function h(){i.open(g())}var i=new LightBox({id:"edit-asset",hasShadow:!0,closeButton:!0,closeable:!0,closeCallback:function(){i.close()},customClass:"popup primary-color"});h()}}function ImportView(){"use strict";function a(a){$(a).hasClass("hidden")?$(a).removeClass("hidden"):$(a).addClass("hidden")}function b(a){n=x.files,ja.readAsText(n[0]),ja.onload=function(a){l=ja.result.replaceAll("\r","\n"),l=l.replaceAll("\n\n","\n"),m=l.split("\n"),r=i(m),m=r[0].people,D={users:m,emails:r[1].emails_list},oa={errorLines:r[1].errorLines,dupeLines:r[1].dupeLines,master:r[1].masterRef},D.users.length>0||D.emails.length>0?c():(q.classList.add("hidden"),S.classList.remove("hidden"))}}function c(){GT.User.checkDupesImport(D,function(b){window.account.organization.user_limit&&b.users.length>account.organization.user_limit-account.organization.user_count&&GT.Notification.showError("Your organization has reached its user limit ("+account.organization.user_limit+" users). Please contact sales@tryskillo.com to increase your user limt.");for(var c=0;c<b.dupe_emails.length;c++)b.dupe_emails[c]=b.dupe_emails[c].replace(/\s+/g,"");D=e(b.users,b.dupe_emails),$("multi-error-ref").onclick=function(){a(_)},$("single-error-ref").onclick=function(){a(_)},$("single-dupe-ref").onclick=function(){a(Z)},b.users.length>0?(d(z,D.users,!0),b.users.length==b.duplicates?F.classList.remove("hidden"):E.classList.remove("hidden")):F.classList.remove("hidden");for(var f=b.dupe_emails,i=[],c=0;c<f.length;c++)i.push(oa.master[f[c].toLowerCase()][0]);if(r[1].duplicate+=b.dupe_emails.length,r[1].errors>0){for(;ca.firstChild;)ca.removeChild(ca.firstChild);1==r[1].errors?(G.innerHTML=U,aa=document.getElementById("single-error-ref"),aa.onclick=function(){a(Z)},G.classList.remove("hidden")):(A.innerHTML=r[1].errors+T,ba=document.getElementById("multi-error-ref"),ba.onclick=function(){a(Z)},A.classList.remove("hidden")),j(oa.errorLines,ca)}if(r[1].duplicate>0){for(;ga.firstChild;)ga.removeChild(ga.firstChild);for(;fa.firstChild;)fa.removeChild(fa.firstChild);1==r[1].duplicate?(H.innerHTML=W,ea=document.getElementById("single-dupe-ref"),ea.onclick=function(){a(_)},H.classList.remove("hidden")):(B.innerHTML=r[1].duplicate+V,da=document.getElementById("multi-dupe-ref"),da.onclick=function(){a(_)},B.classList.remove("hidden")),j(oa.dupeLines,ga),j(i,fa)}q.classList.add("hidden"),y.classList.remove("hidden"),w.onclick=function(){t.checked?(D={users:D.users,updates:D.updates,emails:D.emails,list_ids:ka.listPicked},D.list_ids.length>0&&(na=!0)):u.checked?(D={users:D.users,updates:D.updates,emails:D.emails,new_list_name:document.getElementById("new-team-text").value},D.new_list_name.length>0&&(na=!0)):na=!0,na&&!ma?(y.classList.add("hidden"),K.classList.remove("hidden"),GT.User.listImport(D,g,h)):ma?GT.Notification.showError("List Name has been taken",3e3,"Submission Error"):GT.Notification.showError("Please fill in the team field",5e3,"Submission Error");
}})}function d(a,b){$(a).empty(),f(a,b)}function e(a,b){for(var c={users:[],updates:[],emails:[]},d=b.join("|").toLowerCase().split("|"),e=0;e<a.length;e++)d.includes(a[e][1].email.toLowerCase())?(c.updates.push(a[e][1]),c.emails.push(a[e][1].email)):c.users.push(a[e][1]);return c}function f(a,b){var c,d,e,f=window.account.organization.user_limit,g=window.account.organization.user_count,h=b.length;for(f&&h+g>f&&(h=f-g),E.innerHTML=h+X,h>10?h=10:0==h&&(ha.classList.add("hidden"),E.innerHTML=h+" users will be created."),c=0;c<h;c++)d=document.createDocumentFragment(),$(d).append(JST["app/templates/people_view/import-list-person.us"](b[c])),e=d.querySelector("#js-remove-user"),$(e).remove(),a.appendChild(d)}function g(a){var b=2,c=a.currentTarget.response;if(0!=c.length){for(;";"!=c[c.length-b];)b+=1;if(L=parseInt(c.substring(c.length-b+1,c.length-1)),M=0!=D.users.length?L/D.users.length*100:100,u.checked&&(L==D.users.length||c.includes("max_reached"))){var d=b;for(b+=1;";"!=c[c.length-b];)b+=1;D={users:D.users,updates:D.updates,emails:D.emails,list_ids:[parseInt(c.substring(c.length-b+1,c.length-d))]}}}else L=0,M=100;return P.innerHTML=Math.floor(M)+"%",O.style.width=M+"%",(L==D.users.length||c.includes("max_reached"))&&(J.innerHTML="Updating users...",P.innerHTML="0%",O.style.width="0%",Y.innerHTML=L+Y.innerHTML,window.account.organization.user_count+=L,u.checked)?{status:!0,list_ids:D.list_ids}:{status:!1}}function h(a){var b=2,c=a.currentTarget.response;if(c.length>1){for(;";"!=c[c.length-b];)b+=1;L=parseInt(c.substring(c.length-b+1,c.length-1)),M=L/D.updates.length*100}else L=0,M=100;P.innerHTML=Math.floor(M)+"%",O.style.width=M+"%",L==D.updates.length&&(C.classList.remove("hidden"),K.classList.add("hidden"),window.location.hash="#import-success")}function i(a){var b=0,c=0,d=[],e=[],f=[];d.push({people:[]});for(var g={},h=[],i=/^[a-z0-9!#$%&'*+\/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+\/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/i,j=0;j<a.length;j++)D=a[j].split(","),D.length>=3?(D[0]=D[0].replace(/\s+/g,""),D[1]=D[1].replace(/\s+/g,""),D[2]=D[2].replace(/\s+/g,""),D[0].length>0&&D[1].length>0&&D[2].length>0?D[2].includes("@")&&D[2].includes(".")&&i.test(D[2])?g.hasOwnProperty(D[2])?(c++,f.push(j+1),g[D[2]].push(j+1)):(g[D[2].toLowerCase()]=[j+1],d[0].people.push({first_name:D[0],last_name:D[1],email:D[2]}),h.push(D[2])):(b++,e.push(j+1)):(D[0].length>0||D[1].length>0||D[2].length>0)&&(b++,e.push(j+1))):(b++,e.push(j+1));return d.push({errors:b,duplicate:c,emails_list:h,dupeLines:f,errorLines:e,masterRef:g}),d}function j(a,b){a.sort(function(a,b){return a>b?1:-1});for(var c=0,d=0,e=0;e<a.length;)if(e++,a[e-1]==a[e]-1)d=e;else{var f=document.createElement("li");d==c?f.textContent=a[c]:f.textContent=a[c]+"-"+a[d],b.appendChild(f),c=e,d=e}}GTView.call(this);var k=this;this.bodyClass="import-view",this.div.id="import-view";var l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,aa,ba,ca,da,ea,fa,ga,ha,ia,ja=new FileReader,ka={},la={url:"https://localhost:3000/lists",placeHolder:"Teams",types:["teams"],forceSingle:!1},ma=!1,na=!1,oa={};this.createMarkup=function(){sideBar.fillMainSideBar(),k.div.appendChild(k.getElement())},this.getElement=function(){return o=document.createDocumentFragment(),$(o).append(JST["app/templates/people_view/import-users.us"](account.organization)),ia=o.querySelector("#js-create-user"),p=o.querySelector("#existing-team-select"),x=o.querySelector("#files"),R=o.querySelector("#cancel-button"),Q=o.querySelector("#failed-button"),t=o.querySelector("#existing-team"),u=o.querySelector("#new-team"),v=o.querySelector("#no-team"),w=o.querySelector("#submit-button"),q=o.querySelector("#main-contents"),y=o.querySelector("#import-preview"),z=o.querySelector("#roster-list"),A=o.querySelector("#number-errors"),B=o.querySelector("#number-duplicates"),E=o.querySelector("#student-display"),C=o.querySelector("#import-success"),F=o.querySelector("#no-creation"),N=o.querySelector("#new-team-text"),J=o.querySelector("#import-progress-text"),K=o.querySelector("#progress-section"),O=o.querySelector("#inner-meter"),P=o.querySelector("#inner-text"),S=o.querySelector("#no-valid-users"),Y=o.querySelector("#success-users-count"),G=o.querySelector("#single-error"),H=o.querySelector("#single-duplicate"),_=o.querySelector("#dupe-line-section"),Z=o.querySelector("#error-line-section"),aa=o.querySelector("#single-error-ref"),ba=o.querySelector("#multi-error-ref"),ea=o.querySelector("#single-dupe-ref"),da=o.querySelector("#multi-dupe-ref"),ga=o.querySelector("#csv-dupe-list"),fa=o.querySelector("#db-dupe-list"),ca=o.querySelector("#error-list"),ha=o.querySelector("#js-roster-preview"),account.organization.allow_external_accounts&&(ia.onclick=function(a){!account.organization.user_limit||account.organization.user_count<account.organization.user_limit||(a.preventDefault(),GT.Notification.showError("Your organization has reached its user limit ("+account.organization.user_limit+" users). Please contact sales@tryskillo.com to increase your user limt."))},x.addEventListener("change",b,!1)),X=String(E.innerHTML),I=!1,ka.listPicked=[],T=String(A.innerHTML),U=String(G.innerHTML),V=String(B.innerHTML),W=String(H.innerHTML),s=new Picker(p,la,function(a,b){ka.listPicked=a.teams}),o.querySelector("#js-existing-team-span").onclick=function(){$(".select2-search__field").focus()},R.onclick=function(){na=!1,H.classList.add("hidden"),G.classList.add("hidden"),A.classList.add("hidden"),B.classList.add("hidden"),q.classList.remove("hidden"),y.classList.add("hidden"),Z.classList.add("hidden"),_.classList.add("hidden"),ha.classList.remove("hidden")},Q.onclick=function(){q.classList.remove("hidden"),S.classList.add("hidden")},N.onfocus=function(){u.checked=!0},t.onchange=function(){t.checked&&(N.value="",ma=!1)},v.onchange=function(){u.checked&&(N.value="",ma=!1)},N.onchange=function(){GT.List.exists(N.value,function(a){a.response?(GT.Notification.showError("This list name is taken",3e3,"Submission"),ma=!0):ma=!1})},o},String.prototype.replaceAll=function(a,b){var c=this;return c.replace(new RegExp(a,"g"),b)}}function InstructorAssigner(a,b){"use strict";function c(c){function e(a){var b,c="user";a>1&&(c+="s"),a>0?(i.checked?k.textContent="Accounts will be created for "+a+" new "+c+".  All new users and course members will be notified by email.":k.textContent="Accounts will be created for "+a+" new "+c+".  Only new users will be notified by email.",b=document.createElement("a"),b.textContent=" Who?",b.onclick=function(){var b="";a.length>0&&(b+="Instructors:\n",b+=a.join("\n"),b+="\n"),window.alert(b)},k.appendChild(b)):k.textContent=""}function f(){e(p),h.disabled=!1,p<=1?h.textContent="Add User":h.textContent="Add "+p+" Users"}var g,h,i,j,k,l,m,n,o,p=0,q=document.createDocumentFragment();$(q).append(JST["app/templates/user_assigner/instructor_assigner.us"]({custom_categories:c})),g=q.querySelector("select"),h=q.querySelector("#js-add-people"),m=q.querySelector("#js-cancel"),i=q.querySelector("#js-email-users"),k=q.querySelector("#js-new-accounts-count"),n=q.querySelector("#js-permission-editor"),k.setAttribute("style","font-size: 11px;"),i.addEventListener("change",function(){var a;a=p.instructors+p.roinstructors,e(a)}),m.onclick=function(){window.location.href="#courseinstructors-"+a.id},j={placeholder:"Names or emails",tokenSeparators:[";","; ","\t","\n"],attribute:"multiple",selectedLabels:!0,types:["users","teams","bosses","job_titles"],tags:!0,no_scope:!0},new Picker(g,j,function(a,b){h.disabled=!0,h.textContent="Please Wait";var c=JSON.parse(JSON.stringify(a));c.user_emails=b,GT.User.query(c,function(a){var c=a.map(function(a){return a.email});b=b.filter(function(a){return c.indexOf(a)===-1}),p=b.length,l=a.map(function(a){return a.id}).concat(b),f()})}),o=new CoursePermissionEditor((void 0),c,n),h.onclick=function(){var c,d,e;h.disabled=!0,h.textContent="Please Wait",c={only_staff:o.staffOnly(),categories:[]},c.only_staff||(c.categories=o.categoryPermissions()),e=i.firstElementChild.checked,d={notify:e,course_id:a.id,permissions:c},o.editPermission()?d.instructors=l:d.read_only_instructors=l,GT.Course.addUsers(a.id,d,function(){},function(c){b&&b(c),window.location.hash="#courseinstructors-"+a.id})},d.div.appendChild(q)}var d=this;window.account.organization_id?(d.div=document.createElement("div"),GT.Filters.customCategories(function(a){c(a)})):GT.Notification.showError("This is a demo account, Please contact us at sales@tryskillo.com to deploy Skillo at your organization.")}function InstructorsRoster(a,b){"use strict";function c(b,c){var e,g,h=document.createDocumentFragment(),i=[];c.custom_categories.forEach(function(a){var b=account.organization.custom_category_types.find(function(b){return b.id===a.custom_category_type_id});b.hides_learners&&i.push(a)});var j={course:b,owner:c,orgStaffOnly:"staff"===account.organization.permission_scheme,orgFlat:"flat"===account.organization.permission_scheme,ownerIsAdmin:"InstructionalAdmin"===account.user_type,ownerIsMe:c.id===account.id,ownerScope:i,hasCategories:account.organization.custom_category_types.length>0};return $(h).append(JST["app/templates/roster_view/instructor-roster.us"](j)),e=h.querySelector("#instructor-list"),f=h.querySelector("#roster-header"),g=h.querySelector("#js-instructor-adder"),g.onclick=function(){!account.organization.user_limit||account.organization.user_count<account.organization.user_limit?window.location.href="#addinstructors-"+a:GT.Notification.showError("Your organization has reached its user limit ("+account.organization.user_limit+" users). Please contact support@tryskillo.com to increase your user limt.")},GT.Course.instructors(a,function(a){d(e,a,b)}),h.querySelector("main")}function d(a,b){var c;if($(a).empty(),b&&0!==b.length)for(c=0;c<b.length;c++)e(a,b[c])}function e(a,b){var c;if(b.user){c=document.createDocumentFragment(),"Instructor"===b.role&&(b.instructor_user_course_role="Can edit"),"ReadOnlyInstructor"===b.role&&(b.instructor_user_course_role="Can observe only"),b.hasCategories=account.organization.custom_category_types.length>0,b.userIsMe=account.id===b.user.id,$(c).append(JST["app/templates/roster_view/instructor-item.us"](b));var d=c.querySelector(".instructor");c.querySelector(".remove button").onclick=function(a,b){return function(){GT.UserCourse.dropUser(a.id,function(a){a.success?$(b).remove():GT.Notification.showError(a.error)})}}(b,d),c.querySelector(".edit button").onclick=function(a){return function(){window.location.hash="#editinstructor-"+b.id}}(b),a.appendChild(d)}}var f;GT.Course.get(a,void 0,function(d){GT.Course.creator(a,function(a){b(c(d,a))})},void 0,!1)}function InstructView(a,b,c){"use strict";function d(){var d=$("#course-list");$(d).addClass(a),$(m).empty(),c=c?decodeURIComponent(c):"",$("#course-search")[0].value=c,r.currentOffset=0,r.firstPageLoad=!0,p=!1,j(a,c,b,r.currentOffset,n,q)}function e(b,c){var e;switch(b){case"mine":e=0;break;case"star":e=1;break;case"archived":e=2;break;case"reports":e=3;break;case"admin":e=4;break;default:e=0}return c.onchange=function(b){switch(b.target.value){case"Mine":a="mine";break;case"Starred":a="star";break;case"Archived":a="archived";break;case"Reports":a="reports";break;case"All":a="admin";break;default:a="mine"}$("#course-list").removeClass(r.mode),r.mode=a,d()},e}function f(a,c){var e;switch(a){case"time":e=0;break;case"title":e=1;break;default:e=0}return c.onchange=function(a){switch(a.target.value){case"Recent":b="time";break;case"A to Z":b="title";break;default:b="time"}r.sort=b,d()},e}function g(a){l.changeHash(1,a)}function h(){var d=Math.round($(window).scrollTop()+$(window).height());d>=r.getDocHeight()&&o&&!p&&(o=!1,setTimeout(function(){o=!0},400),j(a,c,b,r.currentOffset,n,0))}function i(){var d=r.drawCourseList(e,f,g,c);m=d.querySelector(".js-course-list"),j(a,c,b,r.currentOffset,n,q),l.div.appendChild(d)}function j(a,b,c,d,e,f){GT.Course.lazyInstructs(void 0,a,b,c,d,e,f,function(a){var b=k(a.courses,a.dates.tiles,a.dates.topics),c=a.star_array;r.appendInstructCourseList(b,c,m,n),r.currentOffset+=b.length,o=!0},m)}function k(a,b,c){function d(a){return a.id==g}for(var e,f,g=-1,h=-1,i=0;i<a.length;i++)g=a[i].id,h=b.findIndex(d),e=b[h]?b[h].max_date:null,f=c[h]?c[h].max_date:null,a[i].updated_at<e&&f<e?a[i].updated_at=e:a[i].updated_at<f&&e<f&&(a[i].updated_at=f);return a}GTView.call(this);var l=this;c&&(c=decodeURIComponent(c)),this.div.className="instruct-view",this.bodyClass="instruct-course-view";var m,n=40,o=!0,p=!1,q=3e3;this.setOutOfCourses=function(a){p=a};var r=new CoursesCommon("instruct",a,b,account.course_which_display);r.heldView=this,this.hash="#instruct";var s=!1;if("mine"!==a&&"star"!==a&&"reports"!==a&&"admin"!==a&&(account.instruct_mode?(a=account.instruct_mode,"mine"!==a&&"star"!==a&&"reports"!==a&&"admin"!==a&&(s=!0,a="mine")):a="mine"),"admin"==a&&"User"==account.user_type&&(s=!0),"title"!==b&&"time"!==b&&(account.instructor_which_sort?(b=account.instructor_which_sort,"title"!==b&&"time"!==b&&(b="time")):b="time",s=!0),s){var t={id:account.id,instructor_which_sort:b,mode:a,course_which_display:account.course_which_display};GT.User.update(t,function(){})}r.mode=a,r.sort=b,this.handleArgChange=function(a){var b=!1;return a&&decodeURIComponent(a)!==c&&(c=decodeURIComponent(a),b=!0),"undefined"==typeof a&&(c="",b=!0),b&&d(),b},this.createMarkup=function(){sideBar.fillMainSideBar(),GTView.unsetRoles(),i()},window.addEventListener("scroll",h),this.destroy=function(){window.removeEventListener("scroll",h),account.instructor_which_sort=b,account.instruct_mode=a}}function LearnView(a,b,c){"use strict";function d(){var d=$("#course-list");$(d).addClass(a),$(l).empty(),c=c?decodeURIComponent(c):"",$("#course-search")[0].value=c,q.currentOffset=0,q.firstPageLoad=!0,o=!1,j(a,c,b,q.currentOffset,m,p)}function e(b,c){var e;switch(b){case"todo":e=0;break;case"star":e=1;break;case"done":e=2;break;case"all":e=3;break;case"archived":e=4;break;default:e=0}return c.onchange=function(b){switch(b.target.value){case"To Do":a="todo";break;case"Starred":a="star";break;case"Done":a="done";break;case"All":a="all";break;case"Archived":a="archived";break;default:a="all"}$("#course-list").removeClass(q.mode),q.mode=a,d()},e}function f(a,c){var e;switch(a){case"time":e=0;break;case"title":e=1;break;default:e=0}return c.onchange=function(a){switch(c.selectedIndex){case 0:b="time";break;case 1:b="title";break;default:b="time"}q.sort=b,d()},e}function g(a){k.changeHash(1,a)}function h(){var d=Math.round($(window).scrollTop()+$(window).height());d>=q.getDocHeight()&&n&&!o&&(n=!1,setTimeout(function(){n=!0},400),j(a,c,b,q.currentOffset,m,0))}function i(){var d=q.drawCourseList(e,f,g,c);l=d.querySelector(".js-course-list"),j(a,c,b,q.currentOffset,m,p),k.div.appendChild(d)}function j(a,b,c,d,e,f){GT.Course.lazyLearn(null,a,b,c,d,e,f,function(a){var b=a.courses,c=a.star_array;q.appendLearnCourseList(b,c,l,m),q.currentOffset+=b.length,n=!0},l)}GTView.call(this);var k=this;c&&(c=decodeURIComponent(c)),this.div.className="learn-view",this.bodyClass="learn-course-view";var l,m=40,n=!0,o=!1;this.setOutOfCourses=function(a){o=a};var p=3e3,q=new CoursesCommon("learn",a,b);q.heldView=this,this.hash="#learn";var r=!1;if("todo"!==a&&"star"!==a&&"done"!==a&&"all"!==a&&(account.learn_mode?(a=account.learn_mode,"todo"!==a&&"star"!==a&&"done"!==a&&"all"!==a&&(a="todo")):a="todo",r=!0),"title"!==b&&"time"!==b&&(account.learn_which_sort?(b=account.learn_which_sort,"title"!==b&&"time"!==b&&(b="time")):b="time",r=!0),r){var s={id:account.id,learn_which_sort:b,mode:a};GT.User.update(s,function(){})}q.mode=a,q.sort=b,this.handleArgChange=function(a){var b=!1;return null!=a&&decodeURIComponent(a!=c)&&(c=decodeURIComponent(a),b=!0),"undefined"==typeof a&&(c="",b=!0),b&&d(),b},this.createMarkup=function(){sideBar.fillMainSideBar(),GTView.unsetRoles(),i()},window.addEventListener("scroll",h),this.destroy=function(){window.removeEventListener("scroll",h),account.learn_which_sort=b,account.learn_mode=a}}function LightBox(a){"use strict";function b(){var a=document.createElement("button");return $(a).attr("aria-label","Close"),a.className="close-button",a}var c=this;this.id=null,this.closeButton=!1,this.closeCallback=function(){c.close()},this.hasShadow=!0,this.customClass="",this.shade=null,this.closeable=!1,this.returnBlur=!0,this.currentGuts=void 0;var d;if("object"==typeof a)for(var e in a)a.hasOwnProperty(e)&&(this[e]=a[e]);this.inputFocus=function(){$(this.shadow).click(function(a){c.closeable&&(c.close(),a.stopPropagation())}),$(this.lightBox).click(function(a){a.stopPropagation()})},this.open=function(a,e){GT.openLightboxes.push(this);var f;$("#stage").attr("aria-hidden","true"),$("#side-bar").attr("aria-hidden","true"),$("#stage").attr("tabindex","-1"),$("#side-bar").attr("tabindex","-1"),this.shadow=document.createElement("div"),this.hasShadow?"dark"===this.shade?this.shadow.className="lightbox-shadow lightbox-container":this.shadow.className="lightbox-white lightbox-container":this.shadow.className="lightbox-container",this.lightBox=document.createElement("div"),this.customClass?this.lightBox.className=this.customClass:this.hasShadow?this.lightBox.className="popup":this.lightBox.className="popup-no-shadow",this.lightBox.id=this.id,this.closeButton===!0&&(f=b(),f.onclick=function(){c.closeCallback&&c.closeCallback(),c.close()},this.lightBox.appendChild(f)),this.id&&(this.lightBox.id=this.id),(a.getAttribute||a.firstElementChild.getAttribute)&&(d=a.getAttribute?a.getAttribute("data-outer-class"):a.firstElementChild.getAttribute("data-outer-class"),d&&$(this.lightBox).addClass(d)),this.lightBox.appendChild(a),this.currentGuts=a,this.shadow.appendChild(this.lightBox),$(this.shadow).css({opacity:0}),document.body.appendChild(this.shadow),$(this.shadow).transition({opacity:1},function(){e&&e()}),this.inputFocus()},this.prompt=function(a,b,d,e){var f,g;f=document.createElement("div"),f.id="prompt";var h=document.createElement("p");h.id="prompt-message",h.appendChild(document.createTextNode(a)),f.appendChild(h);for(var i in b){var j=document.createElement("button");b[i].id&&(j.id=b[i].id),b[i].className&&(j.className=b[i].className),j.appendChild(document.createTextNode(b[i].text)),j.onclick=function(a){return function(){d||c.close(),b[a].callback&&b[a].callback()}}(i),f.appendChild(j)}d?(g=this.currentGuts.getAttribute("data-outer-class"),f.setAttribute("data-outer-class",g),f.classList.add("contents"),this.change(f,e)):this.open(f,e)},this.close=function(a){$("#stage").attr("aria-hidden","false"),$("#side-bar").attr("aria-hidden","false"),$("#stage").attr("tabindex",""),$("#side-bar").attr("tabindex",""),$(this.shadow).transition({opacity:0},function(){var b;$(this).remove(),b=GT.openLightboxes.indexOf(this),GT.openLightboxes.splice(b,1),a&&a()})},this.change=function(a,b){this.lightBox?$(this.currentGuts).fadeOut(150,function(){$(c.lightBox).removeClass(d),d=a.getAttribute("data-outer-class"),d&&$(c.lightBox).addClass(d),$(a).hide(),$(c.currentGuts).replaceWith(a),c.currentGuts=a,setTimeout(function(){$(c.currentGuts).fadeIn(150,function(){b&&b()})},200)}):this.open(a)}}function ListsView(){"use strict";function a(a){var b,c;return c=new DateCalculator,a.updated_at=c.formatDateTime(a.updated_at),a.team_member_count||(a.team_member_count=0),b=document.createDocumentFragment(),$(b).append(JST["app/templates/people_view/user-lists-item.us"](a)),b}GTView.call(this);var b=this;this.div.id="lists-view",this.bodyClass="lists-view",this.createMarkup=function(){sideBar.fillMainSideBar(),b.div.appendChild(b.getElement())},this.getElement=function(){function b(b){var c=f.value||null,e="admin"==h?null:account.id;$(i).toggleClass("hidden"),GT.List.all(c,e,k,l,function(c){var e;for(b&&$(d).empty(),c.length<l&&(j=!0),e=0;e<c.length;e++)d.appendChild(a(c[e]));k+=c.length}),$(i).toggleClass("hidden")}var c,d,e,f,g,h,i,j,k=0,l=40,m=[];switch(h=account.which_list?account.which_list:"instruct",c=document.createDocumentFragment(),$(c).append(JST["app/templates/people_view/user-lists.us"]()),d=c.querySelector("#js-user-lists"),e=c.querySelector("#js-create-list"),f=c.querySelector("#js-find-list-input"),g=c.querySelector("#js-which-lists"),i=c.querySelector("#js-lazy-load"),account.which_list){case"instruct":g.selectedIndex=0;break;case"admin":g.selectedIndex=1;break;default:g.selectedIndex=0}return g.onchange=function(a){switch(a.target.value){case"Mine":h="instruct";break;case"All":h="admin";break;default:h="instruct"}account.which_list=h,GT.User.update(account,function(a){}),k=0,b(!0)},f.onchange=function(){k=0,b(!0)},this.onScrollBottom=function(){j||b(!1)},e.onclick=function(){var b,c,e,f,g,h,i,j,k,l,n=!0;c=document.createDocumentFragment(),b=new LightBox({closable:!0,closeButton:!0}),$(c).append(JST["app/templates/people_view/create-list.us"]()),e=c.querySelector(".lightbox-done"),f=c.querySelector("#js-list-select"),g=c.querySelector("#js-list-name"),l=c.querySelector("#button-spinner"),k=".js-error-printout",j={placeholder:"Search",tokenSeparators:[";","; ","\t","\n"],attribute:"multiple",tags:!0},g.onchange=function(){GT.List.exists(g.value,function(a){n=1!=a.response})},new Picker(f,j,function(a,b){GT.User.query(a,function(a){m.pop(),h=a,m.length<=0&&($(e).prop("disabled",!1),$(l).addClass("hidden"))}),m.push(0),i=b,$(e).prop("disabled",!0),$(l).removeClass("hidden")}),e.onclick=function(){var c={by_id:h,by_email:i};n?GT.List.create(g.value,c,function(e){var f;e.creator={full_name:account.first_name+" "+account.last_name},c.by_email&&c.by_id?e.team_member_count=c.by_email.length+c.by_id.length:e.team_member_count=0,e.success?(f=a(e),d.appendChild(f),b.close()):GT.Notification.showErrorList(e.errors)}):GT.Notification.warning("This list name is taken",3e3,k)},b.open(c)},b(),c}}function ListView(a){"use strict";function b(a,b){a.contentEditable=!0,$(a).on("keydown",function(a){if(13===a.which)return $(a.target).blur(),!1}),$(a).blur(function(c){b($(a).text())})}function c(a,b,c){$(a).empty(),d(a,b,c)}function d(a,b,c){var d,f,g,h;for(g=function(a,c){return function(){GT.List.removeUser(e,b[a].id,function(){$(c.parentElement).remove()})}},f=0;f<b.length;f++)d=document.createDocumentFragment(),$(d).append(JST["app/templates/people_view/user-list-person.us"](b[f])),h=d.querySelector("#js-remove-user"),c?$(h).remove():h.onclick=g(f,h),a.appendChild(d)}GTView.call(this);var e,f=this;e=parseInt(a),this.createMarkup=function(){sideBar.fillMainSideBar(),f.div.appendChild(f.getElement())},this.getElement=function(){var a,d,f,g,h,i,j,k,l=[];return a=document.createDocumentFragment(),$(a).append(JST["app/templates/people_view/user-list.us"]()),f=a.querySelector("#js-user-adder"),h=a.querySelector("#js-delete-list-button"),i=a.querySelector("#js-delete-list-section"),d=a.querySelector("#roster-list"),g=a.querySelector("#js-list-title"),j=a.querySelector("#roster-header.title"),k=a.querySelector("#js-edit-list-title"),k.onclick=function(){$(g).focus(),document.execCommand("selectAll",!1,null)},h.onclick=function(){GT.List.destroy(e,function(){window.location.hash="#lists"})},f.onclick=function(){var a,b,c,d,f,g,h,i;b=document.createDocumentFragment(),a=new LightBox({closable:!0,closeButton:!0}),$(b).append(JST["app/templates/people_view/add_users.us"]()),c=b.querySelector(".lightbox-done"),d=b.querySelector("#js-list-select"),i=b.querySelector("#button-spinner"),h={placeholder:"Search",tokenSeparators:[";","; ","\t","\n"],attribute:"multiple",tags:!0},new Picker(d,h,function(a,b){GT.User.query(a,function(a){f=a,l.pop(),l.length<=0&&($(c).prop("disabled",!1),$(i).addClass("hidden"))}),l.push(0),g=b,$(c).prop("disabled",!0),$(i).removeClass("hidden")}),c.onclick=function(){var b={by_id:f,by_email:g};GT.List.addUsers(e,b,function(b){b.success?(a.close(),window.location.reload()):(a.close(),"duplicate"===b.error?window.location.reload():GT.Notification.showErrorList(b.errors))})},a.open(b.firstChild)},GT.List.get(e,function(a){var e;if(g.textContent=a.title,j.textContent=a.title,e=null!==a.external_id)$(i).addClass("hidden"),$(f).addClass("hidden"),$(k).addClass("hidden"),$(j).attr("readonly",!0),$(g).attr("readonly",!0);else{var h=function(b){return b&&b.trim().length?void GT.List.updateTitle(a.id,b,function(c){c.success?(a.title=b,j.textContent=b):GT.Notification.showError("<strong>Title Change Failed!</strong><br />"+c.errors[0],2500)}):void(j.textContent=a.title)};b(g,h)}c(d,a.users,e)}),a}}function LiveTrainingEditor(a){"use strict";function b(a){$(d.contentContainer).empty(),$(d.contentContainer).append(a)}function c(){var b,c;return b=document.createDocumentFragment(),$(b).append(JST["app/templates/tile_view/edit_live_training.us"](a)),c=b.querySelector("#event-details"),c.onchange=function(){a.message=c.value;var b={id:a.id,message:c.value};GT.Tile.update(b,function(a){a.success?GT.Notification.show("Tile Data Saved."):GT.Notification.showErrors(a.errors)})},b.querySelector("div")}var d=this;this.contentContainer=document.createElement("div"),this.contentContainer.className="training-content-container",b(c())}function Loader(a,b,c){"use strict";var d,e,f,g,h;h=function(){d=void 0,$("#stage").attr("aria-hidden","true"),$("#side-bar").attr("aria-hidden","true"),$("#stage").attr("tabindex","-1"),$("#side-bar").attr("tabindex","-1");var a=document.createDocumentFragment();$(a).append(JST["app/templates/loader/loader.us"]({message:b})),f=a.querySelector("#js-loader-container"),e=a.querySelector("#js-loader-container .box"),g=a.querySelector("#js-spinner"),c?c.appendChild(f):document.body.appendChild(f)},d=setTimeout(h,a),this.stop=function(){clearTimeout(d),$(f).fadeOut(function(){$(this).remove(),$("#stage").attr("aria-hidden","false"),$("#side-bar").attr("aria-hidden","false"),$("#stage").attr("tabindex",""),$("#side-bar").attr("tabindex","")})},this.showError=function(a,b){var c;d&&(clearTimeout(d),d=void 0,h());var f={specificerror:"code: "+b+" "+a};c=JST["app/templates/loader/loader-"+b+".us"]?JST["app/templates/loader/loader-"+b+".us"]:JST["app/templates/loader/loader-error.us"],$(g).remove(),$(e).append(c(f))}}function LoginView(){"use strict";function a(){j.disabled=!0,n.disabled=!0,m.disabled=!0,l.disabled=!0}function b(){w.checkLogin(m.value,l.value,q,function(){})}function c(){n.disabled=!1,v.className="forgot password"}function d(a){u.textContent="Password Sent!",s.textContent="Since this is your first login, we sent a link to your email address just now. Use it to create a password, then enter it here.",GT.User.forgotPassword(m.value,a,function(a){a.success||GT.Notification.showError("unable to send email")}),z="password",v.className="password",l.focus()}function e(a){var b,c;for(b=0;b<a.length;b++)a[b].organization.id===Number(t.value)&&(c=a[b]);c.activated?(q=c.organization.id,u.textContent=m.value,s.textContent="",z="password",v.className="password",l.focus()):d(c.organization.id)}function f(){$(t).empty().append("<option>--</option>"),m.value&&GT.User.activated(m.value,function(a){var b,c;if(a.length<2)!a[0]||a[0].activated?(u.textContent=m.value,s.textContent="",z="password",v.className="password",l.focus()):d(a[0].organization.id);else{for(b=0;b<a.length;b++)c=document.createElement("option"),c.textContent=a[b].organization.name,c.value=a[b].organization.id,t.appendChild(c);t.onchange=function(){e(a)},z="select",v.className="organization"}})}function g(){h(m.value)}function h(a){n.disabled=!0,GT.User.forgotPassword(a,q,function(b){b.success?(v.className="password",z="password",u.textContent="Password Sent!",s.textContent="We just sent a password reset link to "+a+". Click the link to change your password, then log in with the new one."):GT.Notification.showError(b.error)})}function i(){v.className="password"}GTView.call(this);var j,k,l,m,n,o,p,q,r,s,t,u,v,w=this;this.bodyClass="login-view";var x,y,z="username";this.handleReset=function(a){GT.User.checkResetToken(a,function(b){if(b.success){var c,d={user:{}};document.querySelector("body").classList.add("login-view"),c=document.createDocumentFragment(),$(c).append(JST["app/templates/login/reset-pass.us"]()),x=c.querySelectorAll("#password-change input"),y=c.querySelector("#change-password"),y.onclick=function(){x[0].value&&x[1].value&&x[0].value===x[1].value?(d.user[x[0].name]=x[0].value,d.user[x[1].name]=x[1].value,d.user.token=a,GT.User.tokenPassReset(d,function(a){a.success&&(GT.Notification.show("Please login with your new password"),w.div.remove(),window.location.hash="")})):x[0].value&&x[1].value&&x[0].value!==x[1].value?GT.Notification.show("Passwords do not match."):GT.Notification.show("Please provide a password in the indicated fields.")},w.stage=document.getElementById("stage"),w.div.appendChild(c),w.stage.appendChild(w.div)}else GT.Notification.show(b.error),window.location.hash=""})},this.createMarkup=function(){var a;a=document.createDocumentFragment(),$(a).append(JST["app/templates/login/login.us"]({normalFlow:!0})),j=a.querySelector("#login-button"),k=a.querySelector("#js-next-button"),l=a.querySelector("#password-field"),m=a.querySelector("#username-field"),t=a.querySelector("#js-org-select"),n=a.querySelector("#forgot-password-link"),r=a.querySelector("#go-back-link"),o=a.querySelector("#confirm-forgot-password-link"),p=a.querySelector("#login-link"),v=a.querySelector("#viewport"),s=a.querySelector("#js-message"),u=a.querySelector("#js-message-heading"),this.div.appendChild(a),$(j).attr("aria-label","login"),j.onclick=b,k.onclick=f,o.onclick=c,r.onclick=function(){v.className=""},$(this.div).on("keyup",function(a){13!==a.which&&9!==a.which||("password"===z?b():f())}),n.onclick=g,p.onclick=i},this.viewDidLoad=function(){"#signup"===location.hash||GT.courseParam?new AccountCreator(function(b){b.doesEmailExist?(document.getElementById("username-field").value=b.email,GT.Notification.warning("This account already exists! Try logging in here instead.",!1,"#existing-email-warning"),document.getElementById("password-field").focus(),document.getElementById("password-field").select()):(a(),w.checkLogin(b.email,b.password,b.organization_id))}):"#register"===location.hash&&new OrganizationCreator(function(a){w.checkLogin(a.email,a.password,a.organization_id)})}}function image_path(a){return"/dist/"+a}function Comment(){}function Model(){}function OrganizationCreator(a){"use strict";function b(){var b={},d=document.createDocumentFragment();$(d).append(JST["app/templates/organization_creator/signup-org-info.us"]());var e=d.querySelector("#free-trial-creator"),f=d.querySelector("form"),g=d.querySelector("#js-create-account");g.onclick=function(d){d.preventDefault(),this.disabled=!0;for(var e=$(f).serializeArray(),h=0;h<e.length;h++)b[e[h].name]=e[h].value;b.course_uuid=GT.courseParam,GT.Organization.redeem(b,function(d){d.success?(b.organization_id=d.organization_id,b.id=d.id,b.type="User",c.close(a(b))):(GT.Notification.showErrorList(d.errors,4e3),g.disabled=!1)})};for(var h=d.querySelectorAll("input"),i=0;i<h.length;i++)h[i].onclick=function(){g.disabled=!1};return e}var c=new LightBox({id:"signup-popup",hasShadow:!1,customClass:"popup",closeButton:!1});c.open(b())}function Picker(a,b,c){"use strict";function d(a){var b,c;switch(a){case"users":return"Users";case"teams":return"Lists";case"courses":return"Courses";case"job_titles":return"Title Is:";case"bosses":return"People that directly report to...";case"all_bosses":return"All People that report to...";default:if(b=a.split("-"),"custom_category"!==b[0])return"";for(c=0;c<m.length;c++)if(m[c].id===Number(b[1]))return m[c].title}}function e(a,c){var d;return d=a.deleted_at?"(Deleted) - "+a.email:a.full_name?a.full_name+" - "+a.email:a.first_name?a.first_name+" "+a.last_name+" - "+a.email:a.email?a.email:a.title?a.title:a.name?a.name:"Unlabeled Result",b.selectedLabels===!0&&("teams"===c&&(d="All members of list: "+d),"job_titles"===c&&(d="Has Job Title: "+d),"courses"===c&&(d="Is enrolled in course: "+d),"bosses"===c&&(d="Directly report to: "+d),
"all_bosses"===c&&(d="All who report to: "+d)),"custom_category"===c?{text:d,id:c+"-"+a.custom_category_type_id+"-"+a.id}:{text:d,id:c+"-"+a.id}}function f(){var d,e,f,g,h=/(users|teams|courses|job_titles|bosses|all_bosses|custom_category)-\d+/,i=function(a){return h.test(a)?a.split("-"):[a]},j=[];if(g={},d=$(a).val(),b.forceSingle&&(d=[d]),d)for(e=0;e<d.length;e++)f=i(d[e]),1===f.length?j.push(f[0]):2===f.length?(g[f[0]]||(g[f[0]]=[]),g[f[0]].push(f[1])):(g[f[0]]||(g[f[0]]=[]),g[f[0]].push(f[2]));c&&c(g,j)}var g,h,i,j,k,l,m;this.selectElement=a,this.config=b,b.types||(b.types=[]),b.staticOptions||(b.staticOptions=[]),this.remove=function(){$(a).select2("destroy"),$(a).empty()},b.cssRule&&$(a).css(b.cssRule),"multiple"===b.attribute&&(g=document.createAttribute("multiple"),g.value="multiple",a.setAttributeNode(g)),GT.Filters.filterableCustomCategories(function(c){if(m=c,b.selected)for(h in b.selected)if(b.selected.hasOwnProperty(h)){for(l=document.createElement("optgroup"),l.label=d(h),j=0;j<b.selected[h].length;j++)b.selected[h][j]&&(i=e(b.selected[h][j],h),k=document.createElement("option"),k.textContent=i.text,k.value=i.id,k.selected=!0,l.appendChild(k));a.appendChild(l)}$(a).select2({debug:!0,tags:b.tags,tokenSeparators:b.tokenSeparators,searchElement:"textarea",minimumInputLength:1,multiple:"undefined"==typeof b.forceSingle||!b.forceSingle,val:[],ajax:{url:"select/suggestions",dataType:"json",data:function(a){return{query:a.term,page:a.page,types:b.types,custom_category_type_ids:b.customCategoryTypeIds,course_id:b.course_id,no_scope:b.no_scope}},processResults:function(a,c){var f,g,h,i=[];for(f in a)if(a.hasOwnProperty(f)){for(g={children:[]},b.hideTitles||(g.text=d(f)),h=0;h<a[f].length;h++)g.children.push(e(a[f][h],f));g.children.length>0&&(b.sort&&g.children.sort(function(a,b){return a.text>b.text?1:b.text>a.text?-1:0}),i.push(g))}return b.allowCreate&&(i[0]&&0!==i[0].children.filter(function(a){return a.text.toLowerCase()===c.term.toLowerCase()}).length||i.unshift({id:c.term,text:c.term})),b.staticOptions.length>0&&b.staticOptions.forEach(function(a){i.unshift({id:a.value,text:a.text})}),{results:i}}},style:"width: 100%;",placeholder:b.placeholder}),$(a).on("select2:select",f),$(a).on("select2:unselect",f)})}function PeopleView(a){"use strict";function b(){GT.User.lazyPeople(null,q,s,t,r.type,r.order,function(a){return s+=a.length,c(j,a),a.length<h&&(i=!0),canCall=!0,n.classList.add("hidden"),a})}function c(a,b){for(var c,e=0;e<b.length;e++)c=document.createDocumentFragment(),b[e]=d(b[e]),$(c).append(JST["app/templates/people_view/team-view-person.us"](b[e])),a.appendChild(c)}function d(a){var b=(new Date,a.overdue_count>0),c=a.todo_count>0;return a.todo=c,a.overdue=b,a}GTView.call(this);var e=this;this.bodyClass="people-view",this.div.id="people-view";var f,g,h,i,j,k,l,m,n,o,p="filterer";this.createMarkup=function(){sideBar.fillMainSideBar(),this.div.appendChild(e.getElement())},this.postMarkupAppend=function(){var a={placeholder:"Search",tokenSeparators:[","],attribute:"multiple",types:["users","teams","courses","bosses","all_bosses"],selected:{}};"InstructionalAdmin"===account.user_type&&new Picker(o,a,function(a){var b=$(".button-group-item");f=0,i=!1,g=a,$(j).empty(),m.hide(),p="search";for(var c=0;c<b.length;c++)b[c].previousElementSibling.checked=!1;e.searchBarLoad(a)})},this.onScrollBottom=function(){i||(n.classList.remove("hidden"),"search"==p?e.searchBarLoad(g):b())};var q,r,s=0,t=null;this.getElement=function(){function d(){s=0,i=!1,$(j).empty(),b()}function u(a){var c={};a.target===A[1]?(q="team",c.descendants=!0,m.hide()):a.target===A[2]?(q="filters",c.filters=!0,m.show()):(q="all",m.hide()),p="filterer",s=0,$(j).empty(),i=!1,canCall=!0,b()}function v(a){var b=Object.keys(a);b.forEach(function(b){var c=Object.keys(a[b]);c.forEach(function(c){if(a[b][c]>999){var d=a[b][c].toString();a[b][c]=d.substring(0,d.length-3)+"k"}})})}var w,x,y,z,A,B;return f=0,h=40,i=!1,k=null!=a?parseInt(a):account.id,w=document.createDocumentFragment(),$(w).append(JST["app/templates/people_view/my-team.us"]({admin:"InstructionalAdmin"===account.user_type})),z=w.querySelector("#js-student-filters"),x=w.querySelector("#question-button"),y=w.querySelector("#stats-help-button"),n=w.querySelector("#js-lazy-load"),A=w.querySelectorAll(".button-group-item"),o=w.querySelector("#search-bar-container"),B=w.querySelector("#people-headers"),r=new LazySorter("last_name","asc",B.children,function(){f=0,i=!1,s=0,$(j).empty(),i||(n.classList.remove("hidden"),"search"==p?e.searchBarLoad(g):b())}),A.forEach(function(a){a.onclick=function(a){u(a)}}),e.searchBarLoad=function(a){GT.User.lazyQuery(a,h,f,r.type,r.order,function(a){f+=a.length,a.length<h&&(i=!0),n.classList.add("hidden"),c(j,a)})},m=new Filterer(z,d),m.context="User",m.contextId=account.id,t=h,m.fetchFilters(function(a){a?$(A[2]).click():$(A[0]).click()}),0===A.length&&(m.mode="team",p="filterer",b()),j=w.querySelector("#roster-list"),l=w.querySelector("#js-stats"),GT.Organization.getOrganizationData(account.organization_id,function(a){v(a),$(l).append(Handlebars.partials.organization_data(a))}),x.onclick=function(){var a,b;b=document.createDocumentFragment(),a=new LightBox({closable:!0,closeButton:!0}),$(b).append(JST["app/templates/people_view/team-screen-explanation.us"]()),a.open(b.firstChild)},y.onclick=function(){var a,b;b=document.createDocumentFragment(),a=new LightBox({closable:!0,closeButton:!0}),$(b).append(JST["app/templates/people_view/monthly-stats-explanation.us"]()),a.open(b.firstChild)},w}}function PersonView(a,b){"use strict";function c(a){GT.User.get(a,function(a){var b,c,e,f;b=document.createDocumentFragment(),h.pageType||(a.instructs_courses?(h.pageType="instruct",h.mode="mine"):(h.pageType="learn",h.mode="todo")),a.instruct="instruct"===h.pageType,$(b).append(JST["app/templates/person_view/person_view.us"](a)),c=g(a),e=b.querySelector("#js-which-courses"),f=b.querySelector("#js-course-search"),j=b.querySelector("#main-content-container"),i=c.querySelector("#js-courses"),f.onkeydown=function(a){if(13===a.which){for(n=0,h.searchTerm=a.target.value;i.firstChild;)i.removeChild(i.firstChild);d(i)}},e.onchange=function(b){for(n=0,h.mode=b.target.value;j.firstChild;)j.removeChild(j.firstChild);var c=g(a);i=c.querySelector("#js-courses"),d(i),j.append(c)},sideBar.fillPersonSideBar(a,a.id,h.pageType),d(i),$(j).append(c),h.div.appendChild(b)})}function d(b){var c=3e3;"instruct"===h.pageType?GT.Course.lazyInstructs(a,h.mode,h.searchTerm,"title",n,m,c,function(a){a=a.courses,e(b,a)}):GT.Course.lazyLearn(a,h.mode,h.searchTerm,"title",n,m,c,function(a){a=a.courses,e(b,a)})}function e(a,b){var c;for(c=0;c<b.length;c++){var d=f(b[c]);"instruct"!=h.pageType&&d.querySelectorAll("a").forEach(function(a){var d=b[c].id;a.onclick=function(){Completion(d)}}),a.appendChild(d)}if(n+=b.length,b.length<m){if(0==n){var e=document.createDocumentFragment();$(e).append(JST["app/templates/course_view/no_courses_message.us"]()),a.appendChild(e)}l=!0}}function f(a){var b,c;if(b=document.createDocumentFragment(),a){var d=new DateCalculator;"instruct"===h.pageType?a.updated_at=d.formatDateTime(a.updated_at):a.course_date_data=d.courseDateData(a,a.viewed_at)}return a.color=k.colorSet(a.id),a.passed=1==a.marked_complete,a.done=100===a.completed_percentage||1==a.marked_complete||0===a.tiles_todo,"instruct"===h.pageType?$(b).append(JST["app/templates/course_view/instruct_course.us"](a)):(a.thumbnail=a.course.thumbnail,a.description=a.course.description,a.tags=a.course.tags,$(b).append(JST["app/templates/person_view/course.us"](a))),c=b.querySelector("#js-course-status"),a&&"learn"===h.pageType&&$(c).append(Handlebars.partials.course_status(a)),b}function g(a){var b={};if("instruct"===h.pageType)switch(h.mode){case"mine":b.mine_instruct=!0;break;case"star":b.star_instruct=!0;break;case"reports":b.reports_instruct=!0}else switch(h.mode){case"todo":b.todo_learn=!0;break;case"star":b.star_learn=!0;break;case"done":b.done_learn=!0;break;case"all":b.all_learn=!0}b.firstname=a.first_name;var c=document.createDocumentFragment();return $(c).append(JST["app/templates/person_view/person_view_header.us"](b)),c}GTView.call(this);var h=this;this.div.id="js-person-view",this.bodyClass="person-view";var i,j,k=new CoursesCommon(null,null,null),l=!1,m=40,n=0;this.pageType=b,this.mode,this.searchTerm=null,"instruct"===b?this.mode="mine":this.mode="todo",this.handleArgChange=function(b,d){var e=!1;if(b!=a&&(a=b,e=!0),d!=h.pageType){if("learn"!=d&&"instruct"!=d)return!1;"instruct"===d?h.mode="mine":h.mode="todo",h.pageType=d,e=!0}if(e){for(var f=document.getElementById("js-person-view");f.firstChild;)f.removeChild(f.firstChild);h.searchterm=null,n=0,l=!1,c(a)}return!0},this.onScrollBottom=function(){l||d(document.getElementById("js-courses"))},this.createMarkup=function(){c(a)}}function QuizEditor(a,b){"use strict";function c(a){$(i.contentContainer).empty(),$(i.contentContainer).append(a)}function d(){function b(a){a.stopPropagation(),a.preventDefault();for(var b=a.target;b&&"BUTTON"!==b.tagName;)b=b.parentElement;var c=b.value;for(t=0;t<j.length;t++)if(j[t].id.toString()===c){j.splice(t,1);break}GT.Quiz.deleteQuizQuestion(c,function(){$(b.parentElement).remove()})}function d(a){return function(){var b,d=a.getAttribute("data-question-id");for(t=0;t<j.length;t++)j[t].id===Number(d)&&(b=t);c(e(b))}}var f,g,h,i,k,l,m,n,o,p,q,r,s,t,u;for(u in j)"image"===j[u].question_type?j[u].displayText="(Picture Question)":"video"===j[u].question_type?j[u].displayText="(Video Question)":"audio"===j[u].question_type&&(j[u].displayText="(Audio Question)");if(f=document.createDocumentFragment(),$(f).append(JST["app/templates/quiz_editor/quiz_editor.us"]({questions:j,tile:a})),s=f.querySelector("#quiz-questions-list"),$(s).sortable({items:".question-item",tolerance:"pointer",stop:function(b,c){setTimeout(function(){GT.Quiz.sortQuestions({questions:$(s).sortable("toArray")},function(){GT.Quiz.getQuiz(void 0,a.id,void 0,function(a){j=a})})},200)}}),k=f.querySelector("#js-instant-feedback"),l=f.querySelector("#js-summary-feedback"),m=f.querySelector("#js-shuffle-answers"),n=f.querySelector("#js-shuffle-questions"),k.onchange=function(){var b={};b.instant_feedback=k.checked,b.id=a.id,a.instant_feedback=b.instant_feedback,GT.Tile.update(b,function(a){a.success||GT.Notification.showErrorList(a.errors)})},l.onchange=function(){var b={};b.summary_feedback=l.checked,b.id=a.id,a.summary_feedback=b.summary_feedback,GT.Tile.update(b,function(a){a.success||GT.Notification.showErrorList(a.errors)})},h=f.querySelector(".edit-quiz-input"),g=f.querySelector("#quiz-percentage-checkbox"),a.min_score?(g.checked=!0,h.value=a.min_score):(g.checked=!1,h.disabled=!0),m.onchange=function(){var b={};b.shuffle_answers=m.checked,b.id=a.id,GT.Tile.update(b,function(b){b.success?a.shuffle_answers=m.checked:GT.Notification.showErrorList(b.errors)})},n.onchange=function(){var b={};b.shuffle_questions=n.checked,b.id=a.id,GT.Tile.update(b,function(b){b.success?a.shuffle_questions=n.checked:GT.Notification.showErrorList(b.errors)})},g.onchange=function(){var b={};b.tileId=a.id,g.checked===!0?(h.disabled=!1,b.min_score=h.value,$(h).focus()):(b.min_score=null,h.value=null,h.disabled=!0,GT.Quiz.setMinQuizScore(b,function(b){b.success?a.min_score=null:GT.Notification.showErrors(b.errors)}))},h.onchange=function(b){if(!isNaN(Number(h.value))&&Number(h.value)<=100){var c={tileId:a.id,minScore:h.value};GT.Quiz.setMinQuizScore(c,function(b){b.success?a.min_score=c.minScore:GT.Notification.showErrors(b.errors)})}else GT.Notification.showError("Please Enter a numeric value between 0 and 100.")},o=f.querySelectorAll("li"),j.length>0)for(t=0;t<o.length;t++)o[t].onclick=d(o[t]);for(i=f.querySelectorAll(".delete-question"),t=0;t<i.length;t++)i[t].onclick=b;return p=f.querySelector(".new-question"),p.onclick=function(){GT.Quiz.newQuizQuestion({tile_id:a.id},function(a){j.push(a),c(e(j.length-1))})},q=f.querySelector("#attempts-checkbox"),r=f.querySelectorAll(".edit-quiz-input")[1],a.attempt_limit?(q.checked=!0,r.value=a.attempt_limit):(q.checked=!1,r.disabled=!0),q.onchange=function(){var b={};b.tileId=a.id,q.checked===!0?(r.disabled=!1,b.attempt_limit=r.value,$(r).focus()):(b.attempt_limit=null,r.value=null,r.disabled=!0,GT.Quiz.setAttemptLimit(b,function(b){b.success?a.attempt_limit=null:GT.Notification.showErrors(b.errors)}))},r.onchange=function(b){var c={};c.tileId=a.id,c.attempt_limit=r.value,GT.Quiz.setAttemptLimit(c,function(b){b.success?a.attempt_limit=c.attempt_limit:GT.Notification.showErrors(b.errors)})},f.querySelector("div")}function e(a){function b(a){a.stopPropagation(),a.preventDefault();for(var b=a.target;b&&"BUTTON"!==b.tagName;)b=b.parentElement;var c=b.value;for(u=0;u<j.length;u++)if(j[u].id.toString()===c){j.splice(u,1);break}GT.Quiz.deleteQuizQuestion(c,function(){$(b.parentElement).remove()}),window.location.reload()}function e(b){g(b.target,a)}function i(b){g(b.target.parentElement.previousElementSibling.firstChild,a)}var k,l,m,n,o,p,q,r,s,t,u,v;for(k=document.createDocumentFragment(),"image"===j[a].question_type?j[a].image=!0:"video"===j[a].question_type?j[a].video=!0:"audio"===j[a].question_type&&(j[a].audio=!0),v={question:j[a],firstAnswer:j[a].quiz_answers[0]},$(k).append(JST["app/templates/quiz_editor/question_editor.us"](v)),s=k.querySelector("#record"),t=k.querySelector("#add-image"),s.onclick=function(){var b=new LightBox({id:"record-or-upload",hasShadow:!0});b.closeButton=!0,b.prompt("Upload or Record?",[{text:"Record Video",className:"standard",callback:function(){GT.FPWrapper.recordVideo(function(b){j[a].url=b[0].url,j[a].question_type="video",j[a].image&&(j[a].image=!1),j[a].media=!0,GT.Quiz.saveQuizQuestion(j[a],function(a){$(".edit-quiz-media").empty(),$(".edit-quiz-media").append(Handlebars.partials.question_video({question:a,video:!0}))})})}},{text:"Record Audio",className:"standard",callback:function(){var c,d,e,f,g;g=document.createDocumentFragment(),c=new VideoRecorder("audio"),c.setType("audio"),c.captureInputs(),$(g).append(JST["app/templates/quiz_editor/recorder.us"]()),f=g.querySelector("#js-audio-indicator"),d=g.querySelector("#js-record"),e=g.querySelector("#js-preview-container"),c.config.audioScopeCanvas=f,e.appendChild(c.frag),d.onclick=function(){d.textContent="Stop",c.startRecording(),d.onclick=function(){c.stopRecording()}},c.config.videoReadyCallback=function(c,d){GT.FPWrapper.storeData(c,d,function(c){j[a].url=c.url,j[a].question_type="audio",j[a].media=!0,GT.Quiz.saveQuizQuestion(j[a],function(a){$(".edit-quiz-media").empty(),$(".edit-quiz-media").append(Handlebars.partials.question_video({question:a,audio:!0})),b.close()})})},b.open(g)}},{text:"Upload",className:"standard",callback:function(){GT.FPWrapper.openUploadPrompt(function(b){var c,d,e=!1,f=!1;j[a].url=b.url,c=GT.FPWrapper.determineType(b),"Video"===c?(d="video",e=!0):(d="audio",f=!0),j[a].question_type=d,j[a].image&&(j[a].image=!1),j[a].media=!0,GT.Quiz.saveQuizQuestion(j[a],function(a){$(".edit-quiz-media").empty(),$(".edit-quiz-media").append(Handlebars.partials.question_video({question:a,video:e,audio:f}))})},!1,void 0,["Video","Sound"])}}])},t.onclick=function(){var b={};GT.Tile.updateImagePolicy(function(c){b.security=c,GT.FPWrapper.uploadImage(b,function(b){j[a].url=b.url,j[a].question_type="image",j[a].video&&(j[a].video=!1),j[a].media=!0,GT.Quiz.saveQuizQuestion(j[a],function(a){$(".edit-quiz-media").empty(),$(".edit-quiz-media").append("<img src="+a.url+">")})})})},o=k.querySelector("tbody"),n=k.querySelector(".add-answer"),n.onclick=function(){var b={quiz_question_id:j[a].id};GT.Quiz.newQuizAnswer(b,function(b){var c,d;j[a].quiz_answers.push(b),d=j[a].quiz_answers.length-1,c=f(a,d),0===d&&$(o).empty(),o.appendChild(c),c.querySelector("input").focus()})},l=k.querySelector(".quiz-done-button"),l.onclick=function(){var b=!1;for(u=0;u<j[a].quiz_answers.length;u++)if(j[a].quiz_answers[u].correct){b=!0;break}b?c(d()):GT.Notification.showError("Please Set a Correct Answer.")},m=k.querySelector("#question-input"),m.onchange=function(b){var c={};j[a].question=b.target.value,c.question=j[a].question,c.id=j[a].id,GT.Quiz.saveQuizQuestion(c)},r=k.querySelectorAll("td button"),u=0;u<r.length;u++)r[u].onclick=function(b){return function(c){h(c.target,a,b)}}(u);var w=k.querySelectorAll(".delete-question");for(u=0;u<w.length;u++)w[u].onclick=b;for(p=k.querySelectorAll(".answer-input"),u=0;u<p.length;u++)p[u].onchange=e;for(q=k.querySelectorAll(".answer-correct"),u=0;u<q.length;u++)q[u].onchange=i;return k.querySelector("div")}function f(a,b){var c,d,e,f;return c=document.createDocumentFragment(),$(c).append(Handlebars.partials.quiz_answer(j[a].quiz_answers[b])),d=c.querySelector(".answer-input"),e=c.querySelector(".answer-correct"),f=c.querySelector("button"),f.onclick=function(c){h(c.target,a,b)},d.onchange=function(b){g(d,a)},e.onchange=function(b){g(d,a)},c.querySelector("tr")}function g(a,b){var c,d=a.getAttribute("data-answer-id"),e=a.value,f=a.parentElement.nextElementSibling.firstChild.checked,g={id:d,answer:e,correct:f};for(c=0;c<j[b].quiz_answers.length;c++)j[b].quiz_answers[c].id===Number(g.id)&&(j[b].quiz_answers[c].answer=e,j[b].quiz_answers[c].correct=f);GT.Quiz.saveQuizAnswer(g)}function h(a,b,c){for(var d=a;d&&"BUTTON"!==d.tagName;)d=d.parentElement;GT.Quiz.deleteQuizAnswer(j[b].quiz_answers[c].id,function(){j[b].quiz_answers.splice(c,1),$(d.parentElement.parentElement).remove()})}var i=this,j=[];this.contentContainer=document.createElement("div"),this.contentContainer.className="quiz-editor-container",GT.Quiz.attemptsInProgress(a.id,function(e){!a.hidden&&b||e.success?GT.Notification.info("Can't edit the assessment right now because it might cause weird results. See below:",!1,"#tile-content"):GT.Quiz.getQuiz(void 0,a.id,void 0,function(a){j=a,c(d())}),!a.hidden&&b&&GT.Notification.warning("Click 'Lock Tile' above to prevent students from starting the quiz while you're editing it. Unlock it when you're finished.",!1,"#tile-content"),e.success&&GT.Notification.warning("At least one student has a quiz attempt in progress. You must wait for them to finish or be idle for an hour.",!1,"#tile-content")})}function QuizPlayer(a,b,c){"use strict";function d(){var b,d;d=document.createDocumentFragment(),$(d).append(JST["app/templates/reader_view/quiz-startpage.us"]({tile:a,question_count:g.length})),b=d.querySelector("#js-start-button"),b.onclick=function(){c?GT.Quiz.beginAttempt(c,a.id,function(a){l=a.id,m=a.number,f(g[n])}):f(g[n])},h.appendChild(d)}function e(b){function d(b){var c;c=Math.round(b.correct.toFixed(1)/b.quiz_questions.length.toFixed()*100),a.summary_feedback&&(c>=a.min_score||a.attempts_limited)&&i.appendChild(e(b)),g[0].appendChild(document.createTextNode(" "+b.correct)),g[1].appendChild(document.createTextNode(" "+b.quiz_questions.length)),g[2].appendChild(document.createTextNode(" "+c+"%")),(a.attempts_limited||a.attempt_limit&&m>=a.attempt_limit)&&(g[2].appendChild(document.createElement("br")),g[2].appendChild(document.createTextNode("You have used all available quiz attempts.")),$(j).addClass("hidden")),g[3]&&c>=a.min_score&&g[3].classList.add("hidden")}function e(a){var b=document.createDocumentFragment();return $(b).append(JST["app/templates/reader_view/quiz-summary.us"](a)),b}var f,g,i,j;f=document.createDocumentFragment(),$(f).append(JST["app/templates/quiz_player/quiz.us"]({tile:a})),j=f.querySelector("#retake-button"),g=f.querySelectorAll("ul li"),i=f.querySelector("#js-coaching-report"),""===c?d(k):GT.Quiz.getResults(a.id,c,b,function(a){d(a)}),(a.attempts_limited||a.attempt_limit&&m>=a.attempt_limit)&&$(j).remove(),j&&(j.onclick=function(){window.location.reload()}),$(h).empty(),h.appendChild(f)}function f(b){function d(){var d,e,f,g=[];for(d=$(m).serializeArray(),e=m.querySelectorAll("input"),f=0;f<e.length;f++)e[f].disabled=!0;if(d[0]){if(d.length>1)for(f=0;f<d.length;f++)g.push(d[f].value);else g.push(d[0].value);return GT.Quiz.recordResponse(a.id,g,void 0,c,l,function(c){var d;if(c.success){$(j[0]).addClass("hidden"),$(j[2]).removeClass("hidden");var e=0;for(f=0;f<b.quiz_answers.length;f++)for(d=0;d<g.length;d++)b.quiz_answers[f].id===Number(g[d])&&(b.quiz_answers[f].correct&&e++,b.quiz_answers[f].quiz_responses=!0);var h;e===p.length&&e===g.length?(k.correct++,h="Correct!"):h="Incorrect!",a.instant_feedback?$(o).text(h):j[2].click()}else GT.Notification.showErrorList(c.errors.quiz_question),j[2].click()}),!0}for(f=0;f<e.length;f++)e[f].disabled=!1;return GT.Notification.show("Please provide a valid response"),!1}var i,j,m,o,p=[];if(void 0===c&&(c=""),i=document.createDocumentFragment(),n=g.indexOf(b),b){a.shuffle_answers&&GT.shuffleArray(b.quiz_answers),b[b.question_type]=!0,b.question=GT.urlify(b.question),b.quiz_answers.forEach(function(a){a.answer=GT.urlify(a.answer)}),$(i).append(JST["app/templates/quiz_player/quiz.us"](b)),m=i.querySelector("form"),j=i.querySelectorAll("button"),o=i.querySelector(".quiz-feedback");var q=i.querySelectorAll("input");if(p=b.quiz_answers.filter(function(a){return a.correct===!0}),p.length>1){i.querySelector("p").innerHTML+=" (select all that apply)";for(var r=0;r<q.length;r++)q[r].setAttribute("type","checkbox")}}b?(j[0].onclick=function(){var a;j[0].disabled=!0,a=d(),a||(j[0].disabled=!1)},j[2].onclick=function(){f(g[n+1])},$(h).empty(),h.appendChild(i)):e(!1)}var g,h,i,j,k,l,m,n=0;k={correct:0,quiz_questions:[],hasData:!1},j=document.createElement("div"),i=document.createDocumentFragment(),$(i).append(JST["app/templates/reader_view/quiz-container.us"]()),h=i.querySelector(".question-box"),j.appendChild(i),g=[],a.passed&&a.completed||a.attempts_limited?e(!0):GT.Quiz.unfinishedAttempt(c,a.id,function(b){l=b.id,m=b.number,GT.Quiz.getQuiz(b.id,a.id,c,function(b){g=b,a.shuffle_questions&&GT.shuffleArray(g),l?(GT.Notification.show("Resumed quiz where you left off"),f(g[n])):d(g[n]),k.quiz_questions=g,k.hasData=!0})}),this.getPlayer=function(){return j}}function QuizResultsViewer(a,b,c){"use strict";function d(c){function d(a){var c;if(a)for(c=0;c<a.quiz_questions.length;c++)a.quiz_questions[c].image="image"===a.quiz_questions[c].question_type,a.quiz_questions[c].video="video"===a.quiz_questions[c].question_type,a.quiz_questions[c].audio="audio"===a.quiz_questions[c].question_type,a.quiz_questions[c].multi_an="multiple"===a.quiz_questions[c].answer_type;else a={};a.user_course=b,$(f).empty(),$(f).append(JST["app/templates/reader_view/quiz-results-questions.us"](a))}if(!$(document.body).hasClass("learning-course")){var e={tileId:a.id,userCourseId:c,bestAttempt:!0};GT.User.resultData(e,function(a){d(a)})}}var e,f,g;g=document.createDocumentFragment(),$(g).append(JST["app/templates/reader_view/quiz-results.us"](b)),f=g.querySelector("#quiz-result-table"),e=g.querySelector(".reset-quiz"),d(b.id),e.onclick=function(){GT.Tile.resetScormOrQuiz(void 0,void 0,b.id,a.id,function(a){a.success?($(f).empty(),c&&c()):GT.Notification.showErrorList(a.errors)})},this.getFrag=function(){return g}}function ReaderView(a,b,c,d){"use strict";function e(){var a=document.querySelector("#video-recorder");if(a||(a=document.querySelector("#audio-recorder")),a||(a=document.querySelector("#js-preview-camera")),a){var b=a.srcObject;b&&b.getTracks().forEach(function(a){a.stop()})}}function f(){function a(){var a=document.querySelector("video");if(a){var b=a.srcObject;b&&b.getTracks().forEach(function(a){a.stop()})}}function b(){a(),l(1)&&(p++,B.changeHash(1,C[p].id))}function d(){var a;$(B.div).hasClass("sidebar-open")?(a=image_path("img/comment-left-33765f3711e85775ee5843b020268420.png"),$(".discussion img").attr("src",a)):(a=image_path("img/comment-right-63e986a180a0e9031b38bfd85c41620b.png"),$(".discussion img").attr("src",a)),B.div.classList.toggle("sidebar-open")}var e,f,g;h(),C[p].no_discussion||(t=new Discussion(c),t.setCourse(A)),c&&(A.user_role="Student"),GTView.unsetRoles(),GTView.setRoles(A.user_role),B.div.id="reader-view-container";var j=document.createDocumentFragment();$(j).append(JST["app/templates/reader_view/reader-view.us"]({topic:D,course:A,userCourseId:c,tile:D.ordered_tiles[p]})),w=j.querySelector("#readerview-content"),s=j.querySelector("#discussion"),v=j.querySelector("#next-item"),f=j.querySelector("#prev-item"),y=j.querySelector("#item-title"),g=j.querySelector("#back-button"),u=j.querySelector(".fa-download"),q=j.querySelector(".fa-print"),r=j.querySelector(".fa-comment"),z=j.querySelector(".simple-dropdown-menu"),e=j.querySelector(".fa-ellipsis-v"),e.onclick=function(){$(z).toggleClass("hidden")},account.no_print_and_download&&($(z.children[0]).addClass("hidden"),$(z.children[1]).addClass("hidden"),$(q).addClass("hidden"),$(u).addClass("hidden")),C[p].no_discussion?($(z.children[2]).addClass("hidden"),$(r).addClass("hidden")):(t.setTile(C[p]),s.appendChild(t.frag)),z.children[1].onclick=function(){q.parentElement.disabled||B.printTile()},z.children[0].onclick=function(){u.parentElement.disabled||(window.location="tiles/download?id="+C[p].id)},q.onclick=function(){q.parentElement.disabled||B.printTile()},u.onclick=function(){u.parentElement.disabled||(window.location="tiles/download?id="+C[p].id)},z.children[3].onclick=function(){b()},v.onclick=function(){b()},g.onclick=a,z.children[2].onclick=function(){d()},r.onclick=function(){d()},i(),k(),B.div.appendChild(j)}function g(a,b){C[a]&&(C[a].loaded?b(C[a]):GT.Tile.get(C[a].id,c,function(c){C[a]=c,C[a].loaded=!0,b(c)}))}function h(){var b;for(b=0;b<D.ordered_tiles.length;b++)if(D.ordered_tiles[b].id===parseInt(a,10)){p=b;break}}function i(){j(p)}function j(a){$(w).empty(),m(a,function(a){x=a,y.textContent=x.tile.title,"Assignment"===x.tile.type?a.getReader(function(a){w.appendChild(a)}):w.appendChild(a.getReader()),C[p].no_discussion?($(z.children[2]).addClass("hidden"),$(r).addClass("hidden"),document.body.classList.add("no-discussion")):(t||(t=new Discussion(c),t.setCourse(A)),t.setTile(C[p]),s.appendChild(t.frag),document.body.classList.remove("no-discussion"),$(z.children[2]).removeClass("hidden"),$(r).removeClass("hidden"),window.innerWidth>768&&B.div.classList.add("sidebar-open")),n(),o()})}function k(){l(1)?(v.disabled=!1,$(v).removeClass("hidden"),$(z.children[3]).removeClass("hidden")):(v.disabled=!0,$(v).addClass("hidden"),$(z.children[3]).addClass("hidden"))}function l(a){var b=C[parseInt(p,10)+a];return!!b}function m(a,b){g(a,function(a){var d=GT.Tile.wrapTile(a,c,A);b(d)})}function n(){"Document"===C[p].type||"Webclip"===C[p].type||"Image"===C[p].type?($(z.children[1]).removeClass("hidden"),$(q).removeClass("hidden"),q.parentElement.disabled=!1):($(z.children[1]).addClass("hidden"),$(q).addClass("hidden"),q.parentElement.disabled=!0),!C[p].no_print&&C[p].available||($(z.children[1]).addClass("hidden"),$(q).addClass("hidden"),q.parentElement.disabled=!0)}function o(){"Scormclip"===C[p].type||"Quiz"===C[p].type||"Webclip"===C[p].type||"Spark"===C[p].type||"Assignment"===C[p].type||"LiveTraining"===C[p].type?(u.parentElement.disabled=!0,$(u).addClass("hidden"),$(z.children[0]).addClass("hidden")):(u.parentElement.disabled=!1,$(u).removeClass("hidden"),$(z.children[0]).removeClass("hidden")),!C[p].no_download&&C[p].available||($(u).addClass("hidden"),$(z.children[0]).addClass("hidden"),u.parentElement.disabled=!0)}GTView.call(this);var p,q,r,s,t,u,v,w,x,y,z,A,B=this,C=[],D={};d||(d=1),this.hash="#reader-"+a+"-"+b+"-"+c+"-"+d,this.bodyClass="reader-view-container",this.createMarkup=function(){GT.Course.get(b,c,function(e){A=e,GT.User.getByUserCourse(c,b,A.user_role,function(e){e.valid&&e.user_course?window.location.hash="#reader-"+a+"-"+b+"-"+e.user_course.id+"-"+d:(e.valid||""==c)&&GT.Tile.tilesInTopicForTile(a,function(a){D=a,C=D.ordered_tiles,f()})})})},this.destroy=function(){e()},this.handleArgChange=function(b){if(b!==a){document.querySelector("video");for(var c=0;c<C.length;c++)if(C[c].id==b)return p=c,k(),j(p),!0}return!1},this.printTile=function(){var a="/tiles/get_pdf?id="+C[p].id;if(ie)window.open(a,"Print Preview","width=800, height=600",!1);else{var b=new LightBox({id:"print-preview",closeButton:!0,closeable:!0}),c=document.createDocumentFragment();$(c).append(JST["app/templates/reader_view/reader-view-print-preview.us"]({url:a}));var d=c.querySelector("#print-preview");b.open(d)}}}function ResultsViewer(a,b,c,d,e){"use strict";function f(){GT.Tile.stats(a.id,x,A,function(b){void 0===b.completion_rate&&(b.completion_rate=0),void 0===b.pass_rate&&(b.pass_rate=0),r[0].textContent=b.total_learners,r[1].textContent=Math.round(100*b.completion_rate),a.clickableStudent&&(r[2].textContent=Math.round(100*b.pass_rate))})}function g(b){var c,d;return d=document.createDocumentFragment(),b.tile_status_datum&&(b.scoreIsNull=null===b.tile_status_datum.score,b.passedIsNull=null===b.tile_status_datum.passed,b.tileFailed=b.tile_status_datum.passed===!1,b.hasScoreBool=!b.scoreIsNull),"Assignment"!==a.type&&"Spark"!==a.type||(b.needsGraded=b.scoreIsNull&&b.passedIsNull,"Assignment"==a.type&&(b.pass_or_fail=a.pass_fail,b.link_view=!0,b.tile_id=a.id)),"Scormclip"===a.type&&(b.completedScorm=b.tile_completed),a.clickableStudent&&(b.completionAndPassing=!0),b.tile_status_datum&&(b.tile_completed=b.tile_status_datum.completed),b.statusClass=GT.tileStatusClass(a,b.tile_status_datum),$(d).append(Handlebars.partials.results_list_item(b)),c=d.querySelector(".js-student-list-item"),b.ungraded&&c.querySelector(".name").classList.add("ungraded"),"Assignment"!==a.type&&(c.onclick=function(){p(b,c)}),c}function h(a){a.forEach(function(a){$(m).append(g(a))}),a&&a.length>0?$(t).addClass("hidden"):$(t).removeClass("hidden")}function i(a){var b;for(b=0;b<a.length;b++)a[b].tile_status_datum&&(a[b].tile_status_datum.completed&&(a[b].tile_completed=!0),a[b].tile_status_datum.passed&&(a[b].tile_passed=!0),(a[b].tile_status_datum.score||0===a[b].tile_status_datum.score)&&(a[b].tile_score=a[b].tile_status_datum.score))}var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=1,D=!1;a.clickableStudent="Scormclip"===a.type||"Assignment"===a.type||"Spark"===a.type||"Quiz"===a.type,a.attendanceType="LiveTraining"===a.type,a.hasCategories=account.organization.custom_category_types.length>0,a.staff_only=c,a.custom_categories=d,j=document.createDocumentFragment(),$(j).append(JST["app/templates/results_viewer/results_viewer.us"](a)),k=j.querySelector("#js-student-filters"),q=j.querySelector("#js-csv-button"),m=j.querySelector("#js-student-list"),n=j.querySelectorAll("#js-filter-buttons input"),r=j.querySelectorAll("#js-statistics .num"),t=j.querySelectorAll(".js-no-students"),u=j.querySelector("#roster-header"),z=j.querySelector("#js-lazy-load"),a.attendanceType&&(v=j.querySelector("#js-toggle-all-complete")),w=function(){var c={};c.courses=b.id,c.filters=!0,c.tile_id=a.id,x="filters",C=1,GT.User.rosterFilter({courseId:b.id,tileId:a.id},x,C,function(a){i(a),$(m).empty(),h(a),f()})},this.loadMore=function(){1===C&&(D=!1),C++,D||(z.classList.remove("hidden"),GT.User.rosterFilter({courseId:b.id,tileId:a.id,sortType:B.type,sortOrder:B.order},x,C,function(a){z.classList.add("hidden"),a.length>0?(i(a),h(a)):D=!0}))};var E={course:b.id,url:"users/single_student",append:!0,attachTo:e,selectListener:!0,forceSingle:!0,cssRule:{width:"100%"},placeholder:"Search learners",types:["users"],allowClear:!0};y=document.createElement("select"),e.appendChild(y),new Picker(y,E,function(c){n.forEach(function(a){a.checked=!1}),l.hide(),x="single_user",A=c.users[0],C=1,GT.User.rosterFilter({courseId:b.id,tileId:a.id,userId:A},x,C,function(a){i(a),$(m).empty(),B.reset(),h(a),f()})}),B=new LazySorter("name","asc",u.children,function(){C=1,GT.User.rosterFilter({courseId:b.id,tileId:a.id,userId:A,sortType:B.type,sortOrder:B.order},x,C,function(a){i(a),$(m).empty(),h(a)})}),l=new Filterer(k,w),l.hide(),s=GT.Tile.wrapTile(a,void 0,b),q.href=s.getCsvLink("everyone"),l.context="Course",l.contextId=b.id,GT.Filters.hasFilters(b.id,function(a){var b;a.success?(n[2].checked=!0,l.fetchFilters(w),l.show(),b="custom"):(n[0].checked=!0,b="everyone",o({target:n[0]})),
s.getCsvLink&&(q.href=s.getCsvLink(b))}),this.contentContainer=j,a.attendanceType&&(v.onclick=function(b){var c,d,e,f=[];c=b.target.parentElement.parentElement.querySelectorAll(".js-student-list-item"),d=b.target.parentElement.parentElement.querySelectorAll(".js-student-list-item .done");for(var g=0;g<c.length;g++){var h=c[g].querySelector(".done");c.length===d.length?(e=!1,r[1].textContent=0,h.parentElement.removeChild(h)):(c[g].querySelector(".done")&&h.parentElement.removeChild(h),e=!0,r[1].textContent=100,$(c[g].querySelector("a")).append(Handlebars.partials.results_list_check())),f.push(c[g].value)}GT.Tile.markAttended(a.id,f,e,function(){})}),p=function(c,d){var e,f,h;if(e=GT.Tile.wrapTile(a,c.id,b),e.getResult)if("Assignment"===a.type){var i=document.querySelector("#js-manager-body");$(i).empty(),e.getResult(c,function(a){i.appendChild(a)})}else f=new LightBox({closeButton:!0,closeable:!0,id:a.type.toLowerCase()+"-result"}),f.open(e.getResult(c,function(a){h=g(a),$(d).replaceWith(h),d=h}));else if(a.attendanceType){var j,k,l=[],m=d.parentElement.querySelectorAll(".js-student-list-item"),n=d.querySelector(".done");d.querySelector(".done")?(j=!1,n.parentElement.removeChild(n)):(j=!0,$(d.querySelector("a")).append(Handlebars.partials.results_list_check())),k=d.parentElement.querySelectorAll(".js-student-list-item .done"),m&&(r[1].textContent=Math.round(k.length/m.length*100),m.forEach(function(a){l.push(a.value)})),GT.Tile.markAttended(a.id,[d.value],j,function(){})}},o=function(c){var d,g={tile_id:a.id,courses:b.id};c.target===n[1]?(g.descendants=!0,l.hide(),d="team",x="descendants"):c.target===n[2]?(g.filters=!0,l.show(),d="custom",x="filters"):(l.hide(),d="everyone",x="all"),s.getCsvLink&&(q.href=s.getCsvLink(d)),$(e).find("select").val("").trigger("change"),C=1,GT.User.rosterFilter({courseId:b.id,tileId:a.id},x,C,function(a){var b;for(b=0;b<a.length;b++)a[b].tile_status_datum&&(a[b].tile_status_datum.completed&&(a[b].tile_completed=!0),a[b].tile_status_datum.passed&&(a[b].tile_passed=!0),(a[b].tile_status_datum.score||0===a[b].tile_status_datum.score)&&(a[b].tile_score=a[b].tile_status_datum.score));$(m).empty(),B.reset(),h(a),f()})},n.forEach(function(a){a.onclick=o})}function Roster(a){"use strict";function b(b,e,l){function s(a){$(k).empty(),d(k,a,b),v(a)}function v(b){var c;b.length>0?(c=G.getAttribute("href"),(c.includes("?")||c===window.location.href)&&(c="courses/"+a+"/results_csv.csv"),p?G.href=c:q?G.href=c+"?descendants=true":G.href=c+"?csv_scopes=true"):G.href=window.location.href}function w(b){var d,e=!1;y={},b.previousElementSibling.checked=!0,$(H).find("select").val("").trigger("change"),"custom"===b.previousElementSibling.value?(g.fetchFilters(z),g.show(),e=!0,h="filters",p=!1,q=!1):"team"===b.previousElementSibling.value?(y={descendants:!0,courses:a},p=!1,h="descendants",q=!0):(d=!0,y={courses:a},p=!0,h="all",q=!1),e||(g.hide(),r=1,GT.User.rosterFilter({courseId:a},h,r,function(a){s(a),n.reset(),c()}))}var x,y,z,A,B,C,D,E,F,G,H,I,J=document.createDocumentFragment(),K={url:"http://"+window.location.host+"#section="+b.uuid,course:b,hasCategories:account.organization.custom_category_types.length>0,staff_only:l,custom_categories:e};$(J).append(JST["app/templates/roster_view/student-roster.us"](K)),B=J.querySelectorAll(".button-group-item"),C=J.querySelector("#js-student-filters"),k=J.querySelector("#student-list"),j=J.querySelector(".statistics"),f=J.querySelector("#roster-header"),G=J.querySelector("#csv-download"),A=J.querySelector("#user-adder"),D=J.querySelector("#js-edit-assignments"),E=J.querySelectorAll("#js-dropdown-actions li"),F=J.querySelector("#js-select-all-button"),H=J.querySelector("#search-bar-container"),m=J.querySelector("#js-lazy-load");var L=J.querySelector("#student-headers");z=function(){var b={};b.courses=a,b.filters=!0,h="filters",r=1,GT.User.rosterFilter({courseId:a},h,r,function(a){s(a),c()})},n=new LazySorter("name","asc",L.children,function(){r=1,GT.User.rosterFilter({courseId:a,sortType:n.type,sortOrder:n.order},h,r,function(a){s(a)})}),g=new Filterer(C,z);var M={course:a,url:"users/single_student",append:!0,attachTo:H,selectListener:!0,forceSingle:!0,cssRule:{width:"100%"},placeholder:"Search learners",types:["users"],allowClear:!0};I=document.createElement("select"),H.appendChild(I),new Picker(I,M,function(b){B.forEach(function(a){a.previousElementSibling.checked=!1}),g.hide(),h="single_user",i=b.users[0],r=1,GT.User.rosterFilter({courseId:a,userId:i},h,r,function(a){s(a),n.reset(),c()})}),g.context="Course",g.contextId=a,F.onclick=function(){var a,b;for(t=!t,a=document.getElementsByClassName("js-user-checkbox"),u=!0,b=0;b<a.length;b++)a[b].checked=!t,a[b].click();u=!1};var N=function(b){var d,e;return d=[],e=[],o=document.querySelectorAll(".js-user-checkbox:checked"),o.forEach(function(a){d.push(a.parentElement.parentElement),e.push(a.value)}),t&&(e="all"),GT.UserCourse.updateAll(a,e,h,i,b,function(a){var b;b=a.updated>1?"learners":"learner",GT.Notification.show(a.updated+" "+b+" updated."),c()}),d};E[0].onclick=function(){var a=document.createDocumentFragment(),b=new LightBox({closable:!0,closeButton:!0});$(a).append(JST["app/templates/roster_view/datebox.us"]({label:"Start Date"}));var c=a.querySelector("#js-date"),d=a.querySelector("#js-button");$(c).datepicker({dateFormat:"yy-mm-dd"}),b.open(a),d.onclick=function(){var a,d,e,f,g,h=new DateCalculator;f=new Date(Date.now()).getFullYear(),a=""===c.value?null:c.value,g=N({start_date:a}),g.forEach(function(b){e=h.userCourseDateParser(a),d=e.month+" "+e.day,e.year<f&&(d+=" "+e.year),b.querySelector(".start-date").textContent=d}),b.close()}},E[1].onclick=function(){var a=document.createDocumentFragment(),b=new LightBox({closable:!0,closeButton:!0});$(a).append(JST["app/templates/roster_view/datebox.us"]({label:"End Date"}));var c=a.querySelector("#js-date"),d=a.querySelector("#js-button");$(c).datepicker({dateFormat:"yy-mm-dd"}),b.open(a),d.onclick=function(){var a,d,e,f,g,h=new DateCalculator;f=new Date(Date.now()).getFullYear(),a=""===c.value?null:c.value,g=N({end_date:a}),g.forEach(function(b){a?h.daysUntilDeadline({end_date:a},function(b){0===b.ends_in?d="Today":1===b.ends_in?d="Tomorrow":(e=h.userCourseDateParser(a),d=e.month+" "+e.day,e.year<f&&(d+=" "+e.year))}):d="",b.querySelector(".end-date").textContent=d}),b.close()}},E[2].onclick=function(){var a;a=N({marked_complete:1}),a.forEach(function(a){a.querySelector(".completion").textContent="Complete"})},E[3].onclick=function(){var b;if(N({marked_complete:0}),y&&y.length>0)for(b=0;b<y.filters.length;b++)y.filters[b]=JSON.stringify(y.filters[b]);h="filters",r=1,GT.User.rosterFilter({courseId:a},h,r,function(a){o.forEach(function(b){a.forEach(function(a){Number(b.value)===a.id&&(b.parentElement.parentElement.querySelector(".completion").textContent=(a.completion_percentage||0)+"%")})}),c()})},E[4].onclick=function(){var a;a=N({dropped:1}),a.forEach(function(a){$(a).remove()})},D.onclick=function(){$(D).toggleClass("open")},A.onclick=function(){!account.organization.user_limit||account.organization.user_count<account.organization.user_limit?window.location.href="#addlearners-"+a:GT.Notification.showError("Your organization has reached its user limit ("+account.organization.user_limit+" users). Please contact sales@tryskillo.com to increase your user limt.")};for(var O=function(a){D.classList.remove("open"),w(a.target)},P=0;P<B.length;P++)B[P].onclick=O;return x={courses:a},GT.Filters.hasFilters(a,function(e){e.success?w(B[2]):(h="all",g.hide(),B[0].previousElementSibling.checked=!0,r=1,GT.User.rosterFilter({courseId:a},h,r,function(a){c(),d(k,a,b)}))}),J.querySelector("main")}function c(){GT.Course.stats(a,h,i,function(a){var b;b=j.querySelectorAll(".num"),b[0].textContent=a.total_learners,b[1].textContent=a.total_complete,b[2].textContent=Math.round(a.average_progress)+"%"})}function d(a,b,c){var d,f;if(b&&0!==b.length)for(f=0;f<b.length;f++)e(a,b[f],c);else d=document.createDocumentFragment(),$(d).append(JST["app/templates/roster_view/no-students.us"]()),a.appendChild($(d).first().get(0))}function e(a,b,c){var d,e,f,g,h,i={start_date:b.start_date,end_date:b.end_date};d=document.createDocumentFragment(),f=new DateCalculator,h=new Date(Date.now()).getFullYear(),b.start_date&&(g=f.userCourseDateParser(b.start_date),b.start_date=g.month+" "+g.day,g.year<h&&(b.start_date+=" "+g.year)),b.end_date&&f.daysUntilDeadline(b,function(a){0===a.ends_in?b.end_date="Today":1===a.ends_in?b.end_date="Tomorrow":(g=f.userCourseDateParser(b.end_date),b.end_date=g.month+" "+g.day,g.year<h&&(b.end_date+=" "+g.year))}),0!==b.marked_complete&&b.marked_complete?b.marked_complete&&(b.marked_complete="Complete"):b.active=!0,e={user_course:b,course:c},$(d).append(JST["app/templates/roster_view/student-item.us"](e)),d.querySelector("a").onclick=function(){Completion(e.user_course.id)};var j=d.querySelector(".student"),k=d.querySelector(".js-user-checkbox");k.onclick=function(){var a;u||(t=!1),k.checked?o.push(k):(a=Array.prototype.indexOf.call(o,k),o.splice(a,1))},b.start_date=i.start_date,b.end_date=i.end_date,a.appendChild(j),t&&(u=!0,k.click(),u=!1)}this.titleChangeCallback=void 0;var f,g,h,i,j,k,l,m,n,o=[],p=!0,q=!1,r=1,s=!1,t=!1,u=!1;this.initRoster=function(c){GT.Course.get(a,void 0,function(d){l=d,GT.UserCourse.getInstructorUserCourse(a,function(a){c(a?b(d,a.custom_categories,a.staff_only):b(d,GT.getDefaultRestrictedCategories(),"staff"===account.organization.permission_scheme))})})},this.loadMore=function(b){1===r&&(s=!1),r++,s||(m.classList.remove("hidden"),GT.User.rosterFilter({courseId:a,sortType:n.type,sortOrder:n.order},h,r,function(a){m.classList.add("hidden"),a.length>0?d(k,a,l):s=!0}))}}function RosterView(a){"use strict";GTView.call(this);var b,c,d=this;this.div.id="roster-view",this.bodyClass="roster-view",this.beforeTemplateLoad=function(c){GT.Course.get(a,void 0,function(a){b=a,GTView.setRoles(b.user_role),sideBar.setCourse(b),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(b.user_role,void 0,function(){})}),c(b)})},this.beforeViewLoad=function(){c=new Roster(b.id),c.initRoster(function(a){d.elements.mainContainer.appendChild(a)})},this.onScrollBottom=function(){c.loadMore()}}function ScormEngine(a,b,c,d){function e(a,b,c,d){"use strict";function e(a,b){return o[a]?o[a]:b}function f(a){var b,c,d=a.replace(/_count$/,"").replace(/\./g,"\\."),e=[],f=new RegExp(d);for(var g in o)o.hasOwnProperty(g)&&f.test(g)&&(b=new RegExp(d+"\\d+"),c=b.exec(g)[0],e.indexOf(c)===-1&&e.push(c));return e.length}function g(a){var b=/\.\d+\./g;return a.replace(b,".n.")}function h(a){var b=q[g(a)];return"WO"!==b}function i(a){var b=q[g(a)];return"RO"!==b}var j=this,k=!0,l=!1,m=0,n="",o={},p={},q={"cmi.core._children":"RO","cmi.core.student_id":"RO","cmi.core.student_name":"RO","cmi.core.lesson_location":"RW","cmi.core.credit":"RO","cmi.core.lesson_status":"RW","cmi.core.entry":"RO","cmi.core.score_children":"RO","cmi.core.score.raw":"RW","cmi.core.score.max":"RW","cmi.core.score.min":"RW","cmi.core.total_time":"RO","cmi.core.lesson_mode":"RO","cmi.core.exit":"WO","cmi.core.session_time":"WO","cmi.suspend_data":"RW","cmi.launch_data":"RO","cmi.comments":"RW","cmi.comments_from_lms":"RO","cmi.objectives._children":"RO","cmi.objectives._count":"RO","cmi.objectives.n.id":"RW","cmi.objectives.n.score._children":"RO","cmi.objectives.n.score.raw":"RW","cmi.objectives.n.score.max":"RW","cmi.objectives.n.score.min":"RW","cmi.objectives.n.status":"RW","cmi.student_data._children":"RO","cmi.student_data.mastery_score":"RO","cmi.student_data.max_time_allowed":"RO","cmi.student_data.time_limit_action":"RO","cmi.student_preference._children":"RO","cmi.student_preference.audio":"RW","cmi.student_preference.language":"RW","cmi.student_preference.speed":"RW","cmi.student_preference.text":"RW","cmi.interactions._children":"RO","cmi.interactions._count":"RO","cmi.interactions.n.id":"WO","cmi.interactions.n.objectives._count":"RO","cmi.interactions.n.objectives.n.id":"WO","cmi.interactions.n.time":"WO","cmi.interactions.n.type":"WO","cmi.interactions.n.correct_responses._count":"RO","cmi.interactions.n.correct_responses.n.pattern":"WO","cmi.interactions.n.weighting":"WO","cmi.interactions.n.student_response":"WO","cmi.interactions.n.result":"WO","cmi.interactions.n.latency":"WO"},r={"cmi.core._children":function(){return"student_id, student_name, lesson_location, credit, lesson_status, entry, score, total_time, lesson_mode, exit, session_time"},"cmi.core.student_id":function(){return window.account.id},"cmi.core.student_name":function(){return window.account.first_name+" "+window.account.last_name},"cmi.core.credit":function(){return"credit"},"cmi.core.lesson_status":function(a){return e(a,"not attempted")},"cmi.core.entry":function(){return l?"ab-initio":"completed"!==o["cmi.core.lesson_status"]?"resume":""},"cmi.core.score_children":function(){return"raw,min,max"},"cmi.core.lesson_mode":function(){return"completed"===o["cmi.core.lesson_status"]?"review":"normal"},"cmi.objectives._children":function(){return"id,score,status"},"cmi.objective._count":function(a){return f(a)},"cmi.objectives.n.score._children":function(){return"raw,min,max"},"cmi.objectives.n.status":function(){return"passed,completed,failed,incomplete,browsed,not attempted"},"cmi.student_data._children":function(){return"master_score,max_time_allowed,time_limit_action"},"cmi.student_data.time_limit_action":function(){return"'exit,message','exit,no message','continue,message','continue,no message'"},"cmi.student_preference._children":function(){return"audio,language,speed,text"},"cmi.interactions._children":function(){return"id, objectives, time, type, correct_responses, weighting,student_response, result, latency"},"cmi.interactions._count":function(a){return f(a)},"cmi.interactions.n.objectives._count":function(a){return f(a)},"cmi.interactions.n.type":function(){return"true-false, choice, fill-in, matching, performance, sequencing, likert, numeric"},"cmi.interactions.n.correct_responses._count":function(a){return f(a)}};this.activity=void 0,this.beingUsed=function(){return k},this.LMSInitialize=function(){return this.activity&&this.activity(),c||!b?(d.contentWindow.document.cookie=void 0,l=!0):GT.Tile.getScormData(a.id,b,function(a){o=a,k=!0,0===o.length&&(l=!0)},!1),!0},this.LMSFinish=function(){return this.activity&&this.activity(),this.LMSCommit()},this.LMSGetValue=function(a){this.activity&&this.activity();var b,c=g(a);return h(a)?b=r[c]?r[c](a):o[a]:(m=405,n=a+"is read only",b=""),void 0===b&&(b=""),console.log("Get Value FCN - key: "+a+" value: "+b),b},this.LMSSetValue=function(a,b){return this.activity&&this.activity(),console.log("Set Value FCN - key: "+a+" value: "+b),i(a)?(k=!1,p[a]=b,o[a]=b,"cmi.core.lesson_status"===a&&j.LMSCommit(),"true"):(m=404,n=a+" is write only","false")},this.LMSCommit=function(d){return this.activity&&this.activity(),c||k||(console.log("Committing SCORM 1.2 data."),k=!0,GT.Tile.setScormData(a.id,b,p,d),p={}),!0},this.LMSGetLastError=function(){return m},this.LMSGetErrorString=function(){return n},this.LMSGetDiagnostic=function(){return n}}function f(a,b,c,d){function e(a,b){return o[a]?o[a]:b}function f(a){var b,c,d=a.replace(/_count$/,"").replace(/\./g,"\\."),e=[],f=new RegExp(d);for(var g in o)o.hasOwnProperty(g)&&f.test(g)&&(b=new RegExp(d+"\\d+"),c=b.exec(g)[0],e.indexOf(c)===-1&&e.push(c));return e.length}function g(a){var b=/\.\d+\./g;return a.replace(b,".n.")}function h(a){var b=q[g(a)];return"WO"!==b}function i(a){var b=q[g(a)];return"RO"!==b}var j=this,k=!0,l=!1,m=0,n="",o={},p={},q={"cmi._version":"RO","cmi.comments_from_learner._children":"RO","cmi.comments_from_learner._count":"RO","cmi.comments_from_learner.n.comment":"RW","cmi.comments_from_learner.n.location":"RW","cmi.comments_from_learner.n.timestamp":"RW","cmi.comments_from_lms._children":"RO","cmi.comments_from_lms._count":"RO","cmi.comments_from_lms.n.comment":"RO","cmi.comments_from_lms.n.location":"RO","cmi.comments_from_lms.n.timestamp":"RO","cmi.completion_status":"RW","cmi.completion_threshold":"RO","cmi.credit":"RO","cmi.entry":"RO","cmi.exit":"WO","cmi.interactions._children":"RO","cmi.interactions._count":"RO","cmi.interactions.n.id":"RW","cmi.interactions.n.type":"RW","cmi.interactions.n.objectives._count":"RO","cmi.interactions.n.objectives.n.id":"RW","cmi.interactions.n.timestamp":"RW","cmi.interactions.n.correct_responses._count":"RO","cmi.interactions.n.correct_responses.n.pattern":"RW","cmi.interactions.n.weighting":"RW","cmi.interactions.n.learner_response":"RW","cmi.interactions.n.result":"RW","cmi.interactions.n.latency":"RW","cmi.interactions.n.description":"RW","cmi.launch_data":"RO","cmi.learner_id":"RO","cmi.learner_name":"RO","cmi.learner_preference._children":"RO","cmi.learner_preference.audio_level":"RW","cmi.learner_preference.language":"RW","cmi.learner_preference.delivery_speed":"RW","cmi.learner_preference.audio_captioning":"RW","cmi.location":"RW","cmi.max_time_allowed":"RO","cmi.mode":"RO","cmi.objectives._children":"RO","cmi.objectives._count":"RO","cmi.objectives.n.id":"RW","cmi.objectives.n.score._children":"RO","cmi.objectives.n.score.scaled":"RW","cmi.objectives.n.score.raw":"RW","cmi.objectives.n.score.min":"RW","cmi.objectives.n.score.max":"RW","cmi.objectives.n.success_status":"RW","cmi.objectives.n.completion_status":"RW","cmi.objectives.n.progress_measure":"RW","cmi.objectives.n.description":"RW","cmi.progress_measure":"RW","cmi.scaled_passing_score":"RO","cmi.score._children":"RO","cmi.score.scaled":"RW","cmi.score.raw":"RW","cmi.score.min":"RW","cmi.score.max":"RW","cmi.session_time":"WO","cmi.success_status":"RW","cmi.suspend_data":"RW","cmi.time_limit_action":"RO","cmi.total_time":"RO","adl.nav.request":"RW","adl.nav.request_valid.continue":"RO","adl.nav.request_valid.previous":"RO","adl.nav.request_valid.choice.{target=}":"RO","adl.nav.request_valid.jump.{target=}":"RO"},r={"cmi._version":function(){return"1.0"},"cmi.comments_from_learner._children":function(){return"comment, location, timestamp"},"cmi.comments_from_learner._count":function(a){return f(a)},"cmi.comments_from_lms._children":function(){return"comments, location, timestamp"},"cmi.comments_from_lms._count":function(a){return f(a)},"cmi.completion_status":function(a){return e(a,"unknown")},"cmi.completion_threshold":function(){return 0},"cmi.credit":function(){return"credit"},"cmi.entry":function(){return l?"ab_initio":"completed"!==o["cmi.completion_status"]?"resume":""},"cmi.interactions._children":function(){return"id, objectives, timestamp, type, correct_responses, weighting, learner_response, result, latency, description"},"cmi.interactions._count":function(a){return f(a)},"cmi.interactions.n.objectives._count":function(a){return f(a)},"cmi.interactions.n.correct_responses._count":function(a){return f(a)},"cmi.launch_data":function(){return""},"cmi.learner_id":function(){return window.account.external_id?window.account.external_id:window.account.id},"cmi.learner_name":function(){return window.account.first_name+" "+window.account.last_name},"cmi.learner_preference._children":function(){return"audio_level,language,delivery_speed,audio_captioning"},"cmi.max_time_allowed":function(){return""},"cmi.mode":function(){return"completed"===o["cmi.completion_status"]?"review":"normal"},"cmi.objectives._children":function(){return"id,score,success_status,completion_status,description"},"cmi.objectives._count":function(a){return f(a)},"cmi.objectives.n.score._children":function(){return"scaled,raw,min,max"},"cmi.objectives.n.success_status":function(a){return e(a,"unknown")},"cmi.scaled_passing_score":function(){var b;return a.min_score&&o["cmi.score.max"]?(b=a.min_score/o["cmi.score.max"],b>=0&&b<=1?b:b>1?1:0):0},"cmi.score._children":function(){return"scaled,raw,min,max"},"cmi.success_status":function(a){return e(a,"unknown")},"cmi.time_limit_action":function(){return"exit,message"},"cmi.total_time":function(){return""},"adl.nav.request_valid.continue":function(){return!0},"adl.nav.request_valid.previous":function(){return!0},"adl.nav.request_valid.choice.{target=}":function(){return!0},"adl.nav.request_valid.jump.{target=}":function(){return!0}},s=function(){this.Commit()};window.onbeforeunload||(window.onbeforeunload=s),this.activity=void 0,this.beingUsed=function(){return k},this.Initialize=function(){return c||!b?(d.contentWindow.document.cookie=void 0,l=!0):GT.Tile.getScormData2004(a.id,b,function(a){o=a,k=!0,0===o.length&&(l=!0)},!1),!0},this.Terminate=function(){return this.activity&&this.activity(),this.Commit()},this.GetValue=function(a){var b,c=g(a);return this.activity&&this.activity(),h(a)?b=r[c]?r[c](a):o[a]:(m=405,n=a+"is read only",b=""),void 0===b&&(b=""),console.log("Get Value: "+a+" = "+b),b},this.SetValue=function(a,b){return console.log("Set Value: "+a+" = "+b),this.activity&&this.activity(),i(a)?(k=!1,p[a]=b,o[a]=b,"cmi.completion_status"===a&&j.Commit(),"true"):(m=404,n=a+"is write only","false")},this.Commit=function(d){return this.activity&&this.activity(),c||k||(console.log("Committing SCORM 2004 data."),k=!0,GT.Tile.setScormData(a.id,b,p,d),p={}),!0},this.GetLastError=function(){return m},this.GetErrorString=function(){return n},this.GetDiagnostic=function(){return n}}var g,h,i,j=this,k=!1;this.init=function(k){"localhost"!==document.domain&&(document.domain="myskillo.com"),window.API=new e(a,b,c,d),window.API.activity=function(){j.activity()},window.API_1484_11=new f(a,b,c,d),window.API_1484_11.activity=function(){j.activity()},g=window.setInterval(function(){j.saveAll()},1e4),$(k).mouseleave(function(){j.saveAll()}),window.onbeforeunload||(h=function(){j.saveAll()},window.onbeforeunload=h),window.addEventListener("hashchange",i),window.addEventListener("unload",i)},this.saveAll=function(a){function b(){a&&c.scormOne&&c.scormTwo&&a()}var c={};window.API_1484_11.Commit(function(){c.scormTwo=!0,b()}),window.API.LMSCommit(function(){c.scormOne=!0,b()})},this.destroy=function(a){window.clearInterval(g),j.saveAll(function(){window.removeEventListener("hashchange",i),window.removeEventListener("unload",i),window.API_1484_11=void 0,window.API=void 0,a&&a()})},i=function(){k||(k=!0,j.destroy())}}function SideBar(){"use strict";function a(a,b){var c={course_id:g.id,position:e.length+1,title:"Untitled Topic"};GT.Topic.create(c,function(a){var b;e.push(a),a.ordered_tiles&&(a.tiles=a.ordered_tiles),b=document.createElement("a"),b.id="topic_"+a.id,b.href="#topic-"+a.id,b.className="ui-droppable",b.textContent=a.title,f.push(b),o.push(b),k.appendChild(b),d([b]),b.click()}),b&&b()}function b(a){for(var b,c=!0,d=0;d<a.length;d++)b=a[d].tiles_count,0!==b&&(c=!1);return c}function c(){$(k).sortable({items:":not(#new-topic)",tolerance:"pointer",containment:"nav#topics",update:function(a,b){var c=b.item.context.id.split("_")[1],d=$(b.item.context.parentNode).sortable("toArray");GT.Topic.moveTopicList(c,{topics:d})}})}function d(){$(f).droppable({hoverClass:"highlight",accept:".tile-item",tolerance:"pointer",over:function(a,b){b.draggable.addClass("shrink")},drop:function(a,b){var c,d,e;i=a.target.id,e=i.split("_")[1],c=b.draggable.context.id.split("-")[1],h!==i&&($("#"+b.draggable.context.id).remove(),GT.Topic.get(e,function(a){d=a;var b=a.tiles_count+1;GT.Tile.update({topic_id:e,position:b,id:c},function(a){GT.Notification.show("to "+d.title,4e3,"Moved")})}))}})}var e,f,g,h,i,j,k,l,m,n=this,o=[],p=!1,q=!1;this.initialize=function(){var a=document.createDocumentFragment();q?($("#nav-toggle").show(),this.show()):((account.instructs_courses||account.can_create_course)&&(account.show_instruct_tab=!0),$(a).append(JST["app/templates/sidebar/side-bar-shadow.us"](account)),$(document.body).append(a),l=document.body.querySelector("#app-navigation"),$("#nav-toggle").click(function(){$("body").toggleClass("nav-is-open")}),$(".mobile-sidebar-shadow").click(function(){$("body").removeClass("nav-is-open")}),"login"===this.mode?($("#nav-toggle").hide(),this.hide()):this.show(),q=!0)},this.setCourse=function(a){g=a,p=!0},this.makePrimary=function(){$("#app-navigation").removeClass("secondary"),$("#app-navigation").addClass("primary")},this.makeSecondary=function(){$("#app-navigation").removeClass("primary"),$("#app-navigation").addClass("secondary")},this.empty=function(a,b){n.setCurrent(),m!==a&&($("#app-navigation").empty(),m=a,b&&b())},this.initTopics=function(a,c,d){!e||p?(p=!1,GT.Topic.index(g.id,a,c,function(a){e=a.sort(function(a,b){return a.position-b.position}),b(e)&&g.can_edit&&(void 0===c||0===c.length)&&n.currentTopicViewer&&n.currentTopicViewer.initTileCreator(),n.drawTopicSidebar(e,g,c),n.setCurrent(),d&&d(e)})):(n.drawTopicSidebar(e,g,c),d&&d(e))},this.fillMainSideBar=function(){if("main-sidebar-contents.us"!=m){n.empty();var a,b,c,d;b=document.createDocumentFragment(),m="main-sidebar-contents.us",$(b).append(JST["app/templates/sidebar/main-sidebar-content.us"](account)),d=b.querySelector("#help"),d.onclick=function(a){var b=d.querySelector(".new");b&&$(b).remove()},$("#app-navigation").append(b),n.makePrimary(),$("nav#app-navigation a").click(function(){$("body").removeClass("nav-is-open")}),c=document.querySelectorAll("nav a"),$(c).each(function(){this.hash===window.location.hash&&$(this).addClass("current")}),$(c).click(function(a){$(this).addClass("current"),$(this).siblings().removeClass("current")}),a=l.querySelector(".logout"),a.onclick=function(){User.logout(function(){account.return_url?window.location=account.return_url:window.location="/"})}}},this.fillPersonSideBar=function(a,b,c){if(m!="person_view_sidebar_"+b){n.makeSecondary(),sideBar.empty("person_view_sidebar_"+b);var d,e=document.createDocumentFragment();$(e).append(JST["app/templates/person_view/person_view_sidebar.us"](a)),$(e.querySelectorAll(".courses")).click(function(a){$(this).addClass("current"),$(this).siblings().removeClass("current")}),d="instruct"===c?e.querySelector("#js-instruct-link"):"edit"===c?e.querySelector("#js-edit-link"):e.querySelector("#js-learn-link"),d.classList.add("current"),$("#app-navigation").append(e)}},this.drawTopicSidebar=function(b,e,g){var h=document.createDocumentFragment(),i="Student"===e.user_role?"learn":"instruct";"learn"===i&&(b=b.filter(function(a){return a.tiles_count>0})),$(h).append(JST["app/templates/tile_view/tile-view-left-sidebar.us"]({course:e,userCourseId:g,topics:b})),k=h.querySelector("#topics"),f=Array.prototype.slice.call(h.querySelectorAll("#topics a")),o=Array.prototype.slice.call(h.querySelectorAll("a")),j=h.querySelector("#new-topic"),"Student"!==e.user_role&&(d(),"Instructor"!==e.user_role&&"Creator"!==e.user_role&&"InstructionalAdmin"!==account.user_role||(j.onclick=a,c())),$("#app-navigation").append(h),b.forEach(function(a){var b,c,d,f=0,g=0;d="learn"==e.mode?a.unavailable_tile_ids.length:0;var h=document.querySelector("#topic_"+a.id),i=document.createElement("span");a.status_data&&(a.status_data.forEach(function(b){(b.viewed||b.completed)&&(g++,"learn"==e.mode&&a.unavailable_tile_ids.includes(b.tile_id)&&d--),b.completed&&f++}),b=a.tiles_count-f,c=a.tiles_count-g-d,h.appendChild(i),i.classList.add("count"),c>0&&i.classList.add("new"),b>0&&i.appendChild(document.createTextNode(b)),h.appendChild(i))})},this.setCurrent=function(){var a=window.location.hash.split("-");o.forEach(function(b){var c="#"+b.href.split("#")[1],d=c.split("-");d[0]===a[0]&&d[1]===a[1]?b.classList.add("current"):b.classList.remove("current")})},this.setTopicTitle=function(a,b){f.forEach(function(c){var d=c.href.split("-");Number(d[1])===a&&(c.textContent=b)})},this.show=function(){$(l).show()},this.hide=function(){$(l).hide()}}function Sorter(a,b,c){function d(){switch(l){case"name":j.people.sort(function(a,b){return null===a.user.last_name&&(a.user.last_name=""),null===b.user.last_name&&(b.user.last_name=""),e(a.user.last_name.toLowerCase(),b.user.last_name.toLowerCase(),k)});break;case"title":j.people.sort(function(a,b){return e(a.user.title,b.user.title,k)});break;case"start-date":j.people.sort(function(a,b){return e(a.start_date,b.start_date,k)});break;case"deadline":j.people.sort(function(a,b){return e(a.end_date,b.end_date,k)});break;case"progress":j.people.sort(function(a,b){return f(a,b,k)});break;case"percentage":j.people.sort(function(a,b){return h(a.status_data,b.status_data,a.user.last_name,b.user.last_name,k)});break;case"completion":j.people.sort(function(a,b){return g(a.status_data,b.status_data,k)})}}function e(a,b,c){return n="dsc"==c?-1:1,null==a||void 0==a?1*n:null==b||void 0==b?-1*n:b>a?1*n:-1*n}function f(a,b,c){return n="dsc"==c?-1:1,"Complete"==b.status?-1*n:"Complete"==a.status?1*n:(a.completion_percentage-b.completion_percentage)*n}function g(a,b,c){return n="dsc"==c?-1:1,b[0]&&b[0].completed?-1*n:a[0]&&a[0].completed?1*n:0}function h(a,b,c,d,f){return n="dsc"==f?-1:1,b.length>0&&null==b[0].score&&null!=b[0].updated_at?1*n:a.length>0&&null==a[0].score&&null!=a[0].updated_at?-1*n:a.length<1?-1*n:b.length<1?1*n:j.pass_fail&&(a[0].passed&&b[0].passed||!a[0].passed&&!b[0].passed)?e(c,d,"dsc"):j.pass_fail&&b[0].passed&&!a[0].passed?-1*n:j.pass_fail&&a[0].passed&&!b[0].passed?1*n:n*(parseInt(a[0].score)-parseInt(b[0].score))}function i(){null==l&&(l=b[0].getAttribute("data-sortAttr"),k="dsc"),a[0].classList.add("dsc"),d(),c(j.people)}var j=this;j.storedHeader=a,a=a.children;var k,l=null,m=!1;j.people=[],j.pass_fail=!1;var n=1;if(!m){for(var o=0;o<b.length;o++)b[o].onclick=function(a){a.target.classList.contains("asc")?($(j.storedHeader.children).removeClass("asc"),$(j.storedHeader.children).removeClass("dsc"),a.target.classList.add("dsc"),k="dsc"):a.target.classList.contains("dsc")?($(j.storedHeader.children).removeClass("asc"),$(j.storedHeader.children).removeClass("dsc"),a.target.classList.add("asc"),k="asc"):($(j.storedHeader.children).removeClass("asc"),$(j.storedHeader.children).removeClass("dsc"),a.target.classList.add("dsc"),k="dsc"),l=a.target.getAttribute("data-sortAttr"),d(),c(j.people)};m=!0}this.removeHeaderClass=function(){$(j.storedHeader.children).removeClass("asc"),$(j.storedHeader.children).removeClass("dsc")},this.setNewPeople=function(a,b){b&&b.inPassFail&&(j.pass_fail=b.inPassFail),j.people=a,b&&!b.noSort&&i()},this.addMorePeople=function(a){j.people=j.people.concat(a)},this.updatePersonTile=function(a,b,c){j.people.forEach(function(d){var e;a.includes(d.id)&&(d.tile_status_datum?d.tile_status_datum[b]=c:(e={},e[b]=c,d.status_data.push(e)))})}}function LazySorter(a,b,c,d){var e=this;this.type=a,this.headers=c,this.order=b,this.reset=function(){this.type=a,this.order=b};for(var f=0;f<c.length;f++)c[f].onclick=function(a){a.target.getAttribute("data-sortAttr")&&(a.target.classList.contains("asc")?($(e.headers).removeClass("asc").removeClass("dsc"),a.target.classList.add("dsc"),e.order="asc"):a.target.classList.contains("dsc")?($(e.headers).removeClass("asc").removeClass("dsc"),a.target.classList.add("asc"),e.order="desc"):($(e.headers).removeClass("dsc").removeClass("asc"),a.target.classList.add("dsc"),e.order="asc"),e.type=a.target.getAttribute("data-sortAttr"),d())},c[f].getAttribute("data-sortAttr")==e.type&&("asc"==e.order?$(c[f]).addClass("dsc"):$(c[f]).addClass("asc"))}function SparkEditor(a,b){"use strict";function c(a){$(f.contentContainer).empty(),$(f.contentContainer).append(a)}function d(){function b(a){a.stopPropagation(),a.preventDefault();for(var b=a.target;b&&"BUTTON"!==b.tagName;)b=b.parentElement;var c=b.value;for(l=0;l<g.length;l++)if(g[l].id.toString()===c){g.splice(l,1);break}GT.Quiz.deleteQuizQuestion(c,function(){$(b.parentElement).remove()})}function d(a){return function(){var b,d=a.getAttribute("data-question-id");for(l=0;l<g.length;l++)g[l].id===Number(d)&&(b=l);c(e(b))}}var f,h,i,j,k,l,m;for(m in g)g.hasOwnProperty(m)&&("video"===g[m].question_type?g[m].displayText="(Video Question)":"audio"===g[m].question_type&&(g[m].displayText="(Audio Question)"));if(f=document.createDocumentFragment(),
$(f).append(JST["app/templates/spark_editor/spark_editor.us"]({questions:g,tile:a})),k=f.querySelector("#spark-questions-list"),$(k).sortable({items:".spark-question-item",tolerance:"pointer",stop:function(b,c){setTimeout(function(){GT.Quiz.sortQuestions({questions:$(k).sortable("toArray")},function(){GT.Quiz.getQuiz(void 0,a.id,void 0,function(a){g=a})})},200)}}),i=f.querySelectorAll("li"),g.length>0)for(l=0;l<i.length;l++)i[l].onclick=d(i[l]);for(h=f.querySelectorAll(".delete-question"),l=0;l<h.length;l++)h[l].onclick=b;return j=f.querySelector(".new-question"),j.onclick=function(){GT.Quiz.newQuizQuestion({tile_id:a.id},function(a){g.push(a),c(e(g.length-1))})},f.querySelector("div")}function e(b){var e,f,h,i,j,k,l,m,n,o,p;e=document.createDocumentFragment(),"video"===g[b].question_type?g[b].video=!0:"audio"===g[b].question_type&&(g[b].audio=!0),j={question:g[b]},"Spark"===a.type&&(j.videoSpark=!0),$(e).append(JST["app/templates/spark_editor/spark_question_editor.us"](j)),m=e.querySelector("#record-video"),n=e.querySelector("#upload-video"),o=e.querySelector("#record-audio"),p=e.querySelector("#upload-audio"),i=e.querySelector("#time-limit"),k=e.querySelector("#js-quiz-media-container"),f=e.querySelector(".quiz-done-button"),h=e.querySelector("#question-input"),i.value=g[b].time_limit,i.onchange=function(a){return function(b){var c={};g[a].time_limit=b.target.value,c.time_limit=g[a].time_limit,c.id=g[a].id,GT.Quiz.saveQuizQuestion(c)}}(b),l=function(a,c,d,e){g[b].url=a,g[b].question_type=c,g[b].media=!0,GT.Quiz.saveQuizQuestion(g[b],function(a){$(k).empty(),$(k).append(Handlebars.partials.question_video({question:{url:a.url,mimetype:d},video:"video"===c,audio:"audio"===c})),e&&e()})},m&&(m.onclick=function(){GT.FPWrapper.recordVideo(function(a){l(a[0].url,"video",a[0].mimetype)})}),o&&(o.onclick=function(){var a,b,c,d,e,f=new LightBox({id:"record-or-upload",hasShadow:!0});e=document.createDocumentFragment(),a=new VideoRecorder("audio"),a.setType("audio"),a.captureInputs(),$(e).append(JST["app/templates/quiz_editor/recorder.us"]()),d=e.querySelector("#js-audio-indicator"),b=e.querySelector("#js-record"),c=e.querySelector("#js-preview-container"),a.config.audioScopeCanvas=d,c.appendChild(a.frag),b.onclick=function(){b.textContent="Stop",a.startRecording(),b.onclick=function(){b.textContent="Saving...",a.stopRecording()}},a.config.videoReadyCallback=function(a,b){GT.FPWrapper.storeData(a,b,function(a){l(a.url,"audio",b,function(){f.close()})})},f.open(e)});var q=function(){var b;"Spark"===a.type?b="Video":"AudioSpark"===a.type&&(b="Sound"),GT.FPWrapper.openUploadPrompt(function(a){var c,d;c=GT.FPWrapper.determineType(a),"Video"===c?"Video"===b?(d="video",l(a.url,d,a.mimetype)):GT.Notification.showError("Question Type must match Spark Type"):"Sound"===b?(d="audio",l(a.url,d,a.mimetype)):GT.Notification.showError("Question Type must match Spark Type")},!1,void 0,[b])};return n&&(n.onclick=q),p&&(p.onclick=q),f.onclick=function(){c(d())},h.onchange=function(a){var c={};g[b].question=a.target.value,c.question=g[b].question,c.id=g[b].id,GT.Quiz.saveQuizQuestion(c)},e.querySelector("div")}var f=this,g=[];this.contentContainer=document.createElement("div"),this.contentContainer.className="quiz-editor-container",GT.Quiz.attemptsInProgress(a.id,function(e){!a.hidden&&b||e.success?GT.Notification.info("Can't edit the assessment right now because it might cause nonsensical results. See below:",!1,"#tile-content"):GT.Quiz.getQuiz(void 0,a.id,void 0,function(a){g=a,c(d())}),!a.hidden&&b&&GT.Notification.warning("Tile must be locked to prevent students from starting the assessment while you're editing it. Lock it with the checkbox near the top of this screen. Don't forget to unlock it when you're finished.",!1,"#tile-content"),e.success&&GT.Notification.warning("At least one student has an assessment attempt in progress. You must wait for them to finish.",!1,"#tile-content")})}function SparkPlayer(a,b,c){"use strict";function d(){var b,d;d=document.createDocumentFragment(),$(d).append(JST["app/templates/spark_player/spark_startpage.us"]({course:c,isVideo:"Spark"===a.type})),b=d.querySelector("#js-test-mic-button"),i.appendChild(d),b.onclick=function(){e()}}function e(){var c,d,e,g;d="Spark contains video-recorded questions, which are not supported by your browser. Please use the Google Chrome browser from a webcam enabled laptop or desktop.",$(i).empty(),k=document.createDocumentFragment(),$(k).append(JST["app/templates/spark_player/spark_testpage.us"]({isVideo:"Spark"===a.type})),"Spark"===a.type?o.setType("video"):o.setType("audio"),e=k.querySelector("#js-preview-camera"),g=k.querySelector("#js-preview-canvas"),o.config.previewElement=e,o.config.audioScopeCanvas=g,o.captureInputs(function(){o.startPreview(),o.startScope(!1)}),c=k.querySelector("#js-start-button"),GT.hasGetUserMedia?c.onclick=function(){o.releaseInputs(),b?GT.Quiz.beginAttempt(b,a.id,function(a){n=a.id,f(h[p],b)}):f(h[p])}:(c.disabled=!0,GT.Notification.showError(d)),"AudioSpark"===a.type&&e.classList.add("hidden"),i.appendChild(k)}function f(b,c,d){var e,k,l,q,r,s,t,u,v,w;if(void 0===c&&(c=""),e=document.createDocumentFragment(),b){p=h.indexOf(b),b[b.question_type]=!0,b.video_answer="video"===b.answer_type,b.audio_answer="audio"===b.answer_type,$(e).append(JST["app/templates/spark_player/spark.us"](b)),"video"===b.question_type?r=e.querySelector("#video-player"):"audio"===b.question_type&&(r=e.querySelector("#audio-player")),"video"===b.answer_type?s=e.querySelector("#video-recorder"):"video"===b.answer_type&&(s=e.querySelector("#audio-recorder")),v=e.querySelector("#js-audio-indicator"),t=e.querySelector("#counter"),u=e.querySelector("#status"),j=e.querySelector("#multiple-answer"),k=e.querySelectorAll("button"),q=e.querySelector("#js-coaching-report"),$(i).empty(),i.appendChild(e),b.url&&(w=r.play(),void 0!==w&&w["catch"](function(a){console.log(a),r.controls=!0,r.onPlay=function(){r.controls=!1}}).then(function(){}));var x=new Timer(t),y=function(){o.stopRecording(),t.textContent="",u.textContent="Saving Response...",x.stop()},z=function(){var a;b.time_limit?(u.textContent="Time Remaining: ",x.start(b.time_limit,!0),a=window.setTimeout(function(){y()},1e3*b.time_limit)):(u.textContent="Response Length: ",x.start(0)),o.startRecording(),$(r).addClass("hidden"),$(s).removeClass("hidden"),k[1].textContent="Stop Recording",k[1].onclick=function(){window.clearTimeout(a),y()},k[1].classList.remove("hidden")};o.setType(b.answer_type),o.config.previewElement=s,"audio"===b.answer_type&&(o.config.audioScopeCanvas=v),o.config.videoReadyCallback=function(d,e){GT.FPWrapper.storeData(d,e,function(d){GT.Quiz.recordSparkResponse(a.id,b.id,d.url,c,n,function(){o.resetData(),f(h[p+1],c)})})},$(j).addClass("hidden"),$(k).addClass("hidden"),"video"===b.question_type||"audio"===b.question_type?r.addEventListener("ended",function(){z()},!1):z()}else $(e).append(JST["app/templates/spark_player/spark.us"]({tile:a})),l=e.querySelectorAll("ul li"),""===c?g(m,l,q):GT.Quiz.getResults(a.id,c,d,function(a){g(a,l,q)}),$(i).empty(),i.appendChild(e)}function g(b,c,d){function e(a){var b=document.createDocumentFragment();return $(b).append(JST["app/templates/reader_view/quiz-summary.us"](a)),b}var f,g,h,i;for(g=b.avg_score,f=b.quiz_questions,a.summary_feedback&&(g>=a.min_score||a.attempts_limited)&&d.appendChild(e(b)),b.scored&&c[0].appendChild(document.createTextNode(" "+b.scored)),c[1].appendChild(document.createTextNode(" "+b.quiz_questions.length)),g&&c[2].appendChild(document.createTextNode(" "+g+"%")),a.attempts_limited&&(c[2].appendChild(document.createElement("br")),c[2].appendChild(document.createTextNode("You have used all available quiz attempts."))),c[3]&&g>=a.min_score&&c[3].classList.add("hidden"),h=0;h<f.length;h++)if(f[h].video="video"===f[h].question_type,f[h].audio="audio"===f[h].question_type,f[h].video_answer="video"===f[h].answer_type,f[h].audio_answer="audio"===f[h].answer_type,f[h].spark_responses&&f[h].spark_responses[0])for(f[h].attempted=!0,f[h].response_url=f[h].spark_responses[0].url,i=0;i<f[h].spark_responses.length;i++)f[h].spark_responses[i].spark_response_score&&(f[h].spark_responses[i].scored=!0,f[h].spark_responses[i].spark_response_score=f[h].spark_responses[i].spark_response_score/100*5),f[h].spark_responses[i].correct===!1&&(f[h].spark_responses[i].incorrect=!0),null===f[h].spark_responses[i].spark_response_score&&(f[h].spark_responses[i].not_graded=!0),(f[h].spark_responses[i].text_feedback||f[h].spark_responses[i].video_feedback)&&(f[h].spark_responses[i].display_feedback=!0),f[h].spark_responses[i].text_feedback&&(f[h].spark_responses[i].text_feedback=GT.urlify(f[h].spark_responses[i].text_feedback));$("#spark-final-results").append(JST["app/templates/spark_player/spark-final-results.us"](f))}var h,i,j,k,l,m,n,o,p=0;o=new VideoRecorder,m={correct:0,quiz_questions:[],hasData:!1},l=document.createElement("div"),k=document.createDocumentFragment(),$(k).append(JST["app/templates/reader_view/quiz-container.us"]()),i=k.querySelector(".question-box"),l.appendChild(k),h=[],a.completed?f(void 0,b,!1):GT.Quiz.getQuiz(void 0,a.id,b,function(a){h=a,d(),m.quiz_questions=h,m.hasData=!0}),this.getPlayer=function(){return l}}function SparkResultsViewer(a,b,c){"use strict";function d(d){function e(d){function e(b){if(b.topic_ungraded_count&&b.topic_ungraded_count>0)if(o)o.innerText=b.topic_ungraded_count;else{o=document.querySelector("#topic_"+a.topic_id);var c=document.createElement("span");c.classList.add("count"),c.innerText=b.topic_ungraded_count,o.appendChild(c)}else o&&o.parentNode.removeChild(o);b.tile_ungraded_bool?p||(p=document.querySelectorAll(".tile-nav a")[1],p.classList.add("ungraded")):p&&p.classList.remove("ungraded")}var g,h,i,j,k,l,m,n;for(i=d,j=0;j<i.length;j++)i[j].video="video"===i[j].question_type,i[j].audio="audio"===i[j].question_type,i[j].video_answer="video"===i[j].answer_type&&i[j].spark_responses,i[j].audio_answer="audio"===i[j].answer_type&&i[j].spark_responses,i[j].spark_responses&&i[j].spark_responses.length>0&&(i[j].attempted=!0,i[j].response_url=i[j].spark_responses[0].url);$(f).empty(),$(f).append(JST["app/templates/spark_player/spark_response.us"](i)),m=f.querySelectorAll("#js-spark-feedback-text"),n=f.querySelectorAll("#js-video-feedback"),$(n).on("click",function(a){var b,c=this;b=a.target.parentElement.getAttribute("data-response-id"),GT.FPWrapper.recordVideo(function(a){GT.Quiz.setSparkFeedback(b,{video:a[0].url},function(a){var b=c.parentElement.querySelector(".js-video-feedback-player");b.firstElementChild.src=a.video_feedback,b.classList.remove("hidden")})})}),$(m).on("change",function(a){var b;b=a.target.parentElement.getAttribute("data-response-id");var c=$(this).val();GT.Quiz.setSparkFeedback(b,{text:c},function(){GT.Notification.show("Feedback message saved")})}),$(m).on("keypress",function(a){13===a.keyCode&&$(this).blur()}),g=f.querySelectorAll(".js-correct-select");var o=document.querySelector("#topic_"+a.topic_id+" .count"),p=document.querySelector(".tile-nav a.ungraded");for(h=function(d){GT.Quiz.setCorrect(d.target.getAttribute("data-response-id"),d.target.value,function(d){b.tile_score=d.score,b.status[0].score=b.tile_score,a.min_score&&null!=d.score?(b.tile_passed=d.score>=a.min_score,b.ungraded=!1):0===d.score?(b.tile_passed=!1,b.ungraded=!1):d.score?(b.tile_passed=!0,b.ungraded=!1):(b.tile_passed=null,b.ungraded=!0),b.tile_status_datum.passed=b.tile_passed,GT.UserCourse.getUngradedData(b.id,a.id,function(a){e(a),c(b)})})},j=0;j<g.length;j++)g[j].onchange=h,k=g[j].getAttribute("data-response-id"),l=i.filter(function(a){return!!a.spark_responses[0]&&a.spark_responses[0].id===Number(k)})[0].spark_responses[0],l&&(g[j].value=5*l.spark_response_score/100)}if(!$(document.body).hasClass("learning-course")){var g={tileId:a.id,userCourseId:d,bestAttempt:!1};GT.User.resultData(g,function(a){e(a)})}}var e,f,g,h;h=document.createDocumentFragment(),$(h).append(JST["app/templates/spark_player/spark_results.us"](b)),g=h.querySelector("#quiz-results"),f=h.querySelector("#individual-answers"),e=h.querySelector(".reset-quiz"),d(b.id),e.onclick=function(){GT.Tile.resetScormOrQuiz(void 0,void 0,b.id,a.id,function(d){d.success?($(f).empty(),b.tile_passed=void 0,b.tile_completed=!1,b.tile_score=void 0,b.tile_status_datum.passed=b.tile_passed,b.tile_status_datum.completed=b.tile_completed,b.tile_status_datum.score=b.tile_score,b.ungraded=void 0,GT.UserCourse.getUngradedData(b.id,a.id,function(a){trackGradingData(a),c(b)})):GT.Notification.showErrorList(d.errors)})},this.getFrag=function(){return h}}function StudentAssigner(a,b){"use strict";function c(){function c(a){if(!a||!a.length||a.length>100)return!1;var b=document.createElement("a"),c=document.createElement("ul");return b.textContent=" Who?",$(c).addClass("sanity-check-user-list hidden"),b.onclick=function(){$(c).hasClass("hidden")?$(c).removeClass("hidden"):$(c).addClass("hidden")},a.forEach(function(a){var b=document.createElement("li");b.textContent=a,c.appendChild(b)}),{whoLink:b,userList:c}}function f(a){return 1===a?"user":"users"}function g(a,b){var d,e=a>0||K>0||M>=1||L>=1||b>=500;if(e?($(E).removeClass("hidden"),$(F).removeClass("hidden")):($(E).addClass("hidden"),$(F).addClass("hidden")),a>0?(v.textContent="Accounts will be created for "+a+" new "+f(a)+". ",G.students.length<16&&(d=c(G.students)),d&&(v.appendChild(d.whoLink),v.appendChild(d.userList))):v.textContent="",K>0){var g=1===K?"is":"are",h=H;x.textContent=K+" "+f(K)+" "+g+" currently in this course.  They will be skipped. ",d=c(h),d&&(x.appendChild(d.whoLink),x.appendChild(d.userList))}else x.textContent="";var i=1===L?"has":"have",j=1===M?"has":"have";t.checked&&u.checked?(w[0].textContent=L+" "+f(L)+" will be skipped because they have previously completed this course. ",w[1].textContent=M+" "+f(M)+" will be skipped because they have previously failed this course. "):t.checked?(w[0].textContent=L+" "+f(L)+" will be skipped because they have previously completed this course. ",w[1].textContent=M>0?M+" "+f(M)+" "+j+" taken this course previously, but will be added again. ":""):u.checked?(w[0].textContent=L>0?L+" "+f(L)+" "+i+" taken this course previously, but will be added again. ":"",w[1].textContent=M+" "+f(M)+" will be skipped because they have previously failed this course. "):(w[0].textContent=L>0?L+" "+f(L)+" previously completed this course, but will be added again. ":"",w[1].textContent=M>0?M+" "+f(M)+" previously failed this course, but will be added again. ":""),L&&I.length&&(d=c(I),d&&(w[0].appendChild(d.whoLink),w[0].appendChild(d.userList))),M&&J.length&&(d=c(J),d&&(w[1].appendChild(d.whoLink),w[1].appendChild(d.userList)))}function h(){var a;a=z+A-K,g(A,a),t.checked&&(a-=L),u.checked&&(a-=M),k.disabled=!1,a<=1?k.textContent="Add User":k.textContent="Add "+a+" Users",a>=500&&(y.textContent="You are about to assign a large number of people to this course ("+a+" users).")}var i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G={students:[]},H=[],I=[],J=[],K=0,L=0,M=0,N=document.createDocumentFragment(),O={signup_link:account.organization.signup_link&&"InstructionalAdmin"===account.user_type&&account.organization.allow_external_accounts&&account.organization.on_the_fly_user_creation,course:a,account:account};$(N).append(JST["app/templates/user_assigner/user_assigner.us"](O)),l=N.querySelector("main"),i=N.querySelectorAll("select"),j=i[0],k=N.querySelector("#js-add-people"),r=N.querySelector("#js-skip-passed"),s=N.querySelector("#js-skip-failed"),t=r.querySelector("input"),u=s.querySelector("input"),D=N.querySelector("#js-cancel"),o=N.querySelector("#js-email-users"),d=N.querySelector("#js-import-status"),v=N.querySelector("#js-new-accounts-count"),w=N.querySelectorAll(".js-retakes-count"),x=N.querySelector("#js-skips-count"),y=N.querySelector("#js-large-add"),m=N.querySelector("#js-start-date"),n=N.querySelector("#js-end-date"),E=N.querySelector("#sanity-check"),F=N.querySelector("#sanity-check-header"),$(E).addClass("hidden"),$(F).addClass("hidden"),r.addEventListener("change",function(){B&&C&&P(B,C,function(a){p=p.concat(a),h()})}),s.addEventListener("change",function(){B&&C&&P(B,C,function(a){p=p.concat(a),h()})}),o&&o.addEventListener("change",function(){var a;a=A,g(a)}),$(m).datepicker({dateFormat:"yy-mm-dd"}),$(n).datepicker({dateFormat:"yy-mm-dd"}),q={placeholder:"Select Learners",tokenSeparators:[";","; ","\t","\n"],selectedLabels:!0,attribute:"multiple",types:["users","teams","bosses","all_bosses","custom_category","job_titles"],tags:account.organization.allow_external_accounts&&account.organization.on_the_fly_user_creation,course_id:a.id},new Picker(j,q,function(b,c){k.disabled=!0,k.textContent="Please Wait";var d=JSON.parse(JSON.stringify(b));d.user_emails=c,d.course=a.id,B=d,C=c,P(d,c,function(a){p=p.concat(a),h()})});var P=function(a,b,c){GT.User.assigningCheck(a,function(a){K=0,L=0,M=0;var d,e,f=a.map(function(a){return a.email.toLowerCase()});for(b=b.filter(function(a){return f.indexOf(a.toLowerCase())===-1}),G.students=b,A=b.length,z=a.length,H.length=0,I.length=0,J.length=0,p=[],d=0;d<a.length;d++)if(a[d].user_courses.length>0){var g=null,h=null,i=null;for(e=0;e<a[d].user_courses.length;e++)a[d].user_courses[e].marked_complete===!0?h=!0:g=!0;g?(K++,H.push(a[d].email)):h&&i?(L++,M++,t.checked||u.checked||p.push(a[d].id),I.push(a[d].email),J.push(a[d].email)):h&&(L++,t.checked||p.push(a[d].id),I.push(a[d].email))}else p.push(a[d].id);c(b)})};D.onclick=function(){window.location.hash="#roster-"+a.id},k.onclick=function(){var c,f,g=0;k.disabled=!0,k.textContent="Please Wait",f=!!o&&o.firstElementChild.checked,c={students:p,notify:f,start_date:m.value,end_date:n.value},GT.Course.addUsers(a.id,c,function(a){g++,d.textContent=g+" Users Assigned"},function(c){e.lightBox.close(),window.account.organization.user_count+=A,b?b(c):window.location.hash="#roster-"+a.id})},e.div=l}var d,e=this;GTCreator.call(this),c(),this.openInLightBox=function(){e.lightBox.change(e.div)}}function SupportView(){"use strict";function a(){var a,b=document.createDocumentFragment(),i=1===account.organization.support_emails.length;return i&&(account.organization_support=!1),$(b).append(JST["app/templates/sidebar/help-feedback.us"](account)),g=b.querySelector("div"),c=b.querySelector("#send-feedback-button"),d=b.querySelector("#feedback-name"),e=b.querySelector("#feedback-email"),f=b.querySelector("#feedback-message"),h=b.querySelector("#support-email"),account.cs_message&&(GT.User.updateAccountInfo({user:{cs_message:!1}}),account.cs_message=!1),a=function(){var a=[d.value,e.value,f.value];h?a.push(h.value):i&&a.push(account.organization.support_emails[0].id),Support.createTicket(a,function(a){a.success===!0?(GT.Notification.show(a.message),f.value="",c.disabled=!0,c.textContent="Message Sent"):GT.Notification.showError(a.errors)})},c.onclick=a,g}var b=this;GT.GTView.call(this);var c,d,e,f,g,h;b.createMarkup=function(){sideBar.fillMainSideBar(),b.div.appendChild(a())}}function TileCreator(a,b,c){"use strict";function d(){k.lightBox.open(e(k.parseSearchQuery))}function e(d){var e=document.createDocumentFragment();$(e).append(JST["app/templates/tile_creator/tile-owner-box.us"]());var h=e.querySelector(".standard.go"),j=e.querySelectorAll("button"),l=e.querySelector("#discovery-search");return l.onkeydown=function(a){13===a.which&&h.click()},h.onclick=function(){this.disabled=!0;var e=l.value;d(e);if(""!==e){var f=new WebClipBox(a,b,function(a){k.lightBox.close(),c(a)});k.lightBox.change(f.getWebClipBox(e))}else GT.Notification.showError("Please Enter a URL")},j[1].onclick=function(){g()},j[2].onclick=function(){g({title:"Recorded Video"},!0)},j[3].onclick=function(){k.lightBox.change(f("Quiz"))},window.account.organization.no_spoke===!0?$(j[5]).addClass("hidden"):j[5].onclick=function(){k.lightBox.change(f("AudioSpark"))},j[4].onclick=function(){k.lightBox.close(function(){i({type:"Assignment",topic_id:b,title:"Untitled Assignment"})})},j[6].onclick=function(){k.lightBox.close(function(){i({type:"LiveTraining",topic_id:b,title:"In-Person Training Event"})})},e.querySelector("div")}function f(a){var c=document.createDocumentFragment(),d={isSpark:"Spark"===a||"AudioSpark"==a};$(c).append(JST["app/templates/tile_creator/quiz-creator-box.us"](d));var e=c.querySelector("button"),f=c.querySelector("input"),g=c.querySelectorAll(".button-group-item"),h=a;return g.forEach(function(a){a.onclick=function(a){var b=document.querySelector("span.video"),c=document.querySelector("span.audio");"video-spark"===a.target.previousElementSibling.value?(h="Spark",c.classList.add("hidden"),b.classList.remove("hidden")):(h="AudioSpark",b.classList.add("hidden"),c.classList.remove("hidden"))}}),e.onclick=function(){var a=/^\s*$/;a.test(f.value)||!h?(a.test(f.value)&&GT.Notification.showErrorList(["Title cannot be blank"]),h||GT.Notification.showErrorList(["Spark must have a type"])):k.lightBox.close(function(){i({type:h,topic_id:b,title:f.value})})},c.querySelector("div")}function g(a,c){var d=function(a){var c,d,e,f=[];for(h(),e=0;e<a.length;e++)c=a[e].filename.replace(/\.[^\/.]+$/,""),d=FPWrapper.determineType(a[e]),f.push({type:d,topic_id:b,url:a[e].url,title:c});i({tiles:f})};c?GT.FPWrapper.recordVideo(d):GT.FPWrapper.openUploadPrompt(d,!0)}function h(){k.lightBox.close()}function i(a,b){GT.Tile.newTile(a,function(a){if(a.success)for(c(a.tiles),j=0;j<a.tiles.length;j++)"Scormclip"===a.tiles[j].type&&GT.Tile.process(a.tiles[j].id,function(a){console.log(a)});else GT.Notification.showErrorList(a.errors);b&&b(a.tiles)})}var j,k=this;this.topicId=b,GTCreator.call(k),k.lightBox.id="tile-creator",d()}function TileEditor(a,b){"use strict";function c(c,e){function g(){k.getEditor(j,function(b){a.id=b.id},f),F.appendChild(k.getPreview(G))}function h(){function b(b){a.days_til_available=b.days_til_available}t.checked?(v.disabled=!1,d({days_til_available:v.value},b,!1)):(v.disabled=!0,d({days_til_available:null},b,!1))}var i,j,k,l,m,n,o=[],p=document.createDocumentFragment(),q=!1;"Scormclip"===a.type&&(q=!0);var r={tile:a,account:account,changeToSCORM:q};r[a.type.toLowerCase()]=!0,$(p).append(JST["app/templates/tileedit_view/tile-edit-box.us"](r)),m=p.querySelector("#confirm-delete-button"),l=p.querySelector("#done-button");var s=p.querySelector("#prereq-selector"),t=p.querySelector("#js-days-til-available"),u=p.querySelector("#js-days-til-available-off"),v=p.querySelector("#js-days-til-available-value"),w=p.querySelector("#tile-edit-input"),x=p.querySelector("#require-pass-label"),y=p.querySelector("#require-pass"),z=p.querySelector("#download-settings"),A=p.querySelector("#printing-settings"),B=p.querySelector("#discussion-settings"),C=(p.querySelector("#update-thumbnail"),p.querySelector("#reporting-status")),D=p.querySelectorAll(".js-when-to-unlock");n=p.querySelector("#hidden-status");var E,F=p.querySelector("#edit-thumb-container"),G=p.querySelector(".tile-item-image");return j=p.querySelector("#tile-content"),y.checked=a.require_pass,w.value=a.title,k=GT.Tile.wrapTile(a,b.id,b),g(),null===a.prerequisite_id&&s.children[0].setAttribute("selected","selected"),GT.Course.tiles(b.id,function(b){o=b,b.forEach(function(b){a.id!==b.id&&(i=document.createElement("option"),i.text=b.title,i.setAttribute("data-id",b.id),i.setAttribute("value","-"+b.id),s.add(i)),a.prerequisite_id===b.id&&null!==a.prerequisite_id&&(i&&(i.setAttribute("selected","selected"),$(D).removeClass("hidden")),"Scormclip"!==a.prerequisite.type&&"Quiz"!==a.prerequisite.type&&"Assignment"!==a.prerequisite.type&&"Spark"!==a.prerequisite.type||$(x).removeClass("hidden"))})}),z&&a.no_download&&(z.checked=!a.no_download),A&&a.no_print&&(A.checked=!a.no_print),a.no_discussion&&(B.checked=!a.no_discussion),a.no_reporting&&(C.checked=!a.no_reporting),a.hidden&&(n.checked=a.hidden),t.onchange=h,u.onchange=h,v.onchange=function(){function b(b){a.days_tile_available=b.days_tile_available}!isNaN(Number(v.value))&&Number(v.value)>0&&Number(v.value)<100?d({days_til_available:v.value},b,!1):GT.Notification.show("Range of days must be between 1 and 99")},s.addEventListener("change",function(b){function c(b){a.prerequisite_id=Number(b.prerequisite_id)}var e,f,g,h,i,j=b.target.children,k={};h=j[s.selectedIndex],i=h.getAttribute("data-id"),i?(e=h.getAttribute("value"),g=e.split("-"),f=o.filter(function(a){return a.id===Number(g[1])})[0],"Scormclip"!==f.type&&"Quiz"!==f.type&&"Assignment"!==f.type&&"Spark"!==f.type?$(x).addClass("hidden"):$(x).removeClass("hidden"),$(D).removeClass("hidden")):(i=null,$(x).addClass("hidden"),$(D).addClass("hidden")),k.prerequisite_id=i,d(k,c,!1)}),n.onclick=function(b){function c(b){a.hidden=b.hidden,"Quiz"!=a.type&&"Spark"!=a.type&&"AudioSpark"!==a.type||($(j).empty(),g())}var e={hidden:n.checked};d(e,c,!1)},y.onclick=function(){function b(b){a.require_pass=b.require_pass}var c={require_pass:y.checked};d(c,b,!1)},z&&(z.onclick=function(){function b(b){a.no_download=b.no_download}d({no_download:!z.checked},b,!1)}),A&&(A.onclick=function(){function b(b){a.no_print=b.no_print}d({no_print:!A.checked},b,!1)}),B.onclick=function(){function b(b){a.no_discussion=b.no_discussion}d({no_discussion:!B.checked},b,!1)},C.onclick=function(){function b(b){a.no_reporting=b.no_reporting}d({no_reporting:!C.checked},b,!1)},w.onchange=function(){function b(b){a.title=b.title}var c={title:w.value};d(c,b,!1)},m.onclick=function(){GT.Tile.destroy(a.id,function(a){a.success?f():GT.Notification.showErrorList(a.errors,4e3)})},GT.Tile.updateImagePolicy(function(a){E=a}),F.onclick=function(){var b={};b.tileId=a.id,b.security=E,GT.FPWrapper.uploadImage(b,function(b){a.thumbnail=b.thumbnail,G.src=b.thumbnail})},p.querySelector("div")}function d(b,c,d){void 0===d&&(d=!0),b.id=a.id,GT.Tile.update(b,function(a){a.success?c(a):GT.Notification.showErrorList(a.errors,4e3),d&&f()})}function e(){var a=new LightBox,b=document.createDocumentFragment();$(b).append(JST["app/templates/tileedit_view/tile-delete-prompt.us"]());var c=b.querySelector("#cancel-delete-button");c.onclick=function(){a.close()};var d=b.querySelector("#confirm-delete-button");d.onclick=function(){a.close(),f()},a.open(b.querySelector("#delete-tile"))}this.contentContainer=document.createElement("div"),this.contentContainer.className="main-content-container",this.contentContainer.appendChild(c(d,e));var f=function(){window.location.hash="#topic-"+a.topic_id}}function TileeditView(a,b,c){"use strict";function d(a,b,d){g&&g.tile.id===a?g.setMode(d):g=new TileManager(f,e,d,c),b(g.contentContainer)}GTView.call(this);var e,f,g,h=this;this.div.id="tileedit-view",this.bodyClass="tileedit-view",this.handleArgChange=function(a,c,d){return c===b||d?!("results"!==c||!d)&&(g.learnerResults(d),!0):(b=c,g.setMode(c),!0)},this.beforeTemplateLoad=function(b){GT.Tile.get(a,void 0,function(a){f=a,GT.Topic.get(a.topic_id,function(a){GT.Course.get(a.course_id,void 0,function(a){e=a,GTView.setRoles(e.user_role),sideBar.setCourse(e),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(e.user_role,void 0,function(){})}),b(e)})})})},this.beforeViewLoad=function(){d(a,function(a){h.elements.mainContainer.appendChild(a)},b)},this.onScrollBottom=function(){g.loadMore()}}function TileManager(a,b,c,d){"use strict";var e,f,g,h,i,j,k,l;this.tile=a,this.setMode=function(c){GT.UserCourse.getInstructorUserCourse(b.id,function(d){var g,i;d?(g=d.staff_only,i=d.custom_categories):(g="staff"===account.organization.permission_scheme,i=GT.getDefaultRestrictedCategories()),"editor"===c?(h[0].classList.add("current"),h[1].classList.remove("current"),e=new TileEditor(a,b),$(k).empty(),l="editor"):"results"===c&&(h[0].classList.remove("current"),h[1].classList.add("current"),e=new ResultsViewer(a,b,g,i,k),l="results"),$(f).empty(),f.appendChild(e.contentContainer)})},this.learnerResults=function(d){var e=GT.Tile.wrapTile(a,d,b);GT.UserCourse.getUserCourse({user_course_id:d,tile_id:a.id,with_user:!0},function(a){$(f).empty(),e.getResult(a,function(a){f.appendChild(a),c="results",h.forEach(function(a){a.href.split("#")[1].split("-")[2]===c?a.classList.add("current"):a.classList.remove("current")})})})},this.loadMore=function(){e&&"results"===l&&e.loadMore()},i=document.createDocumentFragment(),$(i).append(JST["app/templates/tileedit_view/tile_manager.us"]({tile:a,course:b})),g=i.querySelector("#js-tile-manager"),f=i.querySelector("#js-manager-body"),k=i.querySelector("#search-bar-container"),h=i.querySelectorAll(".tile-nav a"),d?this.learnerResults(d):this.setMode(c),j=function(a){var b=a.target;b.classList.add("current"),h.forEach(function(a){a!==b&&a.classList.remove("current")})},h.forEach(function(a){a.onclick=j}),h.forEach(function(a){a.href.split("#")[1].split("-")[2]===c?a.classList.add("current"):a.classList.remove("current")}),this.contentContainer=g}function TopicView(a,b){"use strict";function c(){sideBar.setCurrent(),$(f.elements.mainContainer).empty(),e=new TopicViewer(f,a,b,d),sideBar.currentTopicViewer=e,f.elements.mainContainer.appendChild(e.div)}GTView.call(this);var d,e,f=this;this.div.id="topic-view",this.bodyClass="topic-view",this.handleArgChange=function(b,d){return b!==a&&(a=b,c(),!0)},this.beforeTemplateLoad=function(c){GT.Topic.get(a,function(a){GT.Course.get(a.course_id,b,function(a){d=a,GTView.setRoles(d.user_role),sideBar.setCourse(d),sideBar.empty("tile-view-left-sidebar.us",function(){sideBar.makeSecondary(),sideBar.initTopics(d.user_role,b,function(){})}),c(d)})})},this.beforeViewLoad=function(){c()},this.setTopicTitle=function(a,b){sideBar.setTopicTitle(a,b)}}function TopicViewer(a,b,c,d){"use strict";function e(b,c,d){function e(c){c.success?(b.title&&(t.title=b.title),(b.description||""===b.description)&&(t.description=b.description),a.setTopicTitle(b.id,b.title)):(GT.Notification.showError("<strong>Save Failed!</strong><br />"+c.errors[0],2500),d&&d())}b.id=t.id,c?b.title!==t.title&&GT.Topic.updateTitle(b,e):b.description!==t.description&&GT.Topic.updateDescription(b,e)}function f(){GT.Topic.destroy(t.id,function(a){if(a.success){var b="nav #topic_"+t.id,c=$(b).next(),d=$(b).prev();0!=d.length&&"courseinfo"!==d[0].id?d[0].click():c&&c[0].click(),$(b).remove()}else 401===a.code?GT.Notification.showErrorList(a.errors,6e3):GT.Notification.showError(a.error,4e3)})}function g(a){a.textblock||(a.textblock=""),a.comment_count||(a.comment_count=0),a.status_data_by_user&&(a.statusClass=GT.tileStatusClass(a,a.status_data_by_user[0]));var b=document.createDocumentFragment();a.title=a.title.substring(0,99),$(b).append(JST["app/templates/tile_view/tile-item.us"](a));var d=b.querySelector(".tile-item"),e=b.querySelector(".tile-inset-text"),f=b.querySelector("img"),g=b.querySelector(".comment-count"),i=b.querySelector(".manage-tile-button");$(d).addClass(a.type.toLowerCase());var j=c&&a.available&&!a.hidden,k=a.status_data_by_user&&(!a.status_data_by_user[0]||a.status_data_by_user[0]&&!a.status_data_by_user[0].viewed&&!a.status_data_by_user[0].completed);if(j&&k&&$(d).addClass("new-content"),(a.hidden||c&&!a.available)&&$(d).addClass("locked"),!c&&a.ungradings_count){$(d).addClass("ungraded");var l=document.createElement("span");l.innerHTML=a.ungradings_count,i.appendChild(l)}0===a.comment_count&&$(g).addClass("zero");var m=GT.Tile.wrapTile(a);return c&&a.hidden||e.appendChild(m.getPreview(f)),$(d).one("click",function(){c||(c=""),window.location.hash="#reader-"+a.id+"-"+v+"-"+c+"-1"}),$(i).on("click",function(b){h(d,a),b.stopPropagation()}),d}function h(a,b){"Instructor"===d.user_role||"Creator"===d.user_role?("Spark"===b.type||"Assignment"===b.type)&&b.ungradings_count>0?window.location.hash="#tileedit-"+b.id+"-results":window.location.hash="#tileedit-"+b.id+"-editor":window.location.hash="#tileedit-"+b.id+"-results"}function i(){var a=document.createDocumentFragment();return $(a).append(JST["app/templates/tile_view/add-tile-item.us"]()),s=a.querySelector(".add-tile-item"),s.onclick=function(){
u.initTileCreator(t.id,s)},s}function j(a,b,c){var e,f,h,j,p,s,t,v,w,x,y;for(e={title:a.title,description:a.description},t=document.createDocumentFragment(),e.description=GT.urlify(e.description),$(t).append(JST["app/templates/tile_view/content-container.us"]({topic:e,course:d})),r=t.querySelector("#add-content-button"),j=t.querySelector(".main-content-container"),p=t.querySelector("#js-topic-title"),v=t.querySelector("#js-edit-topic-title"),s=t.querySelector(".topic-description"),q=t.querySelector(".section-title-delete-button"),h=t.querySelector(".tile-search-btn"),f=t.querySelector(".tile-search"),r.onclick=function(){u.initTileCreator(a.id)},v.onclick=function(){$(p).focus(),document.execCommand("selectAll",!1,null)},h.onclick=function(){l(this.previousElementSibling.value)},f.addEventListener("keydown",k),p.value=a.title,"Instructor"===d.user_role||"Creator"===d.user_role?(m(p,b,!0),m(s,b,!1),n(c)):$(p).attr("readonly",!0),w=t.querySelector(".course-tile-container"),w.id="topic_"+a.id,y=0;y<a.tiles.length;y++){var z=g(a.tiles[y],a.id,a.course_id);w.appendChild(z)}return"Instructor"!==d.user_role&&"Creator"!==d.user_role||(x=i(a.id),w.appendChild(x),o(w,a),r.onclick=function(){u.initTileCreator(a.id,x)}),j}function k(a){13===a.which&&l(a.target.value)}function l(a){var b,e,f,h,i,j,l=document.querySelector(".search-results");l&&l.parentNode.removeChild(l),b=document.createDocumentFragment(),$(b).append(JST["app/templates/tile_view/search-results.us"]()),e=b.querySelector(".search-results"),f=b.querySelector(".no-results-container"),h=b.querySelector("#search-again"),i=b.querySelector("#js-searching-container"),GT.Course.searchForTiles(d.id,c,a,function(a){for($(i).addClass("hidden"),j=0;j<a.length;j++)e.appendChild(g(a[j]));0===a.length&&f.classList.remove("hidden")}),h.addEventListener("keydown",k),$(u.div).empty(),u.div.appendChild(b)}function m(a,b,c){var d;a.contentEditable=!0,$(a).on("keydown",function(a){if(13===a.which)return $(a.target).blur(),!1}),$(a).blur(function(e){d=c?{title:$(a).text()}:{description:$(a).text()},b(d,c,function(){e.target.focus()})})}function n(a){q.onclick=function(){var b=new LightBox({id:"confirm-delete"});b.prompt("Deleting this topic will delete all the items it contains. Are you sure?",[{text:"Delete",id:"confirm-delete-button",callback:a},{text:"Cancel",id:"cancel-delete-button"}])}}function o(a,b){$(a).sortable({cancel:"[contenteditable]",items:".tile-item:not(.add-tile-item)",revert:200,zIndex:4,helper:"clone",placeholder:"ui-sortable-placeholder tile-item",tolerance:"pointer",cursorAt:{top:0,left:15},start:function(a,b){$(b.item[0]).addClass("tilt")},stop:function(c,d){$(d.item[0]).removeClass("tilt"),$(d.item[0]).removeClass("shrink"),b.tiles_count>0&&GT.Topic.sort({id:b.id,tiles:$(a).sortable("toArray")})}})}function p(a){var b=g(a);return c&&$(b).addClass("new-content"),$(b).insertBefore(s),b}var q,r,s,t,u=this,v=d.id;this.div=document.createElement("div"),GT.Topic.get(b,function(a){t=a,GT.Topic.tiles(t.id,c,function(a){t.tiles=a;var b=j(t,e,f);u.div.appendChild(b)})}),this.initTileCreator=function(){new TileCreator(v,b,function(a){var b,c;if(1===a.length)switch(b=p(a[0]),a[0].type){case"Quiz":case"Spark":case"LiveTraining":case"Assignment":case"AudioSpark":h(b,a[0])}else for(c=0;c<a.length;c++)p(a[c])})}}function VideoRecorder(){"use strict";function a(){var a=l.config.audioScopeCanvas.getContext("2d");a.clearRect(0,0,l.config.audioScopeCanvas.width,l.config.audioScopeCanvas.height)}function b(a){var b;if(a&&l.config.audioScopeCanvas&&navigator.userAgent.indexOf("Chrome")===-1&&navigator.userAgent.indexOf("Safari")!==-1){var c;b=l.config.audioScopeCanvas.getContext("2d"),b.font="80px Helvetica",b.fillStyle="white",b.fillText("Recording",220,210),c=l.config.audioScopeCanvas,c.classList.add("recording-indicator")}else if(l.config.audioScopeCanvas){var d,e,f;m=new AudioContext,d=m.createAnalyser(),e=m.createMediaStreamSource(k),f=m.createScriptProcessor(2048,1,1),d.smoothingTimeConstant=.3,d.fftSize=1024,e.connect(d),d.connect(f),f.connect(m.destination),b=l.config.audioScopeCanvas.getContext("2d"),f.onaudioprocess=function(){var a=new Uint8Array(d.frequencyBinCount);d.getByteFrequencyData(a);for(var c=0,e=a.length,f=0;f<e;f++)c+=a[f];var g=c/e;b.clearRect(0,0,300,150),b.fillStyle="#1D1D29",b.fillRect(0,0,3*g,150)}}}function c(){m&&m.close()}function d(){var a;"video"===o?(l.startPreview(),a={type:"video",canvas:{width:1280,height:720}}):a={type:"audio",numberOfAudioChannels:2,checkForInactiveTracks:!0,bufferSize:16384,sampleRate:48e3,recorderType:StereoAudioRecorder},i=new RecordRTC(k,a),i.startRecording()}function e(){l.videoData=!0,l.config.videoReadyCallback&&l.config.videoReadyCallback(l.dataString,l.dataMimeType)}function f(a){var b;return b=a.split(","),b[b.length-1]}function g(a){return a.split(",")[0].split(":")[1].split(";")[0]}var h,i,j,k,l=this;this.videoData=!1,this.dataURL=void 0,this.dataMimeType=void 0;var m=new AudioContext,n=!!window.MediaRecorder,o="audio";this.config={},this.config.videoReadyCallback=void 0,this.config.previewElement=void 0,this.config.audioScopeCanvas=void 0,h=document.createDocumentFragment(),l.frag=h,j={video:"video"===o},$(h).append(JST["app/templates/tile_creator/record-box.us"](j)),this.setType=function(a){o=n?a:"audio"},this.startRecording=function(a){this.captureInputs(function(c){b(!0),d(),a&&a()})},this.stopRecording=function(){i.stopRecording(function(){i.getDataURL(function(a){l.dataMimeType=g(a),l.dataString=f(a),e(),c()})}),this.releaseInputs()},this.startScope=function(a){b(a)},this.stopScope=function(){a(),c()},this.startPreview=function(){var a;l.config.previewElement.srcObject=k,a=l.config.previewElement.play(),void 0!==a&&a["catch"](function(a){console.log(a),l.config.previewElement.controls=!0,l.config.previewElement.onPlay=function(){l.config.previewElement.muted=!0,l.config.previewElement.controls=!1}}).then(function(){l.config.previewElement.muted=!0})},this.stopPreview=function(){l.config.previewElement.stop()},this.releaseInputs=function(){var a,b;if(k)for(b=k.getTracks(),a=0;a<b.length;a++)b[a].stop();k=void 0},this.captureInputs=function(a){return k?void(a&&a(k)):("undefined"!=typeof navigator.mediaDevices&&navigator.mediaDevices.getUserMedia||window.alert("This browser does not supports WebRTC getUserMedia API."),void("audio"===o?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(b){k=b,a&&a(b)})["catch"](function(a){window.alert("Unable to capture your microphone. Please refresh your browser. If you still encounter this message contact support@tryskillo.com"),console.error(a)}):navigator.mediaDevices.getUserMedia({audio:{echoCancellation:!1},video:!0}).then(function(b){k=b,a&&a(b)})["catch"](function(a){window.alert("Unable to capture your webcam. Please check console logs."),console.error(a)})))},this.resetData=function(){i.clearRecordedData(),this.videoData=!1,this.dataURL=void 0,this.dataMimeType=void 0}}function WebClipBox(a,b,c){"use strict";this.getWebClipBox=function(a,d){function e(){GT.Tile.webclipIds(r.src,function(a){var b=r.src.substring(r.src.indexOf("#")+1);$(s).empty();var c=document.createElement("option");c.appendChild(document.createTextNode("None")),s.appendChild(c);for(var d=0;d<a.length;d++){var e=document.createElement("option");e.value=a[d].id,e.value===b&&(e.selected=!0),e.appendChild(document.createTextNode(a[d].title)),s.appendChild(e)}})}function f(a){GT.Tile.newTile(a,function(a){g(a)&&c(a.tiles)})}function g(a){return!!a.success||(GT.Notification.showErrorList(a.errors,4e3),!1)}function h(a){var b;if("video"===a.type?(b=p.querySelector("#js-video-iframe"),$(b).replaceWith(a.html),i=a.url?a.url:x):(a.url?(r.src=a.url,i=a.url):(r.src=x,i=x),e()),a.error_message)$(v).off("click"),$(u).empty(),$(u).html("Add a Web Page");else{$(u).empty();var c=a.title.substring(0,99);$(u).html(c),w===!1&&(q.value=c);var d=function(){window.open(a.url,"_blank")};"video"!==a.type&&(v=document.body.querySelector("#webclip-thumbnail"),v&&(v.onclick=d,$(v).attr("target","_blank"),a.thumbnail_url&&$(v).css("background-image","url("+a.thumbnail_url+")")))}}var i,j,k=document.createDocumentFragment(),l=["youtu.be","youtube.com","vimeo.com"],m=!1,n=!1;i=a;for(var o=0;o<l.length;o++)if(a.indexOf(l[o])!==-1){m=!0,a.indexOf("vimeo")!==-1&&(n=!0);break}m?$(k).append(JST["app/templates/tile_creator/add-video-container.us"]()):$(k).append(JST["app/templates/tile_creator/add-webclip-container.us"]());var p=k.querySelector("#upload-webclip-container"),q=k.querySelector("#upload-webclip-title-label input"),r=k.querySelector("iframe"),s=k.querySelector("select"),t=k.querySelector("button"),u=k.querySelector("h1"),v=k.querySelector("#webclip-thumbnail"),w=!1;q.onkeyup=function(){w=!0},m===!1&&(s.onchange=function(){var b=a+"#"+this.value;j=GT.YouTube.getVideoIdFromURL(b),j!==!1?GT.YouTube.getData(j,h):h({title:"",thumbnail:"",type:"webpage",url:b})});var x=a;if("http://"!==x.slice(0,7)&&"https://"!==x.slice(0,8)?x="https://"+x:"http://"===x.slice(0,7)&&(x=x.slice(0,4)+"s"+x.slice(4,x.length)),GT.Tile.httpTest(x,function(a){a.success||(x=x.slice(0,4)+x.slice(5,x.length),h({title:"Web Page",thumbnail:"",type:"webpage",url:x}))}),x.length>0)if(j=GT.YouTube.getVideoIdFromURL(x),n){var y=document.createElement("div");new Vimeo.Player(y,{id:x}),h({title:"Vimeo Video",tymbnail:"",type:"video",url:x,html:y})}else j!==!1?GT.YouTube.getData(j,h):h({title:"Web Page",thumbnail:"",type:"webpage",url:x});return t.onclick=function(){q.value.length>0?(GT.Notification.show("Saving new Tile.",500),$(t).attr("disabled","true"),f({type:"Webclip",topic_id:b,url:i,title:q.value})):GT.Notification.showError("Please enter a title for this webpage.",2500)},p}}GT.FPWrapper=FPWrapper,GT.openLightboxes=[],GT.storedHash,GT.LightBox=LightBox,GT.GTView=GTView,GT.currentView={},GT.account={},GT.getDefaultRestrictedCategories=function(){var a=[];return"InstructionalAdmin"!==account.user_type&&account.custom_categories.forEach(function(b){account.organization.custom_category_types.forEach(function(c){b.custom_category_type_id===c.id&&c.hides_learners&&a.push(b)})}),a},GT.shuffleArray=function(a){"use strict";for(var b,c,d=a.length;d;)c=Math.floor(Math.random()*d--),b=a[d],a[d]=a[c],a[c]=b;return a},GT.tileStatusClass=function(a,b){var c="";return b&&(b.passed===!0?c="passed":b.passed===!1&&(b.number_of_attempts<a.attempt_limit||null===a.attempt_limit)&&!b.no_submissions==!0?c="try-again":b.passed===!1?c="failed":"Quiz"!==a.type&&"Spark"!==a.type&&"Assignment"!==a.type||b.completed!==!0?b.completed===!0&&(c="done"):c="pending"),c},GT.splitHostname=function(){var a={},b=new RegExp("([a-z-0-9]{2,63}).([a-z.]{2,5})$"),c=b.exec(window.location.hostname);return a.domain=c[1],a.type=c[2],a.subdomain=window.location.hostname.replace(a.domain+"."+a.type,"").slice(0,-1),a},GT.redirectToSubDomain=function(){var a=GT.splitHostname();window.account.organization.subdomain&&window.account.external_account&&window.account.organization.subdomain!==a.subdomain&&"localhost"!==window.location.hostname&&window.account.organization.subdomain_redirect&&(window.location.hostname=window.account.organization.subdomain+"."+window.location.hostname)},GT.urlify=function(a){if(a){var b=/(https?:\/\/[^\s]+)/g;return a.replace(b,function(a){return'<a target="_blank" class="text-link" href="'+a+'">'+a+"</a>"})}},GT.checkScrollBottom=function(){return $(window).scrollTop()>=.6*($(document).height()-$(window).height())},GT.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},String.prototype.includes||(String.prototype.includes=function(a,b){"use strict";return"number"!=typeof b&&(b=0),!(b+a.length>this.length)&&this.indexOf(a,b)!==-1}),function(){var a=[];"function"!=typeof a.forEach&&(a.constructor.prototype.forEach=function(a,b){if("function"!=typeof a)throw new TypeError(a+" is not a function!");if("undefined"!=typeof b)for(var c=b,d=a,e=0,f=this;e<f.length;++e)d.call(c,f[e],e,f);else for(var d=a,e=0,f=this;e<f.length;++e)d(f[e],e,f)})}(),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(a,b){b=b||window;for(var c=0;c<this.length;c++)a.call(b,this[c],c,this)}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(a,b){function c(a,b){return a===b||"number"==typeof a&&"number"==typeof b&&isNaN(a)&&isNaN(b)}if(null==this)throw new TypeError('"this" is null or not defined');var d=Object(this),e=d.length>>>0;if(0===e)return!1;for(var f=0|b,g=Math.max(f>=0?f:e-Math.abs(f),0);g<e;){if(c(d[g],a))return!0;g++}return!1}}),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(a){if(null==this)throw new TypeError('"this" is null or not defined');var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw new TypeError("predicate must be a function");for(var d=arguments[1],e=0;e<c;){var f=b[e];if(a.call(d,f,e,b))return e;e++}return-1},configurable:!0,writable:!0}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(a){if(null==this)throw TypeError('"this" is null or not defined');var b=Object(this),c=b.length>>>0;if("function"!=typeof a)throw TypeError("predicate must be a function");for(var d=arguments[1],e=0;e<c;){var f=b[e];if(a.call(d,f,e,b))return f;e++}},configurable:!0,writable:!0}),Handlebars.registerHelper("timestamp",function(a,b){return a.split("T")[0]}),GT.Tile={},GT.Tile.allByTopic=function(a,b,c){"use strict";if(void 0===a)throw"Undefined Course ID";$.ajax(Model.defaultsLoader("Loading Course Materials",{url:"/courses/"+a+"/tiles_by_topic",data:{user_course_id:b}},c))},GT.Tile.all=function(a,b){if(void 0===a)throw"Undefined Course ID";$.ajax(Model.defaultsLoader("Loading Course Materials",{url:"/courses/"+a+"/tiles"},b))},GT.Tile.get=function(a,b,c){$.ajax(Model.defaults("Loading Tile",{url:"/tiles/"+a,data:{courseId:1,user_course_id:b}},c))},GT.Tile.tilesInTopicForTile=function(a,b){if(void 0===a)throw"Undefined Tile ID";$.ajax(Model.defaultsLoader("Loading Course Materials",{url:"tiles/"+a+"/tiles_in_topic/"},b))},GT.Tile.stats=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Getting Tile Stats",{url:"tiles/"+a+"/stats",data:{mode:b,user_id:c},dataType:"json"},d))},GT.Tile.topicsNearTile=function(a,b){if(void 0===a)throw"Undefined Tile ID";$.ajax(Model.defaultsLoader("Loading Topic",{url:"tiles/"+a+"/topics_near_tile/"},b))},GT.Tile.update=function(a,b){"use strict";$.ajax(Model.defaults("Updating Course Material",{type:"PUT",url:"tiles/"+a.id,data:{tile:a}},b))},GT.Tile.replace=function(a,b,c){"use strict";$.ajax(Model.defaults("Replacing Tile",{type:"PUT",url:"tiles/"+a+"/replace",data:{new_fp_url:b}},c))},GT.Tile.newTile=function(a,b){$.ajax(Model.defaultsLoader("Saving and Converting Item(s). One Moment Please...",{type:"POST",url:"tiles",contentType:"application/json",data:JSON.stringify(a)},b,a.delay))},GT.Tile.process=function(a,b){"use strict";$.ajax(Model.defaults("Processing New Tile",{type:"POST",url:"tiles/"+a+"/start_processing",dataType:"json",xhrFields:{onprogress:function(a){b(a)}}}))},GT.Tile.destroy=function(a,b){if(void 0===a)throw"Undefined Course ID";$.ajax(Model.defaultsLoader("Deleting Course Material",{type:"DELETE",url:"tiles/"+a},b))},GT.Tile.completed=function(a,b,c){$.ajax(Model.defaults("Tile Completed",{type:"PUT",url:"tiles/"+a+"/completed",data:{user_course_id:b}},c))},GT.Tile.submitResponse=function(a,b,c,d){$.ajax(Model.defaults("Submitting Assignment",{type:"POST",url:"tiles/"+a+"/submit_response",data:{response:b}},c,d))},GT.Tile.deleteAssignmentContent=function(a,b,c){$.ajax(Model.defaults("Deleting Content",{type:"POST",url:"tiles/delete_assignment_content",data:a},b,c))},GT.Tile.resetScormOrQuiz=function(a,b,c,d,e){$.ajax(Model.defaultsLoader("Resetting Quiz File",{type:"POST",url:"tiles/"+d+"/reset_scorm_or_quiz",data:{user_course_id:c,user_id:a,course_id:b}},e))},GT.Tile.filepickerSecurityPolicy=function(a,b){$.ajax(Model.defaultsLoader("Getting Security Policy",{url:"tiles/filepicker_security_policy/?handle="+a},b))},GT.Tile.updateImagePolicy=function(a){$.ajax(Model.defaults("Update Image Security Policy",{url:"tiles/update_image_policy"},a))},GT.Tile.updateThumb=function(a,b,c){$.ajax(Model.defaults("Update Thumbnail",{type:"PUT",url:"tiles/"+b+"/update_thumbnail",data:{new_url:a}},c))},GT.Tile.webclipIds=function(a,b){$.ajax(Model.defaultsLoader("Getting webclipids",{url:"tiles/webclipIds"},b))},GT.Tile.httpTest=function(a,b){var c="This URL does not support 'https' security. For security purposes, only sites that support 'https.' are accepted.";$.ajax(Model.defaults("Testing for HTTPS",{url:"tiles/http_test",error:function(a){200!==a.status&&GT.Notification.showError("Error: "+c,8e3)},data:{url:a}},b))},GT.Tile.markAttended=function(a,b,c,d){$.ajax(Model.defaults("Marking Attended",{type:"POST",url:"tiles/"+a+"/mark_attended",data:{user_course_id:b,value:c}},d))},GT.Tile.setScormData=function(a,b,c,d){$.ajax(Model.defaults("Setting Scorm Data",{type:"POST",url:"tiles/"+a+"/set_scorm_data",data:{data_model:c,user_course_id:b}},d))},GT.Tile.getScormData=function(a,b,c,d){$.ajax(Model.defaults("Getting Scorm Data",{url:"tiles/"+a+"/get_scorm_data",data:{user_course_id:b}},c,d))},GT.Tile.getScormData2004=function(a,b,c,d){$.ajax(Model.defaults("Getting Scorm 2004 Data",{url:"tiles/"+a+"/get_scorm_data_2004",data:{user_course_id:b}},c,d))};var FPWrapper={};GT.FPWrapper=FPWrapper,GT.FPWrapper.client=void 0,FPWrapper.openUploadPrompt=function(a,b,c,d){"use strict";GT.FPWrapper.init();var e,f,g=this;f=["local_file_system","gmail","googledrive","onedrive"],e=[],void 0!==d&&d.indexOf("Image")===-1||(e=e.concat(["image/pjpeg","image/jpeg","image/png"]),f=f.concat(["imagesearch","facebook","instagram","webcam"])),void 0!==d&&d.indexOf("Sound")===-1||(e=e.concat(["audio/*"])),void 0!==d&&d.indexOf("Video")===-1||(e=e.concat(["video/*"]),f=f.concat(["video"])),void 0!==d&&d.indexOf("Document")===-1||(e=e.concat(["application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-powerpoint","application/vnd.openxmlformats-officedocument.presentationml.presentation"])),void 0!==d&&d.indexOf("Scormclip")===-1||(e=e.concat(["application/zip","application/x-zip-compressed","application/x-compress","application/x-compressed","multipart/x-zip"])),void 0!==d&&d.indexOf("EmailMessage")===-1||(e=e.concat(["application/vnd.ms-outlook","application/vnd.msoutlook","message/rfc822","application/octet-stream"])),b?GT.FPWrapper.client.picker({fromSources:f,maxFiles:20,storeTo:{location:"s3"},onUploadDone:function(b){var c=b.filesUploaded;c.reverse(),g.multiUploadResponse(c,a)},onFileUploadFailed:function(a,b){console.log(a),console.log(b)}}).open():GT.FPWrapper.client.picker({accept:e,fromSources:f,storeTo:{location:"s3"},onUploadDone:function(b){var c=b.filesUploaded;g.uploadResponse(c,a)}}).open()},FPWrapper.uploadResponse=function(a,b){"use strict";GT.FPWrapper.init();var c=this;if(0!==a.length){var d=a[0].url.split("/"),e=d[d.length-1];GT.Tile.filepickerSecurityPolicy(e,function(){var d=a[0];b(d),c.uploadResponse(a.slice(1,a.length),b)})}},FPWrapper.multiUploadResponse=function(a,b){"use strict";GT.FPWrapper.init(),0!==a.length&&b(a)},FPWrapper.uploadVideo=function(a){"use strict";GT.FPWrapper.init();var b,c;b=["video/*"],c=["local_file_system","dropbox","gmail","googledrive","box","onedrive","clouddrive"],GT.FPWrapper.client.picker({accept:b,fromSources:c,storeTo:{location:"s3"},onUploadDone:function(b){var c=b.filesUploaded,d=c[0].url.split("/"),e=d[d.length-1];GT.Tile.filepickerSecurityPolicy(e,function(b){a(c[0],b)})}}).open()},FPWrapper.recordVideo=function(a){"use strict";GT.FPWrapper.init(),GT.FPWrapper.client.picker({fromSources:["video","webcam"],videoResolution:"1280x720",accept:["video/*"],storeTo:{location:"s3"},onUploadDone:function(b){var c=b.filesUploaded,d=c[0].url.split("/"),e=d[d.length-1];GT.Tile.filepickerSecurityPolicy(e,function(b){a(c,b)})}}).open()},FPWrapper.determineType=function(a){"use strict";GT.FPWrapper.init();var b,c=a.mimetype,d=a.filename.split(".");if(void 0===c)switch(d[d.length-1]){case"msg":b="EmailMessage";break;default:b="Document"}else switch(c){case"application/vnd.ms-outlook":case"application/vnd.msoutlook":case"message/rfc822":b="EmailMessage";break;case"image/pjpeg":case"image/jpeg":case"image/png":b="Image";break;case"application/pdf":case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/zip":case"application/x-zip-compressed":case"application/x-compress":case"application/x-compressed":case"multipart/x-zip":b="Document";break;default:c&&"video"===c.split("/")[0]?b="Video":c&&"audio"===c.split("/")[0]&&(b="Sound")}return b},GT.FPWrapper.uploadImage=function(a,b){"use strict";GT.FPWrapper.init();var c=["image/*"],d=["local_file_system","dropbox","gmail","googledrive","box","url"];GT.FPWrapper.client.picker({accept:c,fromSources:d,storeTo:{location:"s3"},onUploadDone:function(c){var d=c.filesUploaded;a.tileId?GT.Tile.updateThumb(d[0].url,a.tileId,function(a){b(a)}):b(d[0])}}).open()},GT.FPWrapper.uploadCourseImage=function(a,b){"use strict";GT.FPWrapper.init();var c=["image/*"],d=["local_file_system","dropbox","gmail","googledrive","box","url"];GT.FPWrapper.client.picker({accept:c,fromSources:d,storeTo:{location:"s3"},onUploadDone:function(c){var d=c.filesUploaded;a.courseId?GT.Course.updateThumb(d[0].url,a.courseId,function(a){b(a)}):b(d[0])}}).open()},GT.FPWrapper.storeData=function(a,b,c){"use strict";GT.FPWrapper.init(),GT.FPWrapper.client.upload(a,{}).then(function(a){c(a)})},GT.FPWrapper.init=function(){"use strict";void 0===GT.FPWrapper.client&&(GT.FPWrapper.client=filestack.init(GT.fileStackKey,{security:{policy:account.get_filepicker_security_policy.policy,signature:account.get_filepicker_security_policy.signature}}))},GTView.setModes=function(){"use strict";account.external_account&&$(document.body).addClass("external-account"),"InstructionalAdmin"===account.user_type&&$(document.body).addClass("admin instructs-courses can-observe-anyone can-create-course"),account.people_view_access&&$(document.body).addClass("can-observe-anyone"),account.instructs_courses&&$(document.body).addClass("instructs-courses"),account.can_create_course&&$(document.body).addClass("can-create-course instructs-courses"),account.children_count>0&&$(document.body).addClass("has-reports"),(account.children_count>0||account.people_view_access||"InstructionalAdmin"===account.user_type)&&$(document.body).addClass("new-people-view-access")},GTView.setBrand=function(){"use strict";var a,b;account.brand&&account.brand.style_sheet&&(a=document.getElementById("main-style"),b=a.href.split("/"),b[b.length-1]=account.brand.style_sheet+".css",a.href=b.join("/"))},GTView.setRoles=function(a){"use strict";"Student"===a?$(document.body).addClass("learning-course"):"Creator"===a?($(document.body).addClass("owns-course"),$(document.body).addClass("editing-course"),$(document.body).addClass("observing-course")):"Instructor"===a?($(document.body).addClass("editing-course"),$(document.body).addClass("observing-course")):"ReadOnlyInstructor"===a&&$(document.body).addClass("observing-course")},GTView.unsetRoles=function(){"use strict";$(document.body).removeClass("learning-course"),$(document.body).removeClass("editing-course"),$(document.body).removeClass("observing-course"),$(document.body).removeClass("owns-course")},GTView.checkForExistingSession=function(a){"use strict";User.loggedIn(function(b){b.active?GT.User.accountInfo(function(c){account=c,GT.redirectToSubDomain(),account.activeSession=!0,GTView.setModes(),GTView.setBrand(),account.return_url=b.return_url,Honeybadger.setContext(account),sideBar.initialize(),a(account.activeSession)}):(sideBar.mode="login",a(!1))})},GTView.presentHash=function(){"use strict";function a(a){var e,f,g=["#organization_id","#signup","#section","#register"];if(a)if(account.first_name&&account.last_name&&account.email||"undefined"==typeof account.terms_accepted)if(GT.storedHash&&(d=GT.storedHash,pageload.ignorehashchange=!0,window.location.hash=d.join("-"),GT.storedHash=void 0),d[0]&&g.indexOf(d[0])===-1){if(e=d[0].charAt(1).toUpperCase()+d[0].slice(2,d[0].length)+"View",GT.currentView&&GT.currentView.constructor&&GT.currentView.constructor===window[e]){if(f=d.shift(),GT.currentView.handleArgChange.apply(void 0,d))return;d.unshift(f)}try{b=new(Function.prototype.bind.apply(window[e],d))}catch(h){return void(account.instructs_courses?window.location.hash="#instruct":window.location.hash="#learn")}}else b=account.instructs_courses?new InstructView:new LearnView;else b=new AccountView,GT.Notification.show("Welcome! Please fill in your first and last name to get started!",1e4);else g.indexOf(d[0])===-1&&(GT.storedHash=d),b=new LoginView;GT.currentView.dismiss?GT.currentView.dismiss(function(){""!==b&&b.present()}):c?b.handleReset(c):""!==b&&b.present()}var b,c,d=window.location.hash.split("-");if(d[0].search("=")!==-1){var e=window.location.hash.split("=");d[0]=e[0],d[0].includes("reset_pass")&&(c=e[1]),"#section"===e[0]&&e[1]&&(GT.courseParam=e[1])}account.activeSession?a(account.activeSession):GTView.checkForExistingSession(function(b){a(b)})},LightBox.prompt=function(a,b,c){var d,e=new LightBox({id:"prompt-lightbox"});d=document.createElement("div"),d.id="prompt";var f=document.createElement("p");f.id="prompt-message",f.appendChild(document.createTextNode(a)),d.appendChild(f);for(var g in b){var h=document.createElement("button");b[g].id&&(h.id=b[g].id),b[g].className&&(h.className=b[g].className),h.appendChild(document.createTextNode(b[g].text)),h.onclick=function(a){return function(){b[a].callback&&b[a].callback(),e.close()}}(g),d.appendChild(h)}e.open(d,c)},Honeybadger.configure({api_key:"c62a398af5675b49ebb76737d2ba75ca"});var ie=!1,userAgent=navigator.userAgent.toLowerCase(),sideBar,sideBar=new SideBar,account={user_type:"User"},death=!1,iframe,https,canCall=!1;GT.hasGetUserMedia=!1;var pageload={ignorehashchange:!1,loadUrl:function(){pageload.ignorehashchange===!1?GTView.presentHash():pageload.ignorehashchange=!1}},rightDomain="myskillo.com"===window.location.hostname||"myskillo"===window.location.hostname.split(".")[1];rightDomain||"localhost"===window.location.hostname||(window.location.hostname="myskillo.com"),iframe=window.location!==window.parent.location,iframe&&(top.location=window.location),https="https:"===document.location.protocol,https||"localhost"===window.location.hostname?GT.hasGetUserMedia=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia:document.location.protocol="https";var hashParts=window.location.hash.split("="),organizationParam;"#section"===hashParts[0]&&hashParts[1]&&(GT.courseParam=hashParts[1]),"#organization_id"===hashParts[0]&&hashParts[1]&&(organizationParam=hashParts[1]),window.addEventListener("hashchange",pageload.loadUrl,!1);var listenerFunction=GT.debounce(function(){GT.checkScrollBottom()&&GT.currentView.onScrollBottom()},250);window.addEventListener("scroll",listenerFunction),$(document).ready(function(){pageload.loadUrl()}),$(window).unload(function(){death=!0,window.addEventListener("error",function(a){a.preventDefault(),a.stopPropagation()},!1)}),$.fx.speeds._default=250,$.fx.speeds.slow=400,$.fx.speeds.fast=150,$.fx.speeds.superfast=75,GT.AssignmentRule={},GT.AssignmentRule.beginEdit=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Loading Edit Assignment Rule",{type:"POST",url:"assignment_rules/"+a+"/begin_edit"},b))},GT.AssignmentRule.saveEdit=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Saving Assignment Rule",{type:"POST",url:"assignment_rules/"+a+"/save_edit"},b))},GT.AssignmentRule.cancelEdit=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Caneling Edit Assignment Rule",{type:"POST",url:"assignment_rules/"+a+"/cancel_edit"},b))},GT.AssignmentRule.deleteRule=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Loading Edit Assignment Rule",{type:"DELETE",url:"assignment_rules/"+a},b))},GT.AssignmentRule.getPendingCount=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Running Sanity Check",{type:"GET",url:"assignment_rules/"+a+"/pending_users_count"},b))},GT.AutoAssign={},GT.AutoAssign.create=function(a,b,c){$.ajax(Model.defaultsLoader("Saving new auto assign rule.....",{type:"POST",url:"auto_assign",data:{auto_assign:a,course_id:b}},c))},GT.AutoAssign.get=function(a,b){$.ajax(Model.defaultsLoader("Finding rule id.....",{type:"GET",url:"auto_assign/"+a,data:{course_id:a}},b))},GT.AutoAssign["delete"]=function(a,b,c,d){$.ajax(Model.defaultsLoader("Delete auto assign rule.....",{type:"DELETE",url:"auto_assign/"+a,data:{course_id:a,dependent_course_id:b,list_id:c}},d))},GT.AutoAssign.update=function(a,b,c,d,e){$.ajax(Model.defaultsLoader("Update new rule.....",{type:"PUT",url:"auto_assign/"+a,data:{auto_assign:d,course_id:a,dependent_course_id:b,list_id:c}},e))},Comment.index=function(a,b,c){$.ajax(Model.defaultsLoader("Listing Comments",{url:"/comments",data:a},b,c))},Comment.create=function(a,b){$.ajax(Model.defaults("Posting Comment",{type:"POST",url:"/comments",data:a},b))},Comment.update=function(a,b){var c=a.id;$.ajax(Model.defaults("Updating Comment",{type:"PUT",url:"/comments/"+c+".json",data:a},b))},Comment.destroy=function(a,b,c){if(void 0===a)throw"Undefined Comment ID";$.ajax(Model.defaults("Deleting Comment",{type:"DELETE",url:"comments/"+a+".json",data:b},c))};var Course={};GT.Course=Course,GT.Course.lazyLearn=function(a,b,c,d,e,f,g,h,i){"use strict";$.ajax(Model.defaultsLoader("Loading Course Page",{url:"courses/lazy_learn",data:{user_id:a,mode:b,searchTerm:c,sort:d,offset:e,limit:f}},h,i,g))},GT.Course.lazyInstructs=function(a,b,c,d,e,f,g,h,i){"use strict";$.ajax(Model.defaultsLoader("Loading More Courses",{url:"courses/lazy_instructs",data:{user_id:a,mode:b,searchTerm:c,sort:d,offset:e,limit:f}},h,i,g))},GT.Course.lazyElectives=function(a,b,c,d,e,f){"use strict";$.ajax(Model.defaultsLoader("Loading Electives",{url:"courses/lazy_electives",data:{searchTerm:a,offset:b,limit:c}},e,f,d))},GT.Course.stats=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Getting Course Stats",{url:"courses/"+a+"/stats",data:{mode:b,user_id:c},dataType:"json"},d))},GT.Course.updateCreator=function(a,b,c,d){$.ajax(Model.defaults("Updating creator",{type:"PUT",url:"courses/"+c+"/update_creator",data:{creator_id:a,add_old_instructor:b}},d))},GT.Course.updateThumb=function(a,b,c){$.ajax(Model.defaults("Updating Thumbnail",{type:"PUT",url:"courses/"+b+"/update_thumbnail",data:{new_url:a}},c))},GT.Course.electiveTitle=function(a,b){$.ajax(Model.defaults("Getting Elective Info",{url:"courses/"+a+"/elective_title"},b))},GT.Course.autoAssigns=function(a,b){$.ajax(Model.defaultsLoader("Fetching Assignment Rules",{url:"courses/"+a+"/assignment_rules"},b))},GT.Course.createAutoAssign=function(a,b,c){$.ajax(Model.defaultsLoader("Creating Assignment Rule",{type:"POST",url:"courses/"+a+"/assignment_rules",data:{initial_scope_type:b}},c))},GT.Course.autoAssign=function(a,b){$.ajax(Model.defaultsLoader("Fetching Assignment Rule",{url:"auto_assignments/"+a},b))},GT.Course.get=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Loading Course",{url:"courses/"+a+".json",data:{user_course_id:b}},c,d))},GT.Course.userGroups=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Loading user groups",{url:"/courses/"+a+"/user_groups"},b,c))},GT.Course.allInstructorsCourses=function(a,b){
"use strict";$.ajax(Model.defaultsLoader("Loading Courses",{url:"/courses/all_instructors_courses"},a,b))},GT.Course.instructors=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Loading Courses",{url:"/courses/"+a+"/instructors"},b,c))},GT.Course.creator=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Loading Course Owner",{url:"/courses/"+a+"/creator"},b,c))},GT.Course.update=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Updating Courses",{type:"PUT",url:"courses/"+a.course.id,data:a},b,c))},GT.Course.tiles=function(a,b){"use strict";$.ajax(Model.defaults("Loading Tiles",{url:"courses/"+a+"/tiles"},b))},GT.Course.searchForTiles=function(a,b,c,d){"use strict";$.ajax(Model.defaults("Searching Tiles",{url:"courses/"+a+"/search_for_tiles",data:{search_term:c,user_course_id:b}},d))},GT.Course.addUsers=function(a,b,c,d){"use strict";$.ajax({type:"POST",url:"/courses/"+a+"/assign_users",data:JSON.stringify(b),contentType:"application/json; charset=utf-8",xhrFields:{onprogress:function(a){c(a)}},complete:function(a){d(a)}})},GT.Course.addElective=function(a,b){"use strict";$.ajax(Model.defaults("assigning elective",{type:"POST",url:"courses/"+a+"/assign_elective"},b))},GT.Course.newCourse=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Creating new Course",{type:"POST",url:"courses",data:a},b,c))},GT.Course.duplicate=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Duplicating Course",{type:"POST",url:"courses/"+a+"/duplicate/",data:{title:b}},c,d))},GT.Course.destroy=function(a,b){"use strict";$.ajax(Model.defaults("Checking Course Courses",{type:"DELETE",url:"courses/"+a},b))},GT.Course.star=function(a,b){"use strict";$.ajax(Model.defaults("Starring Course",{type:"POST",url:"courses/"+a+"/star"},b))},GT.Course.unstar=function(a,b){"use strict";$.ajax(Model.defaults("Unstarring Course",{type:"DELETE",url:"courses/"+a+"/unstar"},b))},GT.Course.joinCourse=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Joining Course",{type:"POST",url:"/courses/"+a+"/join"},b))},GT.CustomCategories={},GT.CustomCategories.categories=function(a,b){"use strict";$.ajax(Model.defaults("getting Custom Categories",{type:"GET",url:"custom_category_types/"+a+"/custom_categories"},b))},GT.Event={},GT.Event.fireEvent=function(a,b,c,d){$.ajax(Model.defaults("Firing Event",{type:"POST",url:"/api/events/fire_event",data:{event_name:a,tile_id:c,user_course_id:b}},d))},GT.Event.checkEvent=function(a,b){$.ajax(Model.defaults("Checking Event",{type:"GET",url:"/api/events/check_event",data:{event_name:a}},b))},GT.Filters={},GT.Filters.saveFilters=function(a,b){"use strict";$.ajax(Model.defaults("Saving Filters",{type:"POST",url:"filters",data:a,dataType:"json"},b))},GT.Filters.create=function(a,b,c,d,e,f){"use strict";$.ajax(Model.defaults("Creating Filter",{type:"POST",url:"filters",data:{course_id:a,type:c,value:d,view:b,custom_category_type_id:e,filterable_type:b,filterable_id:a}},f))},GT.Filters.update=function(a,b,c,d,e){"use strict";$.ajax(Model.defaults("Saving Filter",{type:"PUT",url:"filters/"+a,data:{type:b,value:c,custom_category_type_id:d}},e))},GT.Filters.filterableCustomCategories=function(a,b){"use strict";$.ajax(Model.defaults("getting CustomCategories",{type:"GET",url:"custom_category_types/filterable",data:{course_id:b}},a))},GT.Filters.customCategories=function(a){"use strict";$.ajax(Model.defaults("getting Restricted Custom Categories",{type:"GET",url:"custom_category_types"},a))},GT.Filters.destroy=function(a,b){"use strict";$.ajax(Model.defaults("Deleting Filter",{type:"DELETE",url:"filters/"+a},b))},GT.Filters.loadFilters=function(a,b,c){"use strict";$.ajax(Model.defaults("Loading Filters",{url:"filters",data:{context_id:a,context_type:b}},c))},GT.Filters.hasFilters=function(a,b){"use strict";$.ajax(Model.defaults("Checking for Filters",{type:"GET",url:"filters/has_filters",data:{course_id:a}},b))},GT.List={},GT.List.all=function(a,b,c,d,e){"use strict";var f={};a&&(f.query=a),b&&(f.user_id=b),f.offset=c,f.limit=d,$.ajax(Model.defaultsLoader("Loading Lists",{url:"/lists",data:f},e))},GT.List.create=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Creating List",{type:"POST",url:"/lists",data:{list:{title:a},users:b}},c))},GT.List.exists=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Checking name",{type:"GET",url:"/lists/exists",data:{list_name:a}},b))},GT.List.updateTitle=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Updating List Title",{type:"PUT",url:"/lists/"+a,data:{list:{id:a,title:b}}},c))},GT.List.get=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Loading Lists",{url:"/lists/"+a},b))},GT.List.addUsers=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Adding Users to List",{type:"PUT",url:"/lists/"+a+"/add_users",data:{users:b}},c))},GT.List.removeUser=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Removing User",{type:"DELETE",url:"/lists/"+a+"/remove_user",data:{user_id:b}},c))},GT.List.destroy=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Removing List",{type:"DELETE",url:"/lists/"+a},b))},Model.defaults=function(a,b,c,d){var e={type:"GET",beforeSend:function(a){var b=$("meta[name='csrf-token']").attr("content");a.setRequestHeader("X-CSRF-Token",b)},success:function(a){c&&c(a)},error:function(d,e,f){if(401===d.status)document.location="/";else if(404===d.status)c&&c();else if(""!==a&&200!==d.status){GT.Notification.showError("Error: "+a);var g,h,i=window.account;i.user_id=i.id,b.type=b.type||"GET",g=b.url.split("/"),h=g[g.length-1],Honeybadger.notify(f,{message:a,name:b.type+" "+h+" Returned: "+d.status,action:"XHR Request to "+b.url,context:i,fingerprint:d.status+":"+h+":"+b.type,projectRoot:window.location.origin,params:b.data})}},dataType:"json",async:d};for(var f in b)e[f]=b[f];return e},Model.defaultsLoader=function(a,b,c,d,e){"undefined"==typeof e&&(e=3e3);var f=new Loader(e,a,d),g={type:"GET",beforeSend:function(a){var b=$("meta[name='csrf-token']").attr("content");a.setRequestHeader("X-CSRF-Token",b)},success:function(a){f.stop(),c&&c(a)},error:function(d,e,g){if(401===d.status)document.location="/";else if(404===d.status)f.stop(),c&&c();else if(!death&&200!==d.status){f.showError(e+": "+g,d.status);var h,i,j=window.account;j.user_id=j.id,b.type=b.type||"GET",h=b.url.split("/"),i=h[h.length-1],Honeybadger.notify(g,{message:a,name:b.type+" "+i+" Returned: "+d.status,action:"XHR Request to "+b.url,context:j,fingerprint:d.status+":"+i+":"+b.type,projectRoot:window.location.origin,params:b.data})}},dataType:"json"};for(var h in b)g[h]=b[h];return g},GT.Organization={},GT.Organization.tags=function(a){$.ajax(Model.defaults("Loading Tags",{url:"organization/tags"},a))},GT.Organization.redeem=function(a,b){$.ajax(Model.defaultsLoader("Creating Organization",{type:"POST",url:"organization_creation_request/redeem",data:{organization_create_request:a}},b))},GT.Organization.getOrganizationData=function(a,b){$.ajax(Model.defaults("Loading Data",{url:"organization/statistics"},b))},GT.Quiz={},GT.Quiz.getQuiz=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Loading Quiz",{url:"quiz_questions",data:{attempt_id:a,tile_id:b,user_course_id:c}},d))},GT.Quiz.getResults=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Loading Results",{url:"quiz_questions/results",data:{tile_id:a,user_course_id:b,best_attempt:c}},d))},GT.Quiz.setMinQuizScore=function(a,b){"use strict";$.ajax(Model.defaults("Setting Minimum Score",{type:"POST",url:"quiz_questions/"+a.tileId+"/min_score",data:{min_score:a.minScore}},b))},GT.Quiz.setAttemptLimit=function(a,b){"use strict";$.ajax(Model.defaults("Setting Attempt Limit",{type:"POST",url:"quiz_questions/"+a.tileId+"/set_attempt_limit",data:{attempt_limit:a.attempt_limit}},b))},GT.Quiz.recordResponse=function(a,b,c,d,e,f){"use strict";$.ajax(Model.defaultsLoader("Saving Response",{type:"POST",url:"quiz_responses",data:{tile_id:a,quiz_answer_id:b,video_url:c,attempt_id:e,user_course_id:d}},f))},GT.Quiz.recordSparkResponse=function(a,b,c,d,e,f){"use strict";$.ajax(Model.defaultsLoader("Saving Response",{type:"POST",url:"spark_responses",data:{tile_id:a,quiz_question_id:b,video_url:c,attempt_id:e,user_course_id:d}},f))},GT.Quiz.setSparkFeedback=function(a,b,c){$.ajax(Model.defaultsLoader("Saving Feedback",{type:"PUT",url:"spark_responses/"+a+"/set_feedback",data:b},c))},GT.Quiz.deleteQuizQuestion=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Deleting Question",{type:"DELETE",url:"quiz_questions/"+a},b))},GT.Quiz.newQuizQuestion=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Creating Quiz Question",{type:"POST",url:"quiz_questions",data:a},b))},GT.Quiz.saveQuizQuestion=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Saving Quiz Question",{type:"PUT",url:"quiz_questions/"+a.id,data:{quiz_question:a}},b))},GT.Quiz.sortQuestions=function(a,b){$.ajax(Model.defaults("Sorting Topics",{type:"POST",url:"quiz_questions/sort_questions",data:a},b))},GT.Quiz.newQuizAnswer=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Creating Answer",{type:"POST",url:"quiz_answers",data:a},b))},GT.Quiz.saveQuizAnswer=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Saving Answer",{type:"PUT",url:"quiz_answers/"+a.id,data:{quiz_answer:a}},b))},GT.Quiz.deleteQuizAnswer=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Deleting Answer",{type:"DELETE",url:"quiz_answers/"+a},b))},GT.Quiz.setCorrect=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Grading Response",{type:"POST",data:{score:b},url:"spark_responses/"+a+"/set_correct"},c))},GT.Quiz.attemptsInProgress=function(a,b){"use strict";$.ajax(Model.defaults("Attempts In Progress",{type:"GET",data:{tile_id:a},url:"quiz_questions/attempts_in_progress"},b))},GT.Quiz.beginAttempt=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Starting Quiz",{type:"POST",data:{user_course_id:a,tile_id:b},url:"quiz_questions/begin_attempt"},c))},GT.Quiz.unfinishedAttempt=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Checking Previous Attempts",{data:{user_course_id:a,tile_id:b},url:"quiz_questions/unfinished_attempt"},c))};var Support={};Support.createTicket=function(a,b){var c;c={name:a[0],email:a[1],message:a[2]},a[3]&&(c.support_email_id=a[3]),$.ajax(Model.defaults("Creating Support Ticket",{type:"POST",url:"support",data:c},b))},GT.Topic={},GT.Topic.updateTitle=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Updating Topic",{type:"PUT",url:"topics/update_title",data:a},b))},GT.Topic.updateDescription=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Updating Topic",{type:"PUT",url:"topics/update_description",data:a},b))},GT.Topic.sort=function(a){"use strict";$.ajax(Model.defaults("Sorting Topics",{type:"POST",url:"topics/sort",data:a}))},GT.Topic.create=function(a,b){"use strict";var c={id:a.course_id,topic:a};$.ajax(Model.defaultsLoader("Creating New Topic",{type:"POST",url:"topics",data:c},b))},GT.Topic.destroy=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Deleting Topic ",{type:"DELETE",url:"topics/"+a},b))},GT.Topic.get=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Fetching Topic ",{url:"topics/"+a+".json"},b))},GT.Topic.tiles=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Loading Tiles",{url:"topics/"+a+"/tiles",data:{user_course_id:b}},c))},GT.Topic.index=function(a,b,c,d){"use strict";$.ajax(Model.defaults("Getting Topics",{url:"topics",data:{course_id:a,course_user_role:b,user_course_id:c}},d))},GT.Topic.move=function(a,b,c){"use strict";$.ajax(Model.defaults("Moving Topic",{type:"POST",url:"topics/"+a+"/move/",data:{new_position:b}},c))},GT.Topic.moveTopicList=function(a,b,c){"use strict";$.ajax(Model.defaults("Moving Topic List",{type:"POST",url:"topics/"+a+"/move_topic_list/",data:b},c))};var User={};GT.User=User,User.checkLogin=function(a,b,c,d){"use strict";$.ajax(Model.defaults("logging In",{type:"POST",url:"login/signin.json",data:{email:a,password:b,organization_id:c}},d))},GT.User.get=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Getting User",{url:"users/"+a},b))},GT.User.getByUserCourse=function(a,b,c,d){$.ajax(Model.defaults("User by userCourseId",{url:"users/verify_user_course",data:{user_course_id:a,course_id:b,role:c}},d))},GT.User.create=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Creating User",{type:"POST",url:"users",data:{user:a}},b))},GT.User.listImport=function(a,b,c){"use strict";$.ajax({type:"post",url:"users/list_import",data:{user_list:a},dataType:"json",xhrFields:{onprogress:function(c){var d=b(c);d.status&&(a.list_ids=d.list_ids)}},complete:function(b){$.ajax({type:"post",url:"users/import_update",data:{user_list:a},dataType:"json",xhrFields:{onprogress:function(a){c(a)}}})}})},GT.User.checkDupesImport=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Checking Users in File",{type:"POST",url:"users/check_dupes",data:{user_list:a}},b))},GT.User.update=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Updating User",{type:"PUT",url:"users/"+a.id,data:{user:a}},b))},GT.User.updateCategegory=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Updating Category",{type:"PUT",url:"users/"+b+"/update_category",data:{category:a}},c))},GT.User.lazyPeople=function(a,b,c,d,e,f,g){"use strict";$.ajax(Model.defaultsLoader("Updating User",{type:"Get",url:"users/lazy_people",data:{user_id:a,mode:b,offset:c,limit:d,type:e,order:f}},g))},GT.User.query=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Getting Users",{url:"users/query",data:a},b))},GT.User.lazyQuery=function(a,b,c,d,e,f){"use strict";$.ajax(Model.defaultsLoader("Getting Users",{url:"users/lazy_query",data:{query:a,limit:b,offset:c,type:d,order:e}},f))},GT.User.assigningCheck=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Getting Users",{url:"users/assigner_check",data:a},b))},GT.User.rosterFilter=function(a,b,c,d){"use strict";$.ajax(Model.defaultsLoader("Getting Users",{url:"users/roster_filter",data:{course_id:a.courseId,tile_id:a.tileId,user_id:a.userId,mode:b,page:c,sort_type:a.sortType,sort_order:a.sortOrder},dataType:"json"},d))},GT.User.loadSelectTwoFilter=function(a,b){"use strict";$.ajax(Model.defaults("Getting Filtered Users",{url:"users/load_select2_filter",data:a},b))},GT.User.reports=function(a){"use strict";$.ajax(Model.defaultsLoader("Getting Reports",{url:"users/reports"},a))},User.logout=function(a){"use strict";$.ajax(Model.defaults("Logging Out",{type:"POST",url:"login/logout.json"},a))},GT.User.forgotPassword=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Submitting Password Recovery",{type:"POST",url:"/users/forgot",data:{email:a,organization_id:b}},c))},User.checkSecondFrameInstructor=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Validating Signup",{type:"POST",url:"/instructor/check_signup",data:{user:a}},b))},User.checkFirstFrameStudent=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Validating Signup",{type:"POST",url:"/student/check_first_frame",data:{student:a}},b))},User.checkSecondFrameStudent=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Validating Signup",{type:"POST",url:"/student/check_second_frame",data:{student:a}},b))},User.loggedIn=function(a){"use strict";$.ajax(Model.defaultsLoader("Checking Session",{url:"/login/show.json"},a,!0))},GT.User.activated=function(a,b){"use strict";$.ajax(Model.defaults("Checking if Activated",{url:"/users/activated",data:{email:a}},b,!0))},GT.User.accountInfo=function(a){"use strict";$.ajax(Model.defaultsLoader("Loading Account Info",{url:"/users/info"},a))},User.updateAccountInfo=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Saving Account Info",{type:"POST",url:"/users/update_account",data:a},b))},User.updateAccountTerms=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Saving Account Info",{type:"POST",url:"/users/update_terms",data:a},b))},User.updatePassword=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Updating Password",{type:"POST",url:"/users/update_password",data:a},b))},User.checkResetToken=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Checking Reset Token",{type:"GET",url:"users/check_reset_token",data:{token:a}},b))},User.passResetToken=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Submitting Password Recovery",{type:"POST",url:"/users/pass_reset_token",data:{email:a,organization_id:organizationId}},b))},User.tokenPassReset=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Resetting Password",{type:"POST",url:"users/token_pass_reset",data:a},b))},User.resetPassword=function(a,b,c){"use strict";$.ajax(Model.defaultsLoader("Sending Password Reset",{type:"POST",url:"users/"+a+"/reset_password",data:{new_password:b}},c))},User.setDeleted=function(a,b){"use strict";$.ajax(Model.defaults("deleting user",{type:"DELETE",url:"users/"+a},b))},GT.User.allAssociations=function(a,b){"use strict";$.ajax(Model.defaults("Getting Peers",{url:"/users/associations",data:{scopes:a}},b))},GT.User.lists=function(a,b){"use strict";$.ajax(Model.defaults("Getting Lists",{url:"/users/"+a+"/lists"},b))},GT.User.addToList=function(a,b,c){"use strict";$.ajax(Model.defaults("Saving to List",{url:"/users/"+a+"/add_to_list",type:"POST",data:{list_id:b}},c))},GT.User.removeFromList=function(a,b,c){"use strict";$.ajax(Model.defaults("Removing from List",{url:"/users/"+a+"/remove_from_list",type:"DELETE",data:{list_id:b}},c))},User.resultData=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Getting Result Data",{url:"/users/result_data",data:{tile_id:a.tileId,user_course_id:a.userCourseId,best_attempt:a.bestAttempt}},b))},User.assignmentData=function(a,b){"use strict";$.ajax(Model.defaults("Getting Assignment Data",{url:"users/assignment_data",data:a},b))},User.gradeAssignmentSubmission=function(a,b){"use strict";$.ajax(Model.defaults("Saving Score",{url:"users/save_assignment_score",type:"POST",data:a},b))},User.limitSubmissions=function(a,b,c,d){"use strict";$.ajax(Model.defaults("Limiting Submissions",{url:"users/limit_submissions",type:"POST",data:{user_course_id:a,tile_id:b,no_submissions:c}},d))},GT.UserCourse={},GT.UserCourse.getUserCourse=function(a,b){"use strict";if(void 0===a.user_course_id)throw"Undefined User Course ID";$.ajax(Model.defaultsLoader("Loading Group",{url:"/courses/user_course",data:a},b))},GT.UserCourse.getWithUsers=function(a,b){"use strict";if(void 0===a)throw"Undefined Group ID";$.ajax(Model.defaultsLoader("Loading Group",{url:"/user_courses/with_users.json",data:{course_id:a}},b))},GT.UserCourse.course=function(a,b){"use strict";if(void 0===a)throw"Undefined Group ID";$.ajax(Model.defaultsLoader("Loading Group",{url:"/courses/"+a+"/course"},b))},GT.UserCourse.assignCourse=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Updating Group",{type:"PUT",url:"/courses/"+a.id+"/assign_course",data:a},b))},GT.UserCourse.get=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Fetching User Assignment",{url:"/user_courses/"+a},b))},GT.UserCourse.dropUser=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Removing User",{type:"DELETE",url:"/user_courses/"+a},b))},GT.UserCourse.updatePermissions=function(a,b,c){"use strict";b.categories=JSON.stringify(b.categories),$.ajax(Model.defaults("Updating Instructor",{type:"PUT",url:"user_courses/"+a+"/update_permissions",data:b},c))},GT.UserCourse.updateAll=function(a,b,c,d,e,f){"use strict";$.ajax(Model.defaults("Updating Assignments",{type:"PUT",url:"user_courses/update_all",data:{user_id:d,mode:c,course_id:a,user_course_ids:b,user_course:e}},f))},GT.UserCourse.getUngradedData=function(a,b,c){"use strict";$.ajax(Model.defaults("Loading Ungrading Data",{url:"user_courses/"+a+"/get_ungraded_data",data:{tile_id:b}},c))},GT.UserCourse.get_by_hash=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Loading Group",{url:"/courses/course_by_hash",data:a},b))},GT.UserCourse.getOrganizationByGroupUuid=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Loading Group",{url:"/courses/get_organization_by_course_uuid",data:{uuid:a}},b))},GT.UserCourse.getOrganizationByUuid=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Loading Group",{url:"/user_courses/get_organization_by_uuid",data:{uuid:a}},b))},GT.UserCourse.studentsCompletion=function(a,b){"use strict";$.ajax(Model.defaults("Student's progress",{url:"/user_courses/completion",data:{user_course_id:a}},b))},GT.UserCourse.learnersCourseInfo=function(a,b,c){"use strict";$.ajax(Model.defaults("Getting Learner's Course Info",{url:"user_courses/"+a+"/learners_course_info",data:{course_id:b}},c))},GT.UserCourse.star=function(a,b){"use strict";$.ajax(Model.defaults("Starring Group",{type:"POST",url:"user_courses/star",data:{user_course_id:a}},b))},GT.UserCourse.unstar=function(a,b){"use strict";$.ajax(Model.defaults("Unstarring Group",{type:"DELETE",url:"user_courses/unstar",data:{user_course_id:a}},b))},GT.UserCourse.getInstructorUserCourse=function(a,b){"use strict";$.ajax(Model.defaultsLoader("Fetching Instructor Membership",{url:"user_courses/instructor_user_course",data:{course_id:a}},b))},GT.Notification={},GT.Notification.show=function(a,b,c){b||(b=5e3),c||(c=""),iziToast.success({title:c,message:a,timeout:b,transitionIn:"bounceInUp"})},GT.Notification.showError=function(a,b,c){b||(b=1e4),c||(c=""),iziToast.error({title:c,message:a,timeout:b,position:"topCenter",transitionIn:"flipInX"})},GT.Notification.warning=function(a,b,c,d){b||(b=!1),d||(d=""),iziToast.warning({title:d,message:a,timeout:b,position:"topCenter",transitionIn:"flipInX",close:!1,target:c,targetFirst:!1})},GT.Notification.info=function(a,b,c,d){b||(b=!1),d||(d=""),iziToast.info({title:d,message:a,timeout:b,position:"topCenter",transitionIn:"flipInX",close:!1,target:c,targetFirst:!1})},GT.Notification.showErrorList=function(a,b,c){if(!(a&&a instanceof Array))throw"showErrorList requires an array of errors";b||(b=3),c||(c=4e3);for(var d=0;d<a.length&&d<b;d++)this.showError(a[d],c)};var PeoplePicker={};PeoplePicker.tagsOnly=function(a,b){"use strict";var c,d=document.createElement("select");a.append?a.attachTo.append(d):a.attachTo.prepend(d),c=document.createAttribute("multiple"),c.value="multiple",d.setAttributeNode(c),b(d,function(){$(d).select2(a)})},GT.Tile.wrapTile=function(a,b,c){"use strict";var d=Object.create(GT.Tile[a.type.toLowerCase()]);return d.init(),d.tile=a,d.course=c,d.userCourseId=b,d},GT.Tile.tile=function(){"use strict";var a={};return a.init=function(){},a.activity=function(){this.resetTimeout()},a.makePlaceholder=function(){var a,b=document.createDocumentFragment();return a={tile:this.tile,courseId:this.course.id,userCourseId:this.userCourseId},$(b).append(JST["app/templates/reader_view/unavailable-tile-placeholder.us"](a)),b},a.resetTimeout=function(){this.timeout&&this.timeout.clearTimeout(),this.tile&&this.tile.timeout&&(this.timeout=setTimeout(function(){window.location.href="/"},1e3*this.tile.timeout*60))},a.openResultsHaveMoved=function(){var a;a=new LightBox({id:"results-moved",closeButton:!0,closeable:!0});var b=document.createDocumentFragment();$(b).append(JST["app/templates/reader_view/results_moved.us"]({course:this.course,tile:this.tile})),a.open(b.querySelector("div"))},a.getCreator=function(){throw new Error("no Creator implemented")},a.makeReader=function(){throw new Error("no reader implemented")},a.getReader=function(a){if("Instructor"!==this.course.user_role&&"ReadOnlyInstructor"!==this.course.user_role||!this.tile.prerequisite_id&&!this.tile.hidden)return this.tile.hidden||!this.tile.available?this.makePlaceholder():(this.resetTimeout(),this.makeReader(a));var b,c=document.createDocumentFragment();return this.tile.hidden?$(c).append(JST["app/templates/reader_view/hidden-instructors-placeholder.us"]()):this.tile.prerequisite_id&&$(c).append(JST["app/templates/reader_view/unavailable-instructors-placeholder.us"]()),b=c.querySelector("#js-book-placeholder-readerview"),c.querySelector("#js-instructors-placeholder").onclick=function(){$(b).remove()},this.resetTimeout(),c.appendChild(this.makeReader(a)),c},a.getEditor=function(a){var b,c,d=this;return b=document.createDocumentFragment(),$(b).append(JST["app/templates/tile_view/replace-tile.us"]()),c=b.querySelector("#replace-button"),c.onclick=function(){GT.FPWrapper.openUploadPrompt(function(a){GT.Tile.replace(d.tile.id,a.url,function(){GT.Tile.process(d.tile.id,function(a){console.log(a)})})},!1,void 0,[d.tile.type])},"Scormclip"===this.tile.type?b.querySelector("div"):a.appendChild(b.querySelector("div"))},a.makeIFrame=function(a){var b,c=document.createElement("iframe"),d=this;return c.type="text/html",c.frameborder="0",a&&(c.src=a),$(c).attr("frameborder","0"),b=function(){return d.tile.title+" would like to redirect you. Stay on this page to remain in Skillo"},window.addEventListener("beforeunload",b),setTimeout(function(){window.removeEventListener("beforeunload",b)},1e3),c},a.getTextBlock=function(a){var b=document.createDocumentFragment(),c=document.createElement("span");return c.className="tile-item-textblock",this.tile.textblock&&this.tile.textblock.length>0?(c.appendChild(document.createTextNode(this.tile.textblock.substring(0,40))),b.appendChild(c)):"Webclip"!==this.tile.type&&"Video"!==this.tile.type||!a||(c.appendChild(document.createTextNode(a.substring(0,40))),b.appendChild(c)),b},a.thumbnail=function(a){this.tile.thumbnail&&(a.src=this.tile.thumbnail)},a.getCsvLink=function(a){return"/tiles/"+this.tile.id+"/get_csv.csv?course_id="+this.course.id+"&mode="+a},a.getPreview=function(a){var b=document.createDocumentFragment();return this.thumbnail(a),b.appendChild(a),b},a.destroy=function(a){a&&a()},a}(),GT.Tile.document=function(){"use strict";var a;return a=Object.create(GT.Tile.tile),a.init=function(){GT.Tile.tile.init.apply(this,arguments)},a.makeReader=function(a){this.activity&&this.activity();var b,c,d,e,f,g;if(this.tile.url&&!this.tile.use_google)c=document.createDocumentFragment(),f="localhost"===document.location.hostname?"beta.myskillo.com":document.location.hostname,e="https://"+f+"/filestack-viewer.css",d=this.tile.url.split("/"),g=d.pop(),d.push('preview=css:"'+e+'"'),d.push(g),b=d.join("/"),c.appendChild(this.makeIFrame(b));else{c=document.createElement("div");var h=document.createElement("div");h.className="iframe-size-wrapper";var i=document.createElement("iframe");i.src="https://docs.google.com/viewer?url="+encodeURIComponent(this.tile.url)+"&embedded=true",i.style.border="none",h.appendChild(i),c.appendChild(h)}return c},a.getPreview=function(a){var b=document.createDocumentFragment();return this.thumbnail(a),b.appendChild(a),b},a}(),GT.Tile.image=function(){"use strict";var a;return a=Object.create(GT.Tile.tile),a.init=function(){GT.Tile.tile.init.apply(this,arguments)},a.makeReader=function(){var a,b;this.activity&&this.activity();var c=document.createDocumentFragment();this.tile.transcription||(this.tile.transcription=""),$(c).append(JST["app/templates/reader_view/reader-view-tile.us"](this.tile));var d=$(c).find("img").get(0),e=Math.round(.65*$(window).width()),f=Math.round(.59*$(window).height());return d&&(a=this.tile.url.split("/"),b=a.pop(),a.push("resize=width:"+e+",height:"+f+",fit:clip"),a.push(b),d.style.backgroundImage="url("+a.join("/")+")",d.title=this.tile.title,d.alt=this.tile.transcription),c},a}(),GT.Tile.sound=function(){"use strict";var a;return a=Object.create(GT.Tile.tile),a.init=function(){GT.Tile.tile.init.apply(this,arguments)},a.makeReader=function(){this.activity&&this.activity();var a=document.createDocumentFragment();return this.tile.transcription||(this.tile.transcription=""),$(a).append(JST["app/templates/reader_view/audio.us"](this.tile)),a},a}(),GT.Tile.webclip=function(){"use strict";var a;return a=Object.create(GT.Tile.tile),a.init=function(){GT.Tile.tile.init.apply(this,arguments)},a.makeReader=function(){this.activity&&this.activity();var a,b,c=this,d=document.createDocumentFragment();if(a=GT.YouTube.getVideoIdFromURL(c.tile.url),a!==!1)b=GT.YouTube.getEmbedCode(a),$(d).append(b);else if(c.tile.url.indexOf("vimeo")!==-1){var e=document.createElement("div");e.className="vimeo-player-container",new Vimeo.Player(e,{id:c.tile.url}),d.appendChild(e)}else c.tile.url&&(c.tile.iframe_compatible&&c.tile.https_compatible?d.appendChild(c.makeIFrame(c.tile.url)):$(d).append(JST["app/templates/reader_view/webclip-placeholder.us"](this.tile)));return d},a.thumbnail=function(a){var b;this.tile.thumbnail?GT.Tile.tile.thumbnail.apply(this,arguments):(b=GT.YouTube.getVideoIdFromURL(this.tile.url),b!==!1&&(a.src=GT.YouTube.thumbnail(b)))},a.getEditor=function(a){var b=this,c=Handlebars.partials.edit_url(),d=a.parentElement.querySelector("#tile-input-container").parentElement;$(d).append(c);var e=d.querySelector("#tile-edit-url");e.value=this.tile.url,e.onchange=function(a){var c=e.value;""!==c?("http://"!==c.slice(0,7)&&"https://"!==c.slice(0,8)?c="https://"+c:"http://"===c.slice(0,7)&&(c=c.slice(0,4)+"s"+c.slice(4,c.length)),GT.Tile.update({id:b.tile.id,url:c},function(a){a.success?(GT.Notification.show("Updated URL saved."),e.value=c):GT.Notification.showErrors(a.errors)})):GT.Notification.showError("Please Enter a URL")},a.parentNode.removeChild(a)},a}(),GT.Tile.scormclip=function(){"use strict";var a,b,c;return a=Object.create(GT.Tile.webclip),a.init=function(){GT.Tile.webclip.init.apply(this,arguments)},a.getCsvLink=function(a){return"/tiles/"+this.tile.id+"/scorm_csv.csv?course_id="+this.course.id+"&simple=true&mode="+a},a.getResult=function(a,b){var c,d,e,f,g=document.createElement("section"),h=this,i=document.createDocumentFragment(),j={tileId:h.tile.id,userCourseId:a.id};return GT.User.resultData(j,function(j){j||(j={}),j.userCourse=a,$(i).append(JST["app/templates/results_viewer/scorm_results.us"](j)),e=i.querySelector("#scorm-results"),d=i.querySelector("#download-student-button"),c=i.querySelector(".reset-scorm"),f=i.querySelector("#no-interactions"),d.onclick=function(){window.location.href="/tiles/"+h.tile.id+"/scorm_csv.csv?user_course_id="+a.id},c.onclick=function(){GT.Tile.resetScormOrQuiz(void 0,void 0,a.id,h.tile.id),a.tile_passed=!1,a.tile_completed=!1,a.tile_score=null,a.tile_status_datum.passed=a.tile_passed,a.tile_status_datum.completed=a.tile_completed,a.tile_status_datum.score=a.tile_score,b(a),$(e).empty(),$(f).empty(),$(i).append("<p>Results have been reset</p>"),f.appendChild(i)},g.appendChild(i)}),g},a.makeReader=function(){this.activity&&this.activity();var a=this,d=!1,e=document.createDocumentFragment();return void 0===a.tile.status||null===a.tile.status||"processing"===a.tile.status||"reprocess"===a.tile.status?($(e).append(JST["app/templates/reader_view/scorm-placeholder.us"](a.tile)),void 0!==a.tile.status&&null!==a.tile.status||GT.Tile.process(a.tile.id,function(a){console.log(a)})):"error"===a.tile.status?$(e).append(JST["app/templates/reader_view/scorm-failure.us"]({tile:a.tile,course:a.course})):(this.tile.completed&&this.tile.review_mode&&(d=!0),c=a.makeIFrame(),b=new ScormEngine(this.tile,this.userCourseId,d,c),b.activity=function(){a.activity()},b.init(e),c.setAttribute("allow","fullscreen"),e.appendChild(c),c.src=a.tile.secure_url),e},a.getEditor=function(){var a,b,c,d,e,f,g=this;a=GT.Tile.tile.getEditor.apply(this,arguments),$(a).append(JST["app/templates/tile_view/scorm-hacks.us"](this.tile)),b=a.querySelector("#js-score-override"),d=a.querySelector("#score-override-value"),e=a.querySelector("#js-review-mode-button"),c=a.querySelector("#js-score-only-improve"),b.onchange=function(a){var c;d.disabled=!a.target.checked,b.checked||(c={},c.min_score=null,c.id=g.tile.id,GT.Tile.update(c,function(a){a.success?g.tile.min_score=void 0:GT.Notification.showErrorList(a.errors,4e3)}))},f=function(){var a;a={scorm_score_can_only_improve:c.checked,review_mode:e.checked,id:g.tile.id},GT.Tile.update(a,function(a){a.success?g.tile.review_mode=e.checked:GT.Notification.showErrorList(a.errors,4e3)})},c.onchange=f,e.onchange=f,d.onchange=function(a){var b,c;isNaN(Number(a.target.value))?(GT.Notification.showError("Please enter a Number."),
d.value=g.tile.min_score):(c=Number(a.target.value),g.tile.min_score=c,b={min_score:g.tile.min_score,id:g.tile.id},GT.Tile.update(b,function(a){a.success||GT.Notification.showErrorList(a.errors,4e3)}))},arguments[0].appendChild(a)},a.destory=function(a){c&&c.src&&(c.src="about:blank"),b.destroy(a)},a}(),GT.Tile.video=function(){"use strict";var a;return a=Object.create(GT.Tile.webclip),a.init=function(){GT.Tile.webclip.init.apply(this,arguments)},a.makeReader=function(){this.activity&&this.activity();var a;a=this;var b=document.createDocumentFragment();$(b).append(JST["app/templates/reader_view/video.us"](this.tile));var c=b.querySelector("video");return videojs(c,{controls:!0,autoplay:!1,preload:"auto"},function(){var b=!0;this.on("timeupdate",function(){this.currentTime()/this.duration()>.75&&b&&(GT.Tile.completed(a.tile.id,a.userCourseId),b=!1)})}),b},a.getEditor=function(){var a;a=GT.Tile.tile.getEditor.apply(this,arguments),$(a).append(JST["app/templates/tileedit_view/video_info.us"](this.tile))},a}(),GT.Tile.recording=function(){"use strict";var a;return a=Object.create(GT.Tile.video),a.init=function(){GT.Tile.webclip.init.apply(this,arguments)},a.makeReader=function(){this.activity&&this.activity();var a;a=this;var b=document.createDocumentFragment();this.tile.transcription||(this.tile.transcription=""),$(b).append(JST["app/templates/reader_view/video.us"](this.tile));var c=b.querySelector("video");return c.addEventListener("ended",function(){GT.Tile.completed(a.tile.id,a.userCourseId)}),videojs(c,{controls:!0,autoplay:!1,preload:"auto"},function(){}),b},a}(),GT.Tile.assignment=function(){"use strict";var a=Object.create(GT.Tile.tile);return a.getEditor=function(a){var b;b=new AssignmentEditor(this.tile),a.appendChild(b.contentContainer)},a.getDescription=function(){console.log("in it")},a.getResult=function(a,b){function c(a){return a%1===0}var d,e,f=this,g={tile_id:this.tile.id,user_course_id:a.id};e=document.createDocumentFragment(),$(e).append(JST["app/templates/reader_view/assignment-results.us"]({first_name:a.user.first_name,min_score:f.tile.min_score,pass_fail:f.tile.pass_fail})),d=e.querySelector("div"),f.instructorResponse=!0,f.makeReader(function(e,h){function i(a){f.tile.pass_fail?q.innerText=100==a?"Passed":"Failed":a>=f.tile.min_score?q.innerText=a+"% (Passed)":q.innerText=a+"%"}function j(b){var d=!0;h.latest_learner_resp_id&&(g.response_id=h.latest_learner_resp_id),f.tile.pass_fail?"pass"===b.target.value?g.score=100:g.score=0:!isNaN(Number(o.value))&&Number(o.value)<=100&&c(Number(o.value))?g.score=o.value:(GT.Notification.showError("Score must be a whole number between 0 and 100."),d=!1),d&&GT.User.gradeAssignmentSubmission(g,function(){var b,c;GT.Notification.show("Score Updated"),i(g.score),a.tile_passed=o.value>=f.tile.min_score||"pass"===o.value,a.tile_completed=!0,a.tile_score=g.score,a.tile_status_datum.passed=a.tile_passed,a.tile_status_datum.completed=a.tile_completed,a.tile_status_datum.score=a.tile_score,a.ungraded=!1,b=document.querySelector("#js-ar-"+h.latest_learner_resp_id).querySelector(".score-update"),c=document.createElement("strong"),a.tile_passed?(c.innerText=f.tile.pass_fail?"Pass":g.score,c.classList.add("passing-score")):(c.innerText=f.tile.pass_fail?"Fail":g.score,c.classList.add("failing-score")),b.innerHTML="",b.appendChild(c),GT.UserCourse.getUngradedData(a.id,f.tile.id,function(a){k(a)})})}function k(a){if(a.topic_ungraded_count&&a.topic_ungraded_count>0)if(l)l.innerText=a.topic_ungraded_count;else{l=document.querySelector("#topic_"+tile.topic_id);var b=document.createElement("span");b.classList.add("count"),b.innerText=a.topic_ungraded_count,l.appendChild(b)}else l&&l.parentNode.removeChild(l);a.tile_ungraded_bool?m||(m=document.querySelectorAll(".tile-nav a")[1],m.classList.add("ungraded")):m&&m.classList.remove("ungraded")}if(d.appendChild(e),h.submitted){var l=document.querySelector("#topic_"+f.tile.topic_id+" .count"),m=document.querySelector("a.ungraded"),n=d.querySelectorAll("input[name=allow]"),o=d.querySelector(".score-input"),p=d.querySelector(".score-assignment"),q=d.querySelector("h2.score"),r=d.querySelectorAll("input[name=pass-fail]");(h.latest_score||0==h.latest_score)&&(f.tile.pass_fail?100==h.latest_score?r[0].checked=!0:r[1].checked=!0:o.value=h.latest_score,i(h.latest_score)),p?p.onclick=j:(r[0].onclick=j,r[1].onclick=j);for(var s=0;s<n.length;s++)n[s].onchange=function(b){var c;c="yes"!==b.target.value,GT.User.limitSubmissions(a.id,f.tile.id,c)};h.no_submissions?n[1].checked=!0:n[0].checked=!0}b(d)}),$(".assignment-upload-button").on("click",function(a){data.forEach(function(b){b.id===Number(a.target.value)&&(window.location=b.url)})})},a.makeReader=function(a){function b(a){var b=a.target.closest("section").querySelector("#response-contents-container");o.no_submissions||GT.FPWrapper.recordVideo(function(a){var c;c=a[0].filename.replace(/\.[^\/.]+$/,""),t.uploads||(t.uploads=[]),t.uploads.push({url:a[0].url,file_name:c,file_type:"Video",hash:a[0].url.split("/").pop()}),d(a[0],function(){$(b).append(Handlebars.partials.assignment_video({url:a[0].url})),b.querySelector("#delete-preview").onclick=f})})}function c(a){o.no_submissions||GT.FPWrapper.openUploadPrompt(function(b){var c,e,g,h,i=a.target.closest("section").querySelector("#response-contents-container");for($(j).parent().append("<p>Your Submissions</p>"),h=0;h<b.length;h++)e=b[h].filename.replace(/\.[^\/.]+$/,""),g=FPWrapper.determineType(b[h]),c={url:b[h].url,file_name:e,file_type:g,hash:b[h].url.split("/").pop()},t.uploads||(t.uploads=[]),t.uploads.push(c),d(c,function(){"Video"===g?$(i).append(Handlebars.partials.assignment_video(c)):"Sound"===g?$(i).append(Handlebars.partials.assignment_audio(c)):"Image"===g?$(i).append(Handlebars.partials.assignment_image(c)):$(i).append(Handlebars.partials.assignment_file(c)),i.querySelector("#delete-preview").onclick=f})},!0)}function d(a,b){GT.Tile.filepickerSecurityPolicy(a.url.split("/").pop(),function(c){var d,e;e=a.url.split("/").pop(),d=a.url.split("/"+e)[0],a.url=d+"/security=policy:"+c.policy+",signature:"+c.signature+"/"+e,b&&b()})}function e(a){var b,c;if(c=a.target.closest("section").querySelector("#text-container"),s){var d=!1;a.target.closest("section").classList.remove("editing"),b=c.querySelector("textarea").value,t.text=b,c.querySelector("textarea").remove(),c.innerHTML="<p>"+b+"</p>",a.target.closest("section").querySelector("header").classList.remove("hidden"),a.target.closest("section").querySelectorAll("button").forEach(function(a){d&&a.classList.add("hidden"),d=!0}),"save-edit"===a.target.id?g(a):(t.delete_array.length&&t.delete_array.forEach(function(b){var c;c=a.target.closest("section").querySelector("#delete-contents-"+b.content_id),c.closest("div").classList.remove("hidden")}),t={}),s=!1}else{s=!0;var e,f=a.target;b=c.innerText,e=document.createElement("textarea"),e.id="text-response",e.value=b,c.innerHTML="",c.appendChild(e),f.closest("section").querySelector("header").classList.add("hidden"),f.closest("section").querySelectorAll("button.hidden").forEach(function(a){a.classList.remove("hidden")}),f.closest("section").classList.add("editing")}}function f(a){t.delete_array=[];var b={},c=a.target.parentElement.previousElementSibling.tagName;"IMG"!==c&&"AUDIO"!==c&&"VIDEO"!==c||(b.url=a.target.parentElement.previousElementSibling.src),"P"===c&&(b.url=a.target.parentElement.previousElementSibling.querySelector(".download-file").value),a.target.parentElement.id.includes("delete-contents")&&(b.content_id=a.target.parentElement.id.split("-").pop()),t.delete_array.push(b),a.target.closest("div").classList.add("hidden")}function g(a){var d=a.target.closest("section").id,g=(a.target.closest("section").querySelector("#text-container"),a.target.closest("section").querySelector("#text-response"));g&&g.value&&(t.text=g.value),d&&(t.assignment_response_id=d.split("-").pop()),t=JSON.stringify(t),GT.Tile.submitResponse(q.tile.id,t,function(g){GT.Notification.show("Submission Saved");var h;if(g.tile_media="media"==q.tile.assignment_response,g.assignment_contents&&g.assignment_contents.forEach(function(a){"Video"===a.file_type&&(a.media=!0,a.video=!0),"Sound"===a.file_type&&(a.media=!0,a.sound=!0),"Image"===a.file_type&&(a.media=!0,a.image=!0)}),d){var i=document.createDocumentFragment(),j=a.target.closest("section"),k=Handlebars.partials.assignment_response(g);$(i).append(k),$(j).empty(),k=i.querySelector("section").children,$(j).append(k),j.querySelectorAll(".delete-contents").forEach(function(a){a.onclick=f}),h=j}else{var l,m=a.target.closest("section"),n=m.parentElement;m.remove(),$(n).append(Handlebars.partials.assignment_response(g)),l=n.querySelector("#js-ar-"+g.id),l.querySelectorAll(".delete-contents").forEach(function(a){a.onclick=f}),h=l}h.querySelectorAll(".edit-response").forEach(function(a){a.onclick=e}),h.querySelector(".video-response")&&(h.querySelector(".video-response").onclick=b),h.querySelector(".upload-response")&&(h.querySelector(".upload-response").onclick=c),t={}})}function h(a){a.forEach(function(a){"Video"===a.file_type&&(a.media=!0,a.video=!0),"Sound"===a.file_type&&(a.media=!0,a.sound=!0),"Image"===a.file_type&&(a.media=!0,a.image=!0)})}var i,j,k,l,m,n,o,p,q=this,r=document.createDocumentFragment(),s=!1,t={user_course_id:q.userCourseId};n={user_course_id:this.userCourseId,tile_id:this.tile.id},q.instructorResponse&&(n.context="instructor"),GT.User.assignmentData(n,function(d){if(o=d.pop()||{},o.submitted=!!d,q.tile.assignment_response)for(i=q.tile.assignment_response.split("/"),p=0;p<i.length;p++)q.tile[i[p]]=!0;if(q.tile.message=GT.urlify(q.tile.message),q.tile.assignment_contents&&h(q.tile.assignment_contents),q.userCourseId){$(r).append(JST["app/templates/reader_view/assignment-student.us"](q.tile)),j=r.querySelector("#assignment-upload-response"),k=r.querySelector("#assignment-text-response"),l=r.querySelector("#assignment-text-submit");for(p=0;p<d.length;p++)d[p].text&&(o.no_submissions?$(k).text(d[p].text):$(k).val(d[p].text)),d[p].instructor_id?d[p].tile_media=!0:("media"==q.tile.assignment_response&&(d[p].tile_media=!0),o.latest_learner_resp_id=d[p].id),d[p].file_name&&(d[p].file_name=d[p].file_name.split("\n")),(d[p].score||0==d[p].score)&&(d[p].scored=!0,o.latest_score=d[p].score,q.tile.pass_fail?100==d[p].score?(d[p].passing_score=!0,d[p].score="Pass"):d[p].score="Fail":d[p].score>=q.tile.min_score&&(d[p].passing_score=!0)),d[p].user_course_id&&q.instructorResponse&&(t.response_to_id=d[p].id),d[p].assignment_contents&&h(d[p].assignment_contents),$(r).children().append(Handlebars.partials.assignment_response(d[p]));if(d.length>0){if(d[d.length-1].instructor_id&&!q.instructorResponse&&q.tile.assignment_response||!d[d.length-1].instructor_id&&q.instructorResponse){var n={};q.instructorResponse?n.tile_media=!0:n.tile_media="media"==q.tile.assignment_response,$(r).children().append(Handlebars.partials.new_assignment_response(n))}}else!q.instructorResponse&&q.tile.assignment_response&&$(r).children().append(Handlebars.partials.new_assignment_response({tile_media:"media"==q.tile.assignment_response}));if("media"==q.tile.assignment_response){var s=r.querySelectorAll(".video-response"),u=r.querySelectorAll(".upload-response");s.forEach(function(a){a.onclick=b}),u.forEach(function(a){a.onclick=c})}m=r.querySelectorAll(".submit-response"),r.querySelectorAll(".edit-response").forEach(function(a){a.onclick=e}),r.querySelectorAll(".download-file").forEach(function(a){a.onclick=function(a){window.location=a.target.value}}),m.forEach(function(a){a.onclick=g})}else $(r).append(JST["app/templates/reader_view/assignment-instructor.us"](q.tile));return $(r).children().find(".delete-contents").on("click",f),a?void a(r.querySelector("div"),o):r})},a}(),GT.Tile.livetraining=function(){"use strict";var a=Object.create(GT.Tile.tile);return a.create=function(){var b=Object.create(a);return b.init(),b},a.makeReader=function(){var a,b=document.createDocumentFragment(),c=this;return c.tile.message=GT.urlify(c.tile.message),$(b).append(JST["app/templates/reader_view/live-training.us"]({course:c.course,tile:c.tile})),a=b.querySelector("button"),a.onclick=function(){window.location.hash="#tileedit-"+c.tile.id+"-results"},b},a.getEditor=function(a){var b;b=new LiveTrainingEditor(this.tile),a.appendChild(b.contentContainer)},a}(),GT.Tile.quiz=function(){"use strict";var a=Object.create(GT.Tile.tile);return a.makeReader=function(){var a,b;return this.activity&&this.activity(),a=new QuizPlayer(this.tile,this.course.id,this.userCourseId),b=a.getPlayer()},a.getResult=function(a,b){var c,d=document.createElement("div");return c=new QuizResultsViewer(this.tile,a,function(){a.tile_score=void 0,a.tile_passed=void 0,a.tile_completed=!1,a.tile_status_datum.passed=a.tile_passed,a.tile_status_datum.completed=a.tile_completed,a.tile_status_datum.score=a.tile_score,b(a)}),d.appendChild(c.getFrag()),d},a.getEditor=function(a){var b;b=new QuizEditor(this.tile,this.course.students_count),a.appendChild(b.contentContainer)},a}(),GT.Tile.spark=function(){"use strict";var a=Object.create(GT.Tile.tile);return a.makeReader=function(){var a,b;return this.activity&&this.activity(),a=new SparkPlayer(this.tile,this.userCourseId,this.course),b=a.getPlayer()},a.getResult=function(a,b){var c,d;return d=document.createElement("div"),c=new SparkResultsViewer(this.tile,a,function(a){b(a)}),d.appendChild(c.getFrag()),d},a.getEditor=function(a){var b;b=new SparkEditor(this.tile,this.course.students_count),a.appendChild(b.contentContainer)},a}(),GT.Tile.emailmessage=function(){"use strict";var a=Object.create(GT.Tile.tile);return a.makeReader=function(){var a="tiles/"+this.tile.id+"/raw_message/index.html";return this.makeIFrame(a)},a}(),GT.Tile.audiospark=function(){"use strict";var a=Object.create(GT.Tile.tile);return a.makeReader=function(){var a,b;return this.activity&&this.activity(),a=new SparkPlayer(this.tile,this.userCourseId,this.course),b=a.getPlayer()},a.getResult=function(a,b){var c,d;return d=document.createElement("div"),c=new SparkResultsViewer(this.tile,a,function(a){b(a)}),d.appendChild(c.getFrag()),d},a.getEditor=function(a){var b;b=new SparkEditor(this.tile,this.course.students_count),a.appendChild(b.contentContainer)},a}(),GT.YouTube={},GT.YouTube.getEmbedCode=function(a){"use strict";var b;return b='<iframe id="existing-iframe-example" width="640" height="360" src="https://www.youtube.com/embed/'+a+'?enablejsapi=1" frameborder="0" ></iframe>'},GT.YouTube.key="AIzaSyA-1OWgIlhlzCgMYW89Ds3rT_KvlGH57ik",GT.YouTube.getData=function(a,b){"use strict";$.getJSON("https://www.googleapis.com/youtube/v3/videos",{key:GT.YouTube.key,part:"snippet",id:a},function(c){b(0===c.items.length?{error_message:"Video not Found."}:{title:c.items[0].snippet.title,thumbnail:c.items[0].snippet.thumbnails["default"].url,type:"video",url:"http://www.youtube.com/watch?v="+a,html:GT.YouTube.getEmbedCode(a)})})},GT.YouTube.thumbnail=function(a){"use strict";return"https://i.ytimg.com/vi/"+a+"/hqdefault.jpg"},GT.YouTube.getVideoIdFromURL=function(a){"use strict";var b,c;return!!a&&(b=/^.*(youtu\.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,c=a.match(b),!(!c||11!==c[2].length)&&c[2])};